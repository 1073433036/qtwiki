<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from wiki.qt.io/Qt_Quick_Carousel/bg by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 05 Nov 2015 10:18:54 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>Qt Quick Carousel/bg - Qt Wiki</title>
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />
<meta name="generator" content="MediaWiki 1.23.3" />
<link rel="shortcut icon" href="../favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="../opensearch_desc.php" title="Qt Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="../api251f.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Qt Wiki Atom feed" href="../apidf90.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="../load771b.css?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.vector.styles&amp;only=styles&amp;skin=vector&amp;*" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="../loadc6d2.css?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: qtio_wiki:resourceloader:filter:minify-css:7:e91d7bc946738c8892a88ad5616a59ba */</style>
<script src="../load8478.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Qt_Quick_Carousel/bg","wgTitle":"Qt Quick Carousel/bg","wgCurRevisionId":16040,"wgRevisionId":16040,"wgArticleId":1532,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Articles needing cleanup","Developing with Qt::Qt Quick","Pages with broken file links"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Qt_Quick_Carousel/bg","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"hidesig":true,"preview":true,"previewDialog":false,"publish":true}});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"editfont":"default","editondblclick":0,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":1,"extendwatchlist":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nickname":"","norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"rcdays":7,"rclimit":50,"rows":25,"showhiddencats":0,"shownumberswatching":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":1,"watchdefault":1,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,
"useeditwarning":1,"prefershttps":1,"usebetatoolbar":1,"usebetatoolbar-cgd":1,"wikieditor-preview":1,"wikieditor-publish":1,"language":"en","variant-gan":"gan","variant-iu":"iu","variant-kk":"kk","variant-ku":"ku","variant-shi":"shi","variant-sr":"sr","variant-tg":"tg","variant-uz":"uz","variant-zh":"zh","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"searchNs500":false,"searchNs501":false,"searchNs700":false,"searchNs701":false,"variant":"en"});},{},{});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});},{},{});
/* cache key: qtio_wiki:resourceloader:filter:minify-js:7:9743cb8b8019d46de5946bfe6dfa04d7 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<style type="text/css">/*<![CDATA[*/
.source-cpp-qt {line-height: normal;}
.source-cpp-qt li, .source-cpp-qt pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for cpp-qt
 * CSS class: source-cpp-qt, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.cpp-qt.source-cpp-qt .de1, .cpp-qt.source-cpp-qt .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.cpp-qt.source-cpp-qt  {font-family:monospace;}
.cpp-qt.source-cpp-qt .imp {font-weight: bold; color: red;}
.cpp-qt.source-cpp-qt li, .cpp-qt.source-cpp-qt .li1 {font-weight: normal; vertical-align:top;}
.cpp-qt.source-cpp-qt .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.cpp-qt.source-cpp-qt .li2 {font-weight: bold; vertical-align:top;}
.cpp-qt.source-cpp-qt .kw1 {color: #000000; font-weight:bold;}
.cpp-qt.source-cpp-qt .kw2 {color: #0057AE;}
.cpp-qt.source-cpp-qt .kw3 {color: #2B74C7;}
.cpp-qt.source-cpp-qt .kw4 {color: #0057AE;}
.cpp-qt.source-cpp-qt .kw5 {color: #22aadd;}
.cpp-qt.source-cpp-qt .co1 {color: #888888;}
.cpp-qt.source-cpp-qt .co2 {color: #006E28;}
.cpp-qt.source-cpp-qt .coMULTI {color: #888888; font-style: italic;}
.cpp-qt.source-cpp-qt .es0 {color: #000099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es1 {color: #000099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es2 {color: #660099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es3 {color: #660099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es4 {color: #660099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es5 {color: #006699; font-weight: bold;}
.cpp-qt.source-cpp-qt .br0 {color: #006E28;}
.cpp-qt.source-cpp-qt .sy0 {color: #006E28;}
.cpp-qt.source-cpp-qt .st0 {color: #BF0303;}
.cpp-qt.source-cpp-qt .nu0 {color: #B08000;}
.cpp-qt.source-cpp-qt .nu6 {color: #208080;}
.cpp-qt.source-cpp-qt .nu8 {color: #208080;}
.cpp-qt.source-cpp-qt .nu12 {color: #208080;}
.cpp-qt.source-cpp-qt .nu16 {color:#800080;}
.cpp-qt.source-cpp-qt .nu17 {color:#800080;}
.cpp-qt.source-cpp-qt .nu18 {color:#800080;}
.cpp-qt.source-cpp-qt .nu19 {color:#800080;}
.cpp-qt.source-cpp-qt .me1 {color: #2B74C7;}
.cpp-qt.source-cpp-qt .me2 {color: #2B74C7;}
.cpp-qt.source-cpp-qt .me3 {color: #2B74C7;}
.cpp-qt.source-cpp-qt .ln-xtra, .cpp-qt.source-cpp-qt li.ln-xtra, .cpp-qt.source-cpp-qt div.ln-xtra {background-color: #ffc;}
.cpp-qt.source-cpp-qt span.xtra { display:block; }

/*]]>*/
</style><!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Qt_Quick_Carousel_bg skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">Qt Quick Carousel/bg</span></h1>
						<div id="bodyContent">
								<div id="siteSub">From Qt Wiki</div>
								<div id="contentSub"><span class="subpages">&lt; <a href="../Qt_Quick_Carousel.html" title="Qt Quick Carousel">Qt Quick Carousel</a></span></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-navigation">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><table style="center; margin: -1px auto 0px;border: 1px solid rgb(127, 194, 66); border-left: 10px solid rgb(127, 194, 66); background:rgb(250,250,250); width:600px">

<tr>
<td style="padding: 0.25em 0.5em;"> <b>This article may require cleanup to meet the Qt Wiki's quality standards.</b> Reason: Auto-imported from ExpressionEngine.<br /><small>Please <b><a rel="nofollow" class="external text" href="../index17d7.html?title=Qt_Quick_Carousel/bg&amp;action=edit">improve this article</a></b> if you can. Remove the {{cleanup}} tag and add this page to <b><a href="../Updated_pages.html" title="Updated pages">Updated pages</a></b> list after it's clean.</small>
</td></tr></table>
<p><b>Български</b> <a href="../Qt_Quick_Carousel.html" title="Qt Quick Carousel">English</a>
</p><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.D0.9A.D0.B0.D0.BA_.D0.B4.D0.B0_.D0.BD.D0.B0.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BC_.D0.B2.D1.8A.D1.80.D1.82.D0.B5.D0.BB.D0.B5.D0.B6.D0.BA.D0.B0_.D1.81_Qt_Quick"><span class="tocnumber">1</span> <span class="toctext">Как да направим въртележка с Qt Quick</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#.D0.92.D1.8A.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5"><span class="tocnumber">1.1</span> <span class="toctext">Въведение</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#.D0.97.D0.B0.D0.BF.D0.BE.D0.B7.D0.BD.D0.B0.D0.B2.D0.B0.D0.BD.D0.B5_.D1.81_PathView"><span class="tocnumber">1.2</span> <span class="toctext">Запознаване с PathView</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#.D0.A1.D1.8A.D0.B7.D0.B4.D0.B0.D0.B2.D0.B0.D0.BD.D0.B5_.D0.BD.D0.B0_.D0.BA.D1.80.D1.8A.D0.B3"><span class="tocnumber">1.3</span> <span class="toctext">Създаване на кръг</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#.D0.A1.D0.BA.D1.80.D0.B8.D0.B2.D0.B0.D0.BD.D0.B5_.D0.BD.D0.B0_.D0.BB.D0.BE.D0.B3.D0.B8.D0.BA.D0.B0.D1.82.D0.B0"><span class="tocnumber">1.4</span> <span class="toctext">Скриване на логиката</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#.D0.94.D0.BE.D0.B2.D0.B0.D0.B2.D1.8F.D0.BD.D0.B5_.D0.BD.D0.B0_.D0.B3.D1.80.D0.B0.D1.84.D0.B8.D1.87.D0.BD.D0.BE.D1.82.D0.BE_.D0.BE.D1.84.D0.BE.D1.80.D0.BC.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5"><span class="tocnumber">1.5</span> <span class="toctext">Довавяне на графичното оформление</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#.D0.94.D0.BE.D0.B1.D0.B0.D0.B2.D1.8F.D0.BD.D0.B5_.D0.BD.D0.B0_.D1.83.D0.BF.D1.80.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D1.81_.D0.BA.D0.BB.D0.B0.D0.B2.D0.B8.D0.B0.D1.82.D1.83.D1.80.D0.B0.D1.82.D0.B0"><span class="tocnumber">1.6</span> <span class="toctext">Добавяне на управление с клавиатурата</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#.D0.94.D0.BE.D0.BD.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.B2.D0.B0.D0.BD.D0.B5"><span class="tocnumber">1.7</span> <span class="toctext">Донастройване</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#.D0.98.D0.BD.D1.82.D0.B5.D1.80.D0.BD.D0.B0.D1.86.D0.B8.D0.BE.D0.BD.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D1.8F"><span class="tocnumber">1.8</span> <span class="toctext">Интернационализация</span></a></li>
</ul>
</li>
</ul>
</div>

<h1><span class="mw-headline" id=".D0.9A.D0.B0.D0.BA_.D0.B4.D0.B0_.D0.BD.D0.B0.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BC_.D0.B2.D1.8A.D1.80.D1.82.D0.B5.D0.BB.D0.B5.D0.B6.D0.BA.D0.B0_.D1.81_Qt_Quick">Как да направим въртележка с Qt Quick</span></h1>
<h2><span class="mw-headline" id=".D0.92.D1.8A.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5">Въведение</span></h2>
<p>Този урок ще ви покаже как да създадете анимирано меню с елементи, въртящи се в псевдо 3D пространство. Също ще ви бъде показано как да разделите QML проекта на отделни модули и как да добавите поддръжка на различни езици с <i>Qt Linguist</i>.
</p><p>Всичко, от което се нуждаете, за да изпълните инструкциите е <b>qmlviewer</b>. Ако използвате някоя от последните версии на Убунту, просто инсталирайте пакетите <b>qt4-qmlviewer</b> и <b>libqt4-dev</b>. Всички файлове от урока могат да бъдат намерени в <a rel="nofollow" class="external text" href="https://www.gitorious.org/qt-training/qml-demos/trees/master/carousel">gitorious</a> .
</p><p>Qt Quick трябва да бъде поне версия 1.0, която идва с Qt 4.7.1 и нагоре.
</p>
<h2><span class="mw-headline" id=".D0.97.D0.B0.D0.BF.D0.BE.D0.B7.D0.BD.D0.B0.D0.B2.D0.B0.D0.BD.D0.B5_.D1.81_PathView">Запознаване с PathView</span></h2>
<p><a rel="nofollow" class="external text" href="http://developer.qt.nokia.com/doc/qt-4.7/qml-pathview.html">PathView</a> взима елементи от модел и ги разполага по определен път. Пътят е геометрично дефиниран като последователност от участъци. Има три вида участъци: линии, квадратични и кубични криви на <a rel="nofollow" class="external text" href="http://en.wikipedia.org/wiki/Bezier_curve">Безие</a> curves. За да придобиете опит в това, как да създавате пътища, нека започнем с най-обикновен участък под формата на права линия:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="co1">// Carousel0.qml</span>
import QtQuick <span class="nu16">1.0</span>
&#160;
PathView <span class="br0">&#123;</span>
 id<span class="sy0">:</span> view
 width<span class="sy0">:</span> <span class="nu0">640</span>
 height<span class="sy0">:</span> <span class="nu0">360</span>
 model<span class="sy0">:</span> <span class="nu0">32</span>
 delegate<span class="sy0">:</span> Text <span class="br0">&#123;</span> text<span class="sy0">:</span> index <span class="br0">&#125;</span>
 path<span class="sy0">:</span> Path <span class="br0">&#123;</span>
 startX<span class="sy0">:</span> <span class="nu0">0</span>
 startY<span class="sy0">:</span> <span class="nu0">0</span>
 PathLine <span class="br0">&#123;</span> x<span class="sy0">:</span> view.<span class="me1">width</span><span class="sy0">;</span> y<span class="sy0">:</span> view.<span class="me1">height</span> <span class="br0">&#125;</span>
 <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></div></div>
<p><i>PathView</i> е нашият главен елемент. Слагайки числото 32 като модел, автоматично ще се генерират индекси за модела от 0 до 31. За всеки елемент от модела се създава по един делегат, за да се визуализира. Започваме с обикновено текстово поле, което показва индексите на елементите в модела. По-късно ще видим как се създават по-сложни делегати, но за сега нека да се фокусираме върху създаването на пътищата. Описанието на път изисква поне начална точка и един участък. В нашият случай започваме от (0, 0) и рисуваме праволинеен участък до долу в дясно. Като заредите файла в <b>qmlviewer</b>, трябва да получите подобен изход:
<a href="../indexbcba.html?title=Special:Upload&amp;wpDestFile=Http://www.gitorious.org/qt-training/qml-demos/blobs/raw/4ef3dccc2be296484845628880c5abcebbbceb1e/carousel/Carousel0.png" class="new" title="File:Http://www.gitorious.org/qt-training/qml-demos/blobs/raw/4ef3dccc2be296484845628880c5abcebbbceb1e/carousel/Carousel0.png">Carousel0.png</a>
</p><p>Когато плъзгате елементите, те реалистично ще се преместват. Забележете как те застават на фиксирани места. По подразбиране първият елемент е центриран в началната точка, а останалите са разпределени равномерно по дължината на пътя.
</p><p>Добре, нека да усложним малко примера и да нарисуваме цял правоъгълник. Заменете описанието на пътя от предният пример със следното:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="co1">// Carousel1.qml</span>
…
property <span class="kw4">int</span> pathMargin<span class="sy0">:</span> <span class="nu0">50</span>
path<span class="sy0">:</span> Path <span class="br0">&#123;</span>
 startX<span class="sy0">:</span> pathMargin
 startY<span class="sy0">:</span> pathMargin
 PathLine <span class="br0">&#123;</span> x<span class="sy0">:</span> view.<span class="me1">width</span> <span class="sy0">-</span> pathMargin<span class="sy0">;</span> y<span class="sy0">:</span> pathMargin <span class="br0">&#125;</span>
 PathLine <span class="br0">&#123;</span> x<span class="sy0">:</span> view.<span class="me1">width</span> <span class="sy0">-</span> pathMargin<span class="sy0">;</span> y<span class="sy0">:</span> view.<span class="me1">height</span> <span class="sy0">-</span> pathMargin <span class="br0">&#125;</span>
 PathLine <span class="br0">&#123;</span> x<span class="sy0">:</span> pathMargin<span class="sy0">;</span> y<span class="sy0">:</span> view.<span class="me1">height</span> <span class="sy0">-</span> pathMargin <span class="br0">&#125;</span>
 PathLine <span class="br0">&#123;</span> x<span class="sy0">:</span> path.<span class="me1">startX</span><span class="sy0">;</span> y<span class="sy0">:</span> path.<span class="me1">startY</span> <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
…</pre></div></div>
<p>Когато стартирате програмата, трябва да видите правоъгълник. Всеки <a rel="nofollow" class="external text" href="http://developer.qt.nokia.com/doc/qt-4.7/qml-pathline.html">PathLine</a> започва от крайната точна на предният участък, така че ние трябва да зададем само крайните точни на всеки участък. За последният участък просто задаваме началната точка и така затваряме пътя. Създаваме наше си свойство <i>pathMargin</i>, за да си помогнем да дефинираме геометрията на пътя. Използването на потребителски свойства е най-лесният начин за създаване на допълнителни променливи в Qt Quick, но трябва да внимавате, защото те винаги са с публичен достъп.
</p><p>Може да искате да напишете:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1">…
path<span class="sy0">:</span> Path <span class="br0">&#123;</span>
 property <span class="kw4">int</span> pathMargin<span class="sy0">:</span> <span class="nu0">50</span>
 startX<span class="sy0">:</span> pathMargin
…</pre></div></div>
<p>… но това не е възможно, защото <i>Path</i> компонента вече е дефиниран някъде другаде и не ние е позволено да добавяме нови свойства по време на изпълнение.
</p>
<h2><span class="mw-headline" id=".D0.A1.D1.8A.D0.B7.D0.B4.D0.B0.D0.B2.D0.B0.D0.BD.D0.B5_.D0.BD.D0.B0_.D0.BA.D1.80.D1.8A.D0.B3">Създаване на кръг</span></h2>
<p>След като се научихме да създаваме правоъгълник, нека да опитаме нещо по-трудно - кръг. <i>Path</i> не поддържа кръгли криви, така че ще трябва да използваме приближение чрез някои от следните варианти: линии, квадратични или кубични криви ви Безие. Тъй като това не е урок по аналитична геометрия, нека директно да преминем на решението - 4 кубични криви, като използваме <a rel="nofollow" class="external text" href="http://www.tinaja.com/glib/ellipse4.pdf">магическото число 0.551784</a>. Погледнете кода:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="co1">// Carousel2.qml</span>
…
property <span class="kw4">int</span> pathMargin<span class="sy0">:</span> <span class="nu0">50</span>
property real rx<span class="sy0">:</span> ry <span class="co1">// view.width / 2 - pathMargin</span>
property real ry<span class="sy0">:</span> view.<span class="me1">height</span> <span class="sy0">/</span> <span class="nu0">2</span> <span class="sy0">-</span> pathMargin
property real magic<span class="sy0">:</span> <span class="nu16">0.551784</span>
property real mx<span class="sy0">:</span> rx <span class="sy0">*</span> magic
property real my<span class="sy0">:</span> ry <span class="sy0">*</span> magic
property real cx<span class="sy0">:</span> view.<span class="me1">width</span> <span class="sy0">/</span> <span class="nu0">2</span>
property real cy<span class="sy0">:</span> view.<span class="me1">height</span> <span class="sy0">/</span> <span class="nu0">2</span>
path<span class="sy0">:</span> Path <span class="br0">&#123;</span>
 startX<span class="sy0">:</span> view.<span class="me1">cx</span> <span class="sy0">+</span> view.<span class="me1">rx</span><span class="sy0">;</span> startY<span class="sy0">:</span> view.<span class="me1">cy</span>
 PathCubic <span class="br0">&#123;</span> <span class="co1">// first quadrant arc</span>
 control1X<span class="sy0">:</span> view.<span class="me1">cx</span> <span class="sy0">+</span> view.<span class="me1">rx</span><span class="sy0">;</span> control1Y<span class="sy0">:</span> view.<span class="me1">cy</span> <span class="sy0">+</span> view.<span class="me1">my</span>
 control2X<span class="sy0">:</span> view.<span class="me1">cx</span> <span class="sy0">+</span> view.<span class="me1">mx</span><span class="sy0">;</span> control2Y<span class="sy0">:</span> view.<span class="me1">cy</span> <span class="sy0">+</span> view.<span class="me1">ry</span>
 x<span class="sy0">:</span> view.<span class="me1">cx</span><span class="sy0">;</span> y<span class="sy0">:</span> view.<span class="me1">cy</span> <span class="sy0">+</span> view.<span class="me1">ry</span>
 <span class="br0">&#125;</span>
 PathCubic <span class="br0">&#123;</span> <span class="co1">// second quadrant arc</span>
 control1X<span class="sy0">:</span> view.<span class="me1">cx</span> <span class="sy0">-</span> view.<span class="me1">mx</span><span class="sy0">;</span> control1Y<span class="sy0">:</span> view.<span class="me1">cy</span> <span class="sy0">+</span> view.<span class="me1">ry</span>
 control2X<span class="sy0">:</span> view.<span class="me1">cx</span> <span class="sy0">-</span> view.<span class="me1">rx</span><span class="sy0">;</span> control2Y<span class="sy0">:</span> view.<span class="me1">cy</span> <span class="sy0">+</span> view.<span class="me1">my</span>
 x<span class="sy0">:</span> view.<span class="me1">cx</span> <span class="sy0">-</span> view.<span class="me1">rx</span><span class="sy0">;</span> y<span class="sy0">:</span> view.<span class="me1">cy</span>
 <span class="br0">&#125;</span>
 PathCubic <span class="br0">&#123;</span> <span class="co1">// third quadrant arc</span>
 control1X<span class="sy0">:</span> view.<span class="me1">cx</span> <span class="sy0">-</span> view.<span class="me1">rx</span><span class="sy0">;</span> control1Y<span class="sy0">:</span> view.<span class="me1">cy</span> <span class="sy0">-</span> view.<span class="me1">my</span>
 control2X<span class="sy0">:</span> view.<span class="me1">cx</span> <span class="sy0">-</span> view.<span class="me1">mx</span><span class="sy0">;</span> control2Y<span class="sy0">:</span> view.<span class="me1">cy</span> <span class="sy0">-</span> view.<span class="me1">ry</span>
 x<span class="sy0">:</span> view.<span class="me1">cx</span><span class="sy0">;</span> y<span class="sy0">:</span> view.<span class="me1">cy</span> <span class="sy0">-</span> view.<span class="me1">ry</span>
 <span class="br0">&#125;</span>
 PathCubic <span class="br0">&#123;</span> <span class="co1">// forth quadrant arc</span>
 control1X<span class="sy0">:</span> view.<span class="me1">cx</span> <span class="sy0">+</span> view.<span class="me1">mx</span><span class="sy0">;</span> control1Y<span class="sy0">:</span> view.<span class="me1">cy</span> <span class="sy0">-</span> view.<span class="me1">ry</span>
 control2X<span class="sy0">:</span> view.<span class="me1">cx</span> <span class="sy0">+</span> view.<span class="me1">rx</span><span class="sy0">;</span> control2Y<span class="sy0">:</span> view.<span class="me1">cy</span> <span class="sy0">-</span> view.<span class="me1">my</span>
 x<span class="sy0">:</span> view.<span class="me1">cx</span> <span class="sy0">+</span> view.<span class="me1">rx</span><span class="sy0">;</span> y<span class="sy0">:</span> view.<span class="me1">cy</span>
 <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
…</pre></div></div>
<p>Това ни дава перфектен кръг:
<a href="../index703d.html?title=Special:Upload&amp;wpDestFile=Http://www.gitorious.org/qt-training/qml-demos/blobs/raw/4ef3dccc2be296484845628880c5abcebbbceb1e/carousel/Carousel2.png" class="new" title="File:Http://www.gitorious.org/qt-training/qml-demos/blobs/raw/4ef3dccc2be296484845628880c5abcebbbceb1e/carousel/Carousel2.png">Carousel2.png</a>
</p><p>Както може да видите, ние се нуждаем от по две контролни точки за всяка кубична крива. (Всички точки се дават в абсолютни координати.) Ако бяхме използвали квадратична крива, щяхме да се нуждаем само от една контролна точка. Контролните точки лежат извън кривата, но влияят на нейната форма. Може би сте запознати с концепцията от инструментите за работа с векторна графика.
</p>
<h2><span class="mw-headline" id=".D0.A1.D0.BA.D1.80.D0.B8.D0.B2.D0.B0.D0.BD.D0.B5_.D0.BD.D0.B0_.D0.BB.D0.BE.D0.B3.D0.B8.D0.BA.D0.B0.D1.82.D0.B0">Скриване на логиката</span></h2>
<p>QML файла <a rel="nofollow" class="external text" href="http://doc.qt.nokia.com/4.7/qml-extending-types.html#defining-new-components">може да се дефинира като преизползваем компонент</a>. Когато кода ви расте, вие обикновено искате да го разделите на логически блокове в отделни файлове, за да може да се използва многократно и да е по-лесен за четене. В нашият пример ще го разделим на:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="co1">// Carousel3.qml</span>
import QtQuick <span class="nu16">1.0</span>
&#160;
PathView <span class="br0">&#123;</span>
 id<span class="sy0">:</span> view
 width<span class="sy0">:</span> <span class="nu0">640</span>
 height<span class="sy0">:</span> <span class="nu0">360</span>
 model<span class="sy0">:</span> <span class="nu0">32</span>
 delegate<span class="sy0">:</span> Text <span class="br0">&#123;</span> text<span class="sy0">:</span> index <span class="br0">&#125;</span>
 path<span class="sy0">:</span> Ellipse <span class="br0">&#123;</span>
 width<span class="sy0">:</span> view.<span class="me1">width</span>
 height<span class="sy0">:</span> view.<span class="me1">height</span>
 <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></div></div>
<p>Нашият <i>Ellipse</i> компонент скрива сложната логика за апроксимиране на кръга и скалиране на елементите. Когато дефинираме наши компоненти, поризлизащи от вече съществуващи, можем да дефинираме и нови свойства. Компонента <i>Ellipse</i> съдържа следният код, който е леко променена версия на предният:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="co1">// Ellipse.qml</span>
import QtQuick <span class="nu16">1.0</span>
&#160;
Path <span class="br0">&#123;</span>
 id<span class="sy0">:</span> p
 property real width<span class="sy0">:</span> <span class="nu0">200</span>
 property real height<span class="sy0">:</span> <span class="nu0">200</span>
 property real margin<span class="sy0">:</span> <span class="nu0">50</span>
 property real cx<span class="sy0">:</span> width <span class="sy0">/</span> <span class="nu0">2</span>
 property real cy<span class="sy0">:</span> height <span class="sy0">/</span> <span class="nu0">2</span>
 property real rx<span class="sy0">:</span> width <span class="sy0">/</span> <span class="nu0">2</span> <span class="sy0">-</span> margin
 property real ry<span class="sy0">:</span> height <span class="sy0">/</span> <span class="nu0">2</span> <span class="sy0">-</span> margin
 property real mx<span class="sy0">:</span> rx <span class="sy0">*</span> magic
 property real my<span class="sy0">:</span> ry <span class="sy0">*</span> magic
 property real magic<span class="sy0">:</span> <span class="nu16">0.551784</span>
 startX<span class="sy0">:</span> p.<span class="me1">cx</span><span class="sy0">;</span> startY<span class="sy0">:</span> p.<span class="me1">cy</span> <span class="sy0">+</span> p.<span class="me1">ry</span>
 PathCubic <span class="br0">&#123;</span> <span class="co1">// second quadrant arc</span>
 control1X<span class="sy0">:</span> p.<span class="me1">cx</span> <span class="sy0">-</span> p.<span class="me1">mx</span><span class="sy0">;</span> control1Y<span class="sy0">:</span> p.<span class="me1">cy</span> <span class="sy0">+</span> p.<span class="me1">ry</span>
 control2X<span class="sy0">:</span> p.<span class="me1">cx</span> <span class="sy0">-</span> p.<span class="me1">rx</span><span class="sy0">;</span> control2Y<span class="sy0">:</span> p.<span class="me1">cy</span> <span class="sy0">+</span> p.<span class="me1">my</span>
 x<span class="sy0">:</span> p.<span class="me1">cx</span> <span class="sy0">-</span> p.<span class="me1">rx</span><span class="sy0">;</span> y<span class="sy0">:</span> p.<span class="me1">cy</span>
 <span class="br0">&#125;</span>
 PathCubic <span class="br0">&#123;</span> <span class="co1">// third quadrant arc</span>
 control1X<span class="sy0">:</span> p.<span class="me1">cx</span> <span class="sy0">-</span> p.<span class="me1">rx</span><span class="sy0">;</span> control1Y<span class="sy0">:</span> p.<span class="me1">cy</span> <span class="sy0">-</span> p.<span class="me1">my</span>
 control2X<span class="sy0">:</span> p.<span class="me1">cx</span> <span class="sy0">-</span> p.<span class="me1">mx</span><span class="sy0">;</span> control2Y<span class="sy0">:</span> p.<span class="me1">cy</span> <span class="sy0">-</span> p.<span class="me1">ry</span>
 x<span class="sy0">:</span> p.<span class="me1">cx</span><span class="sy0">;</span> y<span class="sy0">:</span> p.<span class="me1">cy</span> <span class="sy0">-</span> p.<span class="me1">ry</span>
 <span class="br0">&#125;</span>
 PathCubic <span class="br0">&#123;</span> <span class="co1">// forth quadrant arc</span>
 control1X<span class="sy0">:</span> p.<span class="me1">cx</span> <span class="sy0">+</span> p.<span class="me1">mx</span><span class="sy0">;</span> control1Y<span class="sy0">:</span> p.<span class="me1">cy</span> <span class="sy0">-</span> p.<span class="me1">ry</span>
 control2X<span class="sy0">:</span> p.<span class="me1">cx</span> <span class="sy0">+</span> p.<span class="me1">rx</span><span class="sy0">;</span> control2Y<span class="sy0">:</span> p.<span class="me1">cy</span> <span class="sy0">-</span> p.<span class="me1">my</span>
 x<span class="sy0">:</span> p.<span class="me1">cx</span> <span class="sy0">+</span> p.<span class="me1">rx</span><span class="sy0">;</span> y<span class="sy0">:</span> p.<span class="me1">cy</span>
 <span class="br0">&#125;</span>
 PathCubic <span class="br0">&#123;</span> <span class="co1">// first quadrant arc</span>
 control1X<span class="sy0">:</span> p.<span class="me1">cx</span> <span class="sy0">+</span> p.<span class="me1">rx</span><span class="sy0">;</span> control1Y<span class="sy0">:</span> p.<span class="me1">cy</span> <span class="sy0">+</span> p.<span class="me1">my</span>
 control2X<span class="sy0">:</span> p.<span class="me1">cx</span> <span class="sy0">+</span> p.<span class="me1">mx</span><span class="sy0">;</span> control2Y<span class="sy0">:</span> p.<span class="me1">cy</span> <span class="sy0">+</span> p.<span class="me1">ry</span>
 x<span class="sy0">:</span> p.<span class="me1">cx</span><span class="sy0">;</span> y<span class="sy0">:</span> p.<span class="me1">cy</span> <span class="sy0">+</span> p.<span class="me1">ry</span>
 <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></div></div>
<p>Както може да видите, започваме пътя от втори квадрант. Целта е да първият елемент да е най-отдолу. Това е позицията и на текущият елелемнт.
</p>
<h2><span class="mw-headline" id=".D0.94.D0.BE.D0.B2.D0.B0.D0.B2.D1.8F.D0.BD.D0.B5_.D0.BD.D0.B0_.D0.B3.D1.80.D0.B0.D1.84.D0.B8.D1.87.D0.BD.D0.BE.D1.82.D0.BE_.D0.BE.D1.84.D0.BE.D1.80.D0.BC.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5">Довавяне на графичното оформление</span></h2>
<p>Вече трябва да имате основни познания как се създават пътища. За това минаваме на следващата стъпка - графичното оформление. За целта ще използваме <a rel="nofollow" class="external text" href="https://www.gitorious.org/qt-training/qml-demos/trees/master/carousel/icons">Трон подобни икони</a>, които ще направим да изглеждат като 3D. Това се прави удивително лесно с QML.
</p><p>Първо, нека създаден необходимият модел. Започнахме с прост изкуствен модел и сега ще го заменим с истински. Това е кода за него:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="co1">// Model0.qml</span>
import QtQuick <span class="nu16">1.0</span>
&#160;
ListModel <span class="br0">&#123;</span>
 ListElement <span class="br0">&#123;</span> title<span class="sy0">:</span> <span class="st0">&quot;Calendar&quot;</span><span class="sy0">;</span> iconSource<span class="sy0">:</span> <span class="st0">&quot;icons/calendar.png&quot;</span> <span class="br0">&#125;</span>
 ListElement <span class="br0">&#123;</span> title<span class="sy0">:</span> <span class="st0">&quot;Setup&quot;</span><span class="sy0">;</span> iconSource<span class="sy0">:</span> <span class="st0">&quot;icons/develop.png&quot;</span> <span class="br0">&#125;</span>
 ListElement <span class="br0">&#123;</span> title<span class="sy0">:</span> <span class="st0">&quot;Internet&quot;</span><span class="sy0">;</span> iconSource<span class="sy0">:</span> <span class="st0">&quot;icons/globe.png&quot;</span> <span class="br0">&#125;</span>
 ListElement <span class="br0">&#123;</span> title<span class="sy0">:</span> <span class="st0">&quot;Messages&quot;</span><span class="sy0">;</span> iconSource<span class="sy0">:</span> <span class="st0">&quot;icons/mail.png&quot;</span> <span class="br0">&#125;</span>
 ListElement <span class="br0">&#123;</span> title<span class="sy0">:</span> <span class="st0">&quot;Music&quot;</span><span class="sy0">;</span> iconSource<span class="sy0">:</span> <span class="st0">&quot;icons/music.png&quot;</span> <span class="br0">&#125;</span>
 ListElement <span class="br0">&#123;</span> title<span class="sy0">:</span> <span class="st0">&quot;Call&quot;</span><span class="sy0">;</span> iconSource<span class="sy0">:</span> <span class="st0">&quot;icons/phone.png&quot;</span> <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></div></div>
<p>Използваме <a rel="nofollow" class="external text" href="http://developer.qt.nokia.com/doc/qt-4.7/qml-listmodel.html">ListModel</a> и го пълним с примерни данни. Свободни сме да дефинираме каквито искаме свойства за елементите. Ще използваме <i>iconSource</i> за иконите в менюто и <i>title</i> за да добавим заглавие по-късно. Новият ни делегат е базиран на компонента <i>Image</i> и изглежда по следният начин:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="co1">// Carouse5.qml</span>
import QtQuick <span class="nu16">1.0</span>
&#160;
Rectangle <span class="br0">&#123;</span>
 width<span class="sy0">:</span> <span class="nu0">640</span>
 height<span class="sy0">:</span> <span class="nu0">360</span>
 color<span class="sy0">:</span> <span class="st0">&quot;black&quot;</span>
 PathView <span class="br0">&#123;</span>
 id<span class="sy0">:</span> view
 width<span class="sy0">:</span> parent.<span class="me1">width</span>
 height<span class="sy0">:</span> parent.<span class="me1">height</span> <span class="sy0">+</span> y
 y<span class="sy0">:</span> <span class="sy0">-</span><span class="nu0">33</span>
 model<span class="sy0">:</span> Menu0 <span class="br0">&#123;</span><span class="br0">&#125;</span>
 delegate<span class="sy0">:</span> Image <span class="br0">&#123;</span>
 source<span class="sy0">:</span> iconSource
 width<span class="sy0">:</span> <span class="nu0">64</span>
 height<span class="sy0">:</span> <span class="nu0">64</span>
 scale<span class="sy0">:</span> <span class="nu0">4</span>. <span class="sy0">*</span> y <span class="sy0">/</span> parent.<span class="me1">height</span>
 z<span class="sy0">:</span> y
 smooth<span class="sy0">:</span> <span class="kw2">true</span>
 opacity<span class="sy0">:</span> scale <span class="sy0">/</span> <span class="nu0">2</span>.
 <span class="br0">&#125;</span>
 path<span class="sy0">:</span> Ellipse <span class="br0">&#123;</span>
 width<span class="sy0">:</span> view.<span class="me1">width</span>
 height<span class="sy0">:</span> view.<span class="me1">height</span>
 <span class="br0">&#125;</span>
 <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></div></div>
<p>Кода не е много, нали? Но вече си има всичко необходимо за разкошно 3D меню. Имитираме 3D като намаляваме размера на иконите когато отивам към горната част на екрана. Намаляването на прозрачността също спомага за този ефект. Ако отворите <i>Carousel4.qml</i> в <b>qmlviewer</b>, трябва да видите:
</p><p><a href="../indexe67d.html?title=Special:Upload&amp;wpDestFile=Https://www.gitorious.org/qt-training/qml-demos/blobs/raw/b0cdec015684c0d2a7042f11ff53eca683c3dc52/carousel/Carousel4.png" class="new" title="File:Https://www.gitorious.org/qt-training/qml-demos/blobs/raw/b0cdec015684c0d2a7042f11ff53eca683c3dc52/carousel/Carousel4.png">Carousel4.png</a>
</p>
<h2><span class="mw-headline" id=".D0.94.D0.BE.D0.B1.D0.B0.D0.B2.D1.8F.D0.BD.D0.B5_.D0.BD.D0.B0_.D1.83.D0.BF.D1.80.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D1.81_.D0.BA.D0.BB.D0.B0.D0.B2.D0.B8.D0.B0.D1.82.D1.83.D1.80.D0.B0.D1.82.D0.B0">Добавяне на управление с клавиатурата</span></h2>
<p>Добаването на управление с клавиатурата е доста лесно. Първо добавяме следните три реда код, за да обработваме събития от клавиатурата:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="co1">// Carousel5.qml</span>
…
PathView <span class="br0">&#123;</span>
 …
 focus<span class="sy0">:</span> <span class="kw2">true</span>
 Keys.<span class="me1">onLeftPressed</span><span class="sy0">:</span> decrementCurrentIndex<span class="br0">&#40;</span><span class="br0">&#41;</span>
 Keys.<span class="me1">onRightPressed</span><span class="sy0">:</span> incrementCurrentIndex<span class="br0">&#40;</span><span class="br0">&#41;</span>
 …
<span class="br0">&#125;</span>
…</pre></div></div>
<p>Всички визуални елемент има свойство <i>focus</i>. Само един елемент в даден момент може да има това свойство сложено на <i>true</i> и той е този който ще получи съобщения от клавиатурата. Използваме <a rel="nofollow" class="external text" href="http://developer.qt.nokia.com/doc/qt-4.7/qml-keys.html">Keys</a> за да получаваме събития от клавиатурата. Можехме да използваме и по-сложният начин за обработка на съобщенията:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1">Keys.<span class="me1">onPressed</span><span class="sy0">:</span> <span class="br0">&#123;</span>
 <span class="kw1">if</span> <span class="br0">&#40;</span>event.<span class="me1">key</span>  <span class="kw5">Qt</span>.<span class="me1">Key_Left</span><span class="br0">&#41;</span> decrementCurrentIndex<span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">&#40;</span>event.<span class="me1">key</span>  <span class="kw5">Qt</span>.<span class="me1">Key_Right</span><span class="br0">&#41;</span> incrementCurrentIndex<span class="br0">&#40;</span><span class="br0">&#41;</span>
 event.<span class="me1">accepted</span> <span class="sy0">=</span> <span class="kw2">true</span>
<span class="br0">&#125;</span></pre></div></div>
<p>Както виждате ние увеличаваме и намаляваме текущият индекс, когато се натисне бутон. Но кой точно е текущият елемент? Тъй като пътят може да приеме всякаква абстрактна форма, как може да знаем кой трябва да е тукещо активният елемент, ако изобщо има такъв? Чрез добавянето на следните редове код, можем да укажем на <i>PathView</i> да следи текущият елемент:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1">…
PathView <span class="br0">&#123;</span>
 …
 preferredHighlightBegin<span class="sy0">:</span> <span class="nu0">0</span>
 preferredHighlightEnd<span class="sy0">:</span> <span class="nu0">0</span>
 highlightRangeMode<span class="sy0">:</span> PathView.<span class="me1">StrictlyEnforceRange</span>
 …
<span class="br0">&#125;</span>
…</pre></div></div>
<p>В нашият случай, решихме да направим първият елемент на пътя текущ. Сега вече трябва да можем да навигираме с клавиатурата като увеличаваме и намаляваме текущият елемент. Опитайте като отворите <i>Carousel5.qml</i> в <b>qmlviewer</b>.
</p>
<h2><span class="mw-headline" id=".D0.94.D0.BE.D0.BD.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.B2.D0.B0.D0.BD.D0.B5">Донастройване</span></h2>
<p>Накрая бихме желали да показваме и заглавието на текущият елемент. <i>PathView</i> има свойство <i>highlightItem</i>, което бихме могли да използваме за подчертаване, но ние ще го използваме само за да изпишем <a rel="nofollow" class="external text" href="http://developer.qt.nokia.com/doc/qt-4.7/qml-text.html">текст</a>. Тук също се вижда и как да свържете два компонента.
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1">…
PathView <span class="br0">&#123;</span>
 id<span class="sy0">:</span> view
 …
<span class="br0">&#125;</span>
Text <span class="br0">&#123;</span>
 id<span class="sy0">:</span> label
 text<span class="sy0">:</span> view.<span class="me1">model</span>.<span class="me1">get</span><span class="br0">&#40;</span>view.<span class="me1">currentIndex</span><span class="br0">&#41;</span>.<span class="me1">title</span>
 color<span class="sy0">:</span> <span class="st0">&quot;paleturquoise&quot;</span>
 font.<span class="me1">pixelSize</span><span class="sy0">:</span> <span class="nu0">16</span>
 font.<span class="me1">bold</span><span class="sy0">:</span> <span class="kw2">true</span>
 anchors.<span class="me1">horizontalCenter</span><span class="sy0">:</span> parent.<span class="me1">horizontalCenter</span>
 anchors.<span class="me1">bottom</span><span class="sy0">:</span> parent.<span class="me1">bottom</span>
<span class="br0">&#125;</span>
…</pre></div></div>
<p>Qt Quick предоставя богат набор от възможности за оформление на текста. Цвета <i>paleturquoise</i> е един от <a rel="nofollow" class="external text" href="http://www.w3.org/TR/SVG/types.html#ColorKeywords">имената за цветове в SVG</a>.
Както може да видите, ние свързваме текста директно с заглавието от модела. Този начин на присвояване на стойности е бърз и лесен. Всеки път, когато <i>currentIndex</i> се промени, QML автоматично ще обнови текста с новата стойност. Но трябва да внимавате, може да възникне проблем. Не злоупотребявайте с директното свързване между различни обекти. На промер, когато решим да преименуваме <i>title</i> атрибута на модела на нещо друго, ще развалим всички свързвания, които включват <i>title</i> и няма да получим предупреждение, докато компонента не бъде създаден.
</p>
<h2><span class="mw-headline" id=".D0.98.D0.BD.D1.82.D0.B5.D1.80.D0.BD.D0.B0.D1.86.D0.B8.D0.BE.D0.BD.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D1.8F">Интернационализация</span></h2>
<p>Вече говорихме по доста теми в този урок, който беше предназначен да бъде като бърза обиколка в Qt Quick, но ако започнем да говорим за неща като свързване със C++ код, пакетиране и разпространение към потребителите, това ще ни отклони от първоначалната ни цел да запазим нещата прости. Но има още една важна тема, която все още можем да включим- интернационализацията. Обикновено това е доста сложна тема, но Qt прави превода на приложения удивително лесен.
</p><p>Qt включва <a rel="nofollow" class="external text" href="http://developer.qt.nokia.com/doc/qt-4.7/linguist-manual.html">Qt Linguist</a>, който е мощен инструмент за превод на приложения. Същите процедури, използвани в C++ кода важат и в QML с изключение на <a rel="nofollow" class="external text" href="http://developer.qt.nokia.com/doc/qt-4.7/qdeclarative.html">няколко неща</a>
</p><p>Текстовете, които трябва да бъдат преведени в QML, трябва да са сложени във функцията <i>qsTr()</i>. Така инструмента <b>lupdate</b> ще може да извади тези текстове и да генерира XML файлове за превод (с разширение .ts). След това преводача, може да добави превод като използва <b>Qt Linguist</b> и след като са готови .ts се компилират до .qm файлове като се използва програмата <b>lrelease</b>. За да проверите превода просто подайте .qm файла на <b>qmlviewer</b> с опцията -translation.
</p><p>Има няколко проблема, за които трябва да знаете, така че нека да преведем заглавията на менюто. Може би си мислите, че можете просто да сложите <i>title</i> текста във функцията по този начин:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1">ListModel <span class="br0">&#123;</span>
 ListElement <span class="br0">&#123;</span> title<span class="sy0">:</span> qsTr<span class="br0">&#40;</span><span class="st0">&quot;Calendar&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span> iconSource<span class="sy0">:</span> <span class="st0">&quot;icons/calendar.png&quot;</span> <span class="br0">&#125;</span>
 …</pre></div></div>
<p>Но това няма да проработи, защото не е позволено изрази да са стойности на елемнтите. Има няколко начина да се заобиколи този проблем. Тъй като JavaScript функциите са позволени почти навсякъде, решаваме да пренапишем <i>title</i> като функция:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="co1">// Menu1.qml</span>
import QtQuick <span class="nu16">1.0</span>
&#160;
ListModel <span class="br0">&#123;</span>
 ListElement <span class="br0">&#123;</span> iconSource<span class="sy0">:</span> <span class="st0">&quot;icons/calendar.png&quot;</span> <span class="br0">&#125;</span>
 ListElement <span class="br0">&#123;</span> iconSource<span class="sy0">:</span> <span class="st0">&quot;icons/develop.png&quot;</span> <span class="br0">&#125;</span>
 ListElement <span class="br0">&#123;</span> iconSource<span class="sy0">:</span> <span class="st0">&quot;icons/globe.png&quot;</span> <span class="br0">&#125;</span>
 ListElement <span class="br0">&#123;</span> iconSource<span class="sy0">:</span> <span class="st0">&quot;icons/mail.png&quot;</span> <span class="br0">&#125;</span>
 ListElement <span class="br0">&#123;</span> iconSource<span class="sy0">:</span> <span class="st0">&quot;icons/music.png&quot;</span> <span class="br0">&#125;</span>
 ListElement <span class="br0">&#123;</span> iconSource<span class="sy0">:</span> <span class="st0">&quot;icons/phone.png&quot;</span> <span class="br0">&#125;</span>
 function title<span class="br0">&#40;</span>index<span class="br0">&#41;</span> <span class="br0">&#123;</span>
 <span class="kw1">if</span> <span class="br0">&#40;</span>title<span class="br0">&#91;</span><span class="st0">&quot;text&quot;</span><span class="br0">&#93;</span> <span class="sy0">===</span> undefined<span class="br0">&#41;</span> <span class="br0">&#123;</span>
 title.<span class="me1">text</span> <span class="sy0">=</span> <span class="br0">&#91;</span>
 qsTr<span class="br0">&#40;</span><span class="st0">&quot;Calendar&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span>
 qsTr<span class="br0">&#40;</span><span class="st0">&quot;Setup&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span>
 qsTr<span class="br0">&#40;</span><span class="st0">&quot;Internet&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span>
 qsTr<span class="br0">&#40;</span><span class="st0">&quot;Messages&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span>
 qsTr<span class="br0">&#40;</span><span class="st0">&quot;Music&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span>
 qsTr<span class="br0">&#40;</span><span class="st0">&quot;Call&quot;</span><span class="br0">&#41;</span>
 <span class="br0">&#93;</span>
 <span class="br0">&#125;</span>
 <span class="kw1">return</span> title.<span class="me1">text</span><span class="br0">&#91;</span>index<span class="br0">&#93;</span>
 <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></div></div>
<p>Както може да видите, ние извикваме <i>qsTr()</i> за всеки елемент от модела, когато <i>title()</i> функцията е извикана за първи път. Разбира се такива конструкции се налагат само, когато трябва да се справите с превод на стойности в модел. Всички други текстове могат да бъдат преведени дитектно с <i>qsTr()</i>.
Тъй като променихме дефиницията на модела, трябва да променим и местата, където се използваше старият вариант. За радост имаме късмет, че трябва да променим само един ред код:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1">text<span class="sy0">:</span> view.<span class="me1">model</span>.<span class="me1">title</span><span class="br0">&#40;</span>view.<span class="me1">currentIndex</span><span class="br0">&#41;</span></pre></div></div>
<p>Извикваме <b>lupdate</b>, за да генерираме XML файловете за превод:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1">lupdate . <span class="sy0">-</span>ts Carousel_de.<span class="me1">ts</span> <span class="sy0">-</span>codecfortr UTF<span class="sy0">-</span><span class="nu0">8</span></pre></div></div>
<p>После отваряме файла с <b>linguist</b> и правим превода. След като сте съвршили, извиквате <b>lrelease</b>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1">lrelease Carousel_de.<span class="me1">ts</span></pre></div></div>
<p><b>lrelease</b> ще генерита нов <i>Carousel_de.qml</i>. Може да тествате превода като изпълните командата:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1">usr<span class="sy0">/</span>bin<span class="sy0">/</span>qmlviewer <span class="sy0">-</span>translation Carousel_de.<span class="me1">qm</span> Carousel7.<span class="me1">qml</span></pre></div></div>

<!-- 
NewPP limit report
CPU time usage: 0.367 seconds
Real time usage: 0.387 seconds
Preprocessor visited node count: 179/1000000
Preprocessor generated node count: 472/1000000
Post‐expand include size: 1288/2097152 bytes
Template argument size: 417/2097152 bytes
Highest expansion depth: 5/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key qtio_wiki:pcache:idhash:1532-0!*!0!!en!2!* and timestamp 20151104103956 and revision id 16040
 -->
</div>								<div class="printfooter">
				Retrieved from "<a href="../indexb59a.html?title=Qt_Quick_Carousel/bg&amp;oldid=16040">http://wiki.qt.io/index.php?title=Qt_Quick_Carousel/bg&amp;oldid=16040</a>"				</div>
												<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="../Special_Categories.html" title="Special:Categories">Categories</a>: <ul><li><a href="../Category_Articles_needing_cleanup.html" title="Category:Articles needing cleanup">Articles needing cleanup</a></li><li><a href="../Category_Developing_with_Qt__Qt_Quick.html" title="Category:Developing with Qt::Qt Quick">Developing with Qt::Qt Quick</a></li><li><a href="../Category_Pages_with_broken_file_links.html?title=Category:Pages_with_broken_file_links&amp;action=edit&amp;redlink=1" class="new" title="Category:Pages with broken file links (page does not exist)">Pages with broken file links</a></li></ul></div></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
				<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
	<h3 id="p-personal-label">Personal tools</h3>
	<ul>
<li id="pt-anonuserpage"><a href="../User_10.0.113.html" class="new" title="The user page for the IP address you are editing as [.]" accesskey=".">10.0.113.70</a></li><li id="pt-anontalk"><a href="../User_talk_10.0.113.html" class="new" title="Discussion about edits from this IP address [n]" accesskey="n">Talk for this IP address</a></li><li id="pt-login"><a href="https://login.qt.io/authorize?client_id=one-qt-server-003&amp;response_type=code&amp;state=62f0e3cf5e40830d&amp;scope=authorizations&amp;redirect_uri=https%3A%2F%2Fwiki.qt.io%2FSpecial%3AQtLogin%2Fcallback" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Sign in</a></li>	</ul>
</div>
				<div id="left-navigation">
					<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
	<h3 id="p-namespaces-label">Namespaces</h3>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="bg.html"  title="View the content page [c]" accesskey="c">Page</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="../Talk_Qt_Quick_Carousel/bg.html?title=Talk:Qt_Quick_Carousel/bg&amp;action=edit&amp;redlink=1"  title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
			</ul>
</div>
<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
	<h3 id="mw-vector-current-variant">
		</h3>
	<h3 id="p-variants-label"><span>Variants</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
				</div>
				<div id="right-navigation">
					<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
	<h3 id="p-views-label">Views</h3>
	<ul>
					<li id="ca-view" class="selected"><span><a href="bg.html" >Read</a></span></li>
					<li id="ca-viewsource"><span><a href="../index17d7.html?title=Qt_Quick_Carousel/bg&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
					<li id="ca-history" class="collapsible"><span><a href="../index3c69-3.html?title=Qt_Quick_Carousel/bg&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
			</ul>
</div>
<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
	<h3 id="p-cactions-label"><span>Actions</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
<div id="p-search" role="search">
	<h3><label for="searchInput">Search</label></h3>
	<form action="http://wiki.qt.io/index.php" id="searchform">
					<div id="simpleSearch">
					<input type="search" name="search" placeholder="Search" title="Search Qt Wiki [f]" accesskey="f" id="searchInput" /><input type="hidden" value="Special:Search" name="title" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton" />		</div>
	</form>
</div>
				</div>
			</div>
			<div id="mw-panel">
					<div id="p-logo" role="banner"><a style="background-image: url(../skins/common/images/wiki.png);" href="../Main_Page.html"  title="Visit the main page"></a></div>
				<div class="portal" role="navigation" id='p-navigation' aria-labelledby='p-navigation-label'>
	<h3 id='p-navigation-label'>Navigation</h3>
	<div class="body">
		<ul>
			<li id="n-mainpage-description"><a href="../Main_Page.html" title="Visit the main page [z]" accesskey="z">Main page</a></li>
			<li id="n-recentchanges"><a href="../Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
			<li id="n-randompage"><a href="../How_to_create_columns_in_a_QML_ListView.html" title="Load a random page [x]" accesskey="x">Random page</a></li>
			<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
	<h3 id='p-tb-label'>Tools</h3>
	<div class="body">
		<ul>
			<li id="t-whatlinkshere"><a href="../Special_WhatLinksHere/Qt_Quick_Carousel/bg.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
			<li id="t-recentchangeslinked"><a href="../Special_RecentChangesLinked/Qt_Quick_Carousel/bg.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
			<li id="t-specialpages"><a href="../Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
			<li id="t-print"><a href="../index35c4.html?title=Qt_Quick_Carousel/bg&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
			<li id="t-permalink"><a href="../indexb59a.html?title=Qt_Quick_Carousel/bg&amp;oldid=16040" title="Permanent link to this revision of the page">Permanent link</a></li>
			<li id="t-info"><a href="../index5a4e.html?title=Qt_Quick_Carousel/bg&amp;action=info">Page information</a></li>
		</ul>
	</div>
</div>
			</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 17 April 2015, at 12:30.</li>
											<li id="footer-info-viewcount">This page has been accessed 395 times.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-terms"><a href='https://developer.qtcloudservices.com/legal/terms'>Käyttöehdot</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
					<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<script>/*<![CDATA[*/window.jQuery && jQuery.ready();/*]]>*/</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","skins.vector.collapsibleNav"],null,true);
}</script>
<script src="../load55ad.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54043535-2', 'auto');
  ga('send', 'pageview');

</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":215});
}</script>
	</body>

<!-- Mirrored from wiki.qt.io/Qt_Quick_Carousel/bg by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 05 Nov 2015 10:19:02 GMT -->
</html>
