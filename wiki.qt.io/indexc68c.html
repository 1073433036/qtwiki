<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from wiki.qt.io/index.php?title=Qt_5_on_Windows_8_and_Metro_UI&printable=yes by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 05 Nov 2015 14:28:30 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>Qt 5 on Windows 8 and Metro UI - Qt Wiki</title>
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />
<meta name="generator" content="MediaWiki 1.23.3" />
<meta name="robots" content="noindex,follow" />
<link rel="shortcut icon" href="favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Qt Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="api251f.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Qt Wiki Atom feed" href="apidf90.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="load6077.css?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.vector.styles&amp;only=styles&amp;printable=1&amp;skin=vector&amp;*" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="load8b5e.css?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;printable=1&amp;skin=vector&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: qtio_wiki:resourceloader:filter:minify-css:7:e91d7bc946738c8892a88ad5616a59ba */</style>
<script src="load041f.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;printable=1&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Qt_5_on_Windows_8_and_Metro_UI","wgTitle":"Qt 5 on Windows 8 and Metro UI","wgCurRevisionId":19281,"wgRevisionId":19281,"wgArticleId":1581,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Qt_5_on_Windows_8_and_Metro_UI","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"hidesig":true,"preview":true,"previewDialog":false,"publish":true}});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"editfont":"default","editondblclick":0,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":1,"extendwatchlist":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nickname":"","norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"rcdays":7,"rclimit":50,"rows":25,"showhiddencats":0,"shownumberswatching":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":1,"watchdefault":1,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,
"useeditwarning":1,"prefershttps":1,"usebetatoolbar":1,"usebetatoolbar-cgd":1,"wikieditor-preview":1,"wikieditor-publish":1,"language":"en","variant-gan":"gan","variant-iu":"iu","variant-kk":"kk","variant-ku":"ku","variant-shi":"shi","variant-sr":"sr","variant-tg":"tg","variant-uz":"uz","variant-zh":"zh","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"searchNs500":false,"searchNs501":false,"searchNs700":false,"searchNs701":false,"variant":"en"});},{},{});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});},{},{});
/* cache key: qtio_wiki:resourceloader:filter:minify-js:7:9743cb8b8019d46de5946bfe6dfa04d7 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Qt_5_on_Windows_8_and_Metro_UI skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">Qt 5 on Windows 8 and Metro UI</span></h1>
						<div id="bodyContent">
								<div id="siteSub">From Qt Wiki</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-navigation">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#1_Introduction"><span class="tocnumber">1</span> <span class="toctext">1 Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#2_Project_Overview"><span class="tocnumber">2</span> <span class="toctext">2 Project Overview</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#3_Background"><span class="tocnumber">3</span> <span class="toctext">3 Background</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#3.1_Windows_8_Versions"><span class="tocnumber">3.1</span> <span class="toctext">3.1 Windows 8 Versions</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#3.2_Metro_UI"><span class="tocnumber">3.2</span> <span class="toctext">3.2 Metro UI</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#3.3_Windows_Runtime_.28WinRT.29"><span class="tocnumber">3.3</span> <span class="toctext">3.3 Windows Runtime (WinRT)</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#3.4_ANGLE"><span class="tocnumber">3.4</span> <span class="toctext">3.4 ANGLE</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#3.5_Microsoft_Store"><span class="tocnumber">3.5</span> <span class="toctext">3.5 Microsoft Store</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#4_Areas_of_Investigation"><span class="tocnumber">4</span> <span class="toctext">4 Areas of Investigation</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#4.1_Building_Qt_5_on_Windows_Runtime"><span class="tocnumber">4.1</span> <span class="toctext">4.1 Building Qt 5 on Windows Runtime</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#4.2_Qt_QPA_plugin_for_DirectX_on_Windows_8"><span class="tocnumber">4.2</span> <span class="toctext">4.2 Qt QPA plugin for DirectX on Windows 8</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#4.3_QML_Components_for_Metro_UI"><span class="tocnumber">4.3</span> <span class="toctext">4.3 QML Components for Metro UI</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#4.4_Microsoft_Store_Requirements_and_Restrictions"><span class="tocnumber">4.4</span> <span class="toctext">4.4 Microsoft Store Requirements and Restrictions</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="#5_Risks_and_Unknowns"><span class="tocnumber">5</span> <span class="toctext">5 Risks and Unknowns</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="#6_Effort_Estimates"><span class="tocnumber">6</span> <span class="toctext">6 Effort Estimates</span></a></li>
<li class="toclevel-1 tocsection-16"><a href="#7_Conclusions"><span class="tocnumber">7</span> <span class="toctext">7 Conclusions</span></a></li>
<li class="toclevel-1 tocsection-17"><a href="#8_References"><span class="tocnumber">8</span> <span class="toctext">8 References</span></a></li>
<li class="toclevel-1 tocsection-18"><a href="#A_Appendix"><span class="tocnumber">9</span> <span class="toctext">A Appendix</span></a>
<ul>
<li class="toclevel-2 tocsection-19"><a href="#A.1_Notes_on_Building_ANGLE_on_Windows_8_Win32"><span class="tocnumber">9.1</span> <span class="toctext">A.1 Notes on Building ANGLE on Windows 8 Win32</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#A.2_Notes_on_Building_Qt_5_on_Windows_8_Win32"><span class="tocnumber">9.2</span> <span class="toctext">A.2 Notes on Building Qt 5 on Windows 8 Win32</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#A.3_Notes_on_Building_ANGLE_on_Windows_8_WinRT"><span class="tocnumber">9.3</span> <span class="toctext">A.3 Notes on Building ANGLE on Windows 8 WinRT</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#A.4_Notes_on_Building_Qt_5_on_Windows_8_WinRT"><span class="tocnumber">9.4</span> <span class="toctext">A.4 Notes on Building Qt 5 on Windows 8 WinRT</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="1_Introduction">1 Introduction</span></h2>
<p>This document is a report on an investigation into the feasibility of supporting the Windows 8 Metro UI platform with Qt 5 and QML. It represents about ten days of investigation into the feasibility to determine if there were any showstoppers or other roadblocks and which of several approaches might be feasible. The intent is to use this preliminary investigation to make a decision on whether to proceed with the effort to support the Metro UI platform with Qt 5.
</p>
<h2><span class="mw-headline" id="2_Project_Overview">2 Project Overview</span></h2>
<p>The scope of the investigation were applications written using Qt 5, specifically QML applications using the scene-graph based Quick 2 which is new in Qt 5. The target platform was Windows 8 on desktops and tablets running in the Metro UI environment. It did not look at Windows Phone 7. The current Windows Phone 7 does not support C++ programming although it appears that this will change in Windows Phone 8. The information here focuses on the x86 platform rather than ARM architecture, although most information should be applicable to both platforms.
</p>
<h2><span class="mw-headline" id="3_Background">3 Background</span></h2>
<p>This section gives some background information on Windows 8 and the technical terms used in the report.
</p>
<h3><span class="mw-headline" id="3.1_Windows_8_Versions">3.1 Windows 8 Versions</span></h3>
<p>Windows 8 is Microsoft's next major release of Windows, targeted at desktops, laptops, tablets, and home theatre PCs. Windows 8 will have two modes: Metro UI and Desktop. Windows 8 will target two architectures: x86 (Windows on Intel or WOI) and ARM (Windows on ARM or WOA). WOA is also known as Windows RT, not to be confused with Windows Runtime or WinRT. This diagram below shows the high-level architecture of
Windows 8.
</p><p><img src="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2011/09/Windows8Architecture.jpg" alt="Windows8Architecture.jpg" />
</p><p>Windows 8 is currently available as a Release Preview.
</p>
<h3><span class="mw-headline" id="3.2_Metro_UI">3.2 Metro UI</span></h3>
<p>Windows 8 features a new user interface called Metro. The interface is suited for touch-enabled applications using a tile-based interface similar to Windows Phone. Traditional Windows desktop applications can be run on Windows 8 in desktop mode, which offers a similar interface to previous versions of Microsoft Windows.
</p>
<h3><span class="mw-headline" id="3.3_Windows_Runtime_.28WinRT.29">3.3 Windows Runtime (WinRT)</span></h3>
<p>Metro UI applications are developed using the new Windows Runtime platform. It supports a number of programming languages including C+<i>, Visual Basic, C#, and HTML/JavaScript. Legacy Win32, MFC, and related APIs will only be available under the Desktop mode. To access similar services under the Metro UI mode, developers will have to use the new Windows Runtime. Native C</i>+ development in possible in Windows 8 for both Metro UI and Desktop modes.
</p>
<h3><span class="mw-headline" id="3.4_ANGLE">3.4 ANGLE</span></h3>
<p>It is expected that Windows 8 Metro UI mode (i.e. WinRT) will not support OpenGL. However, Qt Quick in Qt 5 currently requires OpenGL or OpenGL ES. A possible solution is to use the open source ANGLE project [Reference 3], which translates OpenGL ES 2.0 API called to DirectX9. The problem with this is that Metro applications require the DirectX 11 SDK, which would in turn require significant porting effort to ANGLE.
</p>
<h3><span class="mw-headline" id="3.5_Microsoft_Store">3.5 Microsoft Store</span></h3>
<p>Metro UI applications will be available only from the Microsoft Store. Desktop mode applications will be distributed through current means such as DVDs, downloads, etc. In addition, there will be app stores other than Microsoft's where WOI applications can be purchased and downloaded. WOA applications will only be available through the Microsoft Store. There will be restrictions on the APIs that applications distributed in the Microsoft Store can use. For example, Microsoft had made statements that they do not want to support any Windows 7 or XP emulators of virtual machines under WOA. It is not clear if a port of Qt could be declared an emulator and forbidden under the terms of service.
</p>
<h2><span class="mw-headline" id="4_Areas_of_Investigation">4 Areas of Investigation</span></h2>
<p>This section describes the investigation work that was performed.
</p>
<h3><span class="mw-headline" id="4.1_Building_Qt_5_on_Windows_Runtime">4.1 Building Qt 5 on Windows Runtime</span></h3>
<p>Before building Qt 5 under WinRT, both Qt 5 and ANGLE were built in the Win32 (desktop) environment as a point of reference.
</p><p>Building ANGLE on Win32 was straightforward and proceeded with no major problems. See the Appendix for details on how it was built.
</p><p>Building Qt 5 on Win32 was also completed. See the appendix for details on how it was built. In conjunction with ANGLE this allowed Qt 5 to run on Windows 8 in the desktop mode.
</p><p>OpenGL rendering with ANGLE seemed to be quite functional under Win32 with no artifacts seen. The next step was to building ANGLE under the WinRT environment. Three major issues were identified here.
</p>
<ol>
<li> Metro-style applications are sandboxed. There is a good chance networking and file system classes will not work without modification. For example, what does file system mean in an environment which only allows an application to access storage specifically created for it? 
</li>
<li> WinRT uses a new ThreadPool class to handle threading. We need to figure out how this works and replace the old DLL_PROCESS_ATTACH etc. code in dllmain for both ANGLE dlls. There is a small library available which emulates the old (Win32) way of doing threading using the new Windows::System::Threading namespace in WinRT. Another possibility might be to use C++11 threading. 
</li>
<li> There are parts of DirectX 9 which are only available for use with Windows 8 desktop applications. Microsoft explicitly removed these capabilities, so it isn't a valid solution to link against the old versions of the libraries. The alternative is to rewrite ANGLE to use the interfaces exposed in Metro UI applications. It is expected that the DirectX code will have to be completely rewritten using Metro UI concepts of windows and events. The code can no longer use D3DX (an entire library of deprecated convenience functions). The concept of native window handles does not exist in Metro. It is unclear if there is a solution for this last problem. 
</li>
</ol>
<p>An initial effort was made to build Qt 5 on WinRT. To do this we followed the procedure that had been published for building Qt 4.8 [Reference 6]. One of the requirements was to build the Qt 5 libraries statically. We were able to build the following Qt modules/libraries on WinRT: QtConcurrent, QtCore, QtGui, QtNetwork, QtPlatformSupport, QtPrintSupport, QtQml, QtSql, QtSvg, QtTest, QtV8, QtWidgets, QtXml, QtXmlPatterns.
</p><p>We were not able to build Qt Quick because of the lack of a port of ANGLE meant that there was no OpenGL support. Some "shortcuts" were needed to get Qt 5 to build, such as taking some libraries and header files from the Windows 7 SDK. These may have an impact on whether Qt could meet the Microsoft Store guidelines (See the "Risks and Unknowns" section).
</p>
<h3><span class="mw-headline" id="4.2_Qt_QPA_plugin_for_DirectX_on_Windows_8">4.2 Qt QPA plugin for DirectX on Windows 8</span></h3>
<p>The standard approach for porting Qt 5 to a new windowing platform is to write a back end for the Qt Platform Abstraction (QPA), formerly known as Lighthouse. A QPA plugin could theoretically be written on top of DirectX for Windows 8. This would be an alternative approach to using ANGLE. However, Qt Quick 2 currently has many dependencies on OpenGL or OpenGL ES so this would involve many changes to Qt in addition to the QPA plugin. Due to the major effort to re-architect Qt Quick to remove the dependencies on OpenGL, this approach was ruled out.
</p>
<h3><span class="mw-headline" id="4.3_QML_Components_for_Metro_UI">4.3 QML Components for Metro UI</span></h3>
<p>Qt 5 focuses on using Qt Quick (QML) and applications developed in QML for Windows 8 should support the Metro UI. Ideally a version of the Qt QML Components would be available that supports the Metro UI look and feel. This would likely need to be extended with some additional components specific to Metro UI such as Pivot and Panorama.
</p><p>Some earlier work has been done to demonstrate Metro UI using QML [Reference 6]. This appears to be feasible and straightforward. Investigation of QML components for Metro UI was not part of scope of work for this initial investigation as it would be meaningless unless Qt 5 and Qt Quick can first be ported.
</p>
<h3><span class="mw-headline" id="4.4_Microsoft_Store_Requirements_and_Restrictions">4.4 Microsoft Store Requirements and Restrictions</span></h3>
<p>Investigating the Microsoft Store requirements and restrictions and whether Qt on Windows 8 will meet the terms of service is an area that requires additional work once more is known about the store requirements. This was not part of the scope of this initial investigation work.
</p>
<h2><span class="mw-headline" id="5_Risks_and_Unknowns">5 Risks and Unknowns</span></h2>
<p>The following are areas of risks and unknowns that require further investigation if the project moves forward to an implementation phase:
</p>
<ol>
<li> It will be a significant effort to port ANGLE to WinRT. It is unclear if this will even be possible due to the limitations of WinRT (specifically, the lack of native window handles). It will almost certainly require changing all DirectX 9 calls to equivelent DirectX 11 calls (see <a rel="nofollow" class="external text" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ff476190(v=vs.85).aspx#direct3d_9_to_direct3d_11">porting guide</a>). Even if this is possible, there is a risk that ANGLE-based Qt Quick applications would be ineligible for the Microsoft Store unless full binary shader support can be added to Qt/QML. See <a rel="nofollow" class="external text" href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd607342(v=vs.85).aspx">this link</a>, which suggests that dynamically compiling and linking shaders (something used heavily within the SceneGraph and required by e.g. the QML ShaderEffect), is only available during development; developers are required to provide object code for all shader binaries used within store applications.
</li>
</ol>
<ol>
<li> WinRT imposes some restrictions on file system and networking access. These need to be investigated in more detail to determine if they will affect the ability to implement some of the Qt APIs in these areas. 
</li>
<li> Some Windows 7 DLLs were needed to get Qt 5 to compile and link. More investigation is needed to determine if these DLLs will exist on Window 8, or if not, whether using them will violate the terms of service for applications distributed in the Microsoft Store. 
</li>
<li> Investigation focused on the Intel architecture. There may be additional issues specific to Windows 8 on ARM. 
</li>
<li> Windows 8 is not yet released so the supported APIs are still subject to change.
</li>
</ol>
<h2><span class="mw-headline" id="6_Effort_Estimates">6 Effort Estimates</span></h2>
<p>The following are some <b>very</b> rough order of magnitude estimates of possible future work.
</p><p><b>Port ANGLE to WinRT:</b> Unknown until more investigation is done. We estimate at least 10 to 15 man-days of further research is needed to determine if ANGLE on WinRT is feasible. If investigation finds that this is feasible, the effort is expected to be significant.
</p><p><b>Port Qt 5 to WinRT:</b> effort will vary depending on how many modules are ported, the assumption is just the Essential modules for now (Having seen that Windows 7 dlls cannot be used, some major rewrite has to happen to do a proper Qt port. Thus it is hard to tell, how much time will be needed)
</p><p><b>Implement Metro UI version of Qt Quick Components:</b> 150 man-days including testing, documentation, and writing at least one demonstration application. The effort would be more if additional components specific to Metro UI are developed.
</p><p><b>Investigate Microsoft Store requirements:</b> 20 man-days (includes writing a document on how to make Qt applications compliant).
</p><p>It is likely that the Qt 5 effort can leverage work already being done to port Qt 4 to WinRT and also leverage Digia's work on a QML-based Metro UI for Qt 4. If so, the effort could likely be reduced.
</p>
<h2><span class="mw-headline" id="7_Conclusions">7 Conclusions</span></h2>
<p>Based on this initial investigation, the only technical roadblock to supporting Qt 5 on Windows 8 and Metro UI is the effort to port ANGLE to WinRT. More research is needed to determine if this is feasible and what the effort would be. Other approaches, such as those not based on ANGLE and using DirectX only, do not appear feasible.
</p><p>Note that running Qt desktop applications on Windows 8 using Win32 and desktop mode can be done today with no development effort. However, the goal here was for Metro UI applications using QML and Qt 5. Further work is needed to investigation the Microsoft Store requirements, the effort to develop Metro UI versions of the Qt Quick Components.
</p>
<h2><span class="mw-headline" id="8_References">8 References</span></h2>
<ol>
<li> <a rel="nofollow" class="external text" href="http://windows.microsoft.com/en-US/windows-8/release-preview">Windows 8 Release Preview</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://www.microsoft.com/visualstudio/11/en-us">Visual Studio 2012 Release Candidate</a> 
</li>
<li> <a rel="nofollow" class="external text" href="http://code.google.com/p/angleproject/">Angle Project</a> 
</li>
<li> <a rel="nofollow" class="external text" href="Building-Qt-5-from-Git.html#aea23489ce3aa9b6406ebb28e0cda430">Building Qt 5 with support for Angle</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://www.digia.com/en/Blogs/Qt-blog/Sami-Makkonen/Dates/2012/1/2012/">Metro UI look and feel using Qt 4 and QML</a> 
</li>
<li> <a rel="nofollow" class="external text" href="https://projects.developer.nokia.com/qt_metro/wiki/FirstThoughts">Prototype Qt 4 code on Windows 8 with Metro UI</a> 
</li>
<li> <a rel="nofollow" class="external text" href="http://qt.gitorious.org/+ur-developers/qt/ur-developers-qt/commits/4.8-winrt">Qt 4 port to Windows 8 / Windows Runtime</a> 
</li>
</ol>
<h2><span class="mw-headline" id="A_Appendix">A Appendix</span></h2>
<h3><span class="mw-headline" id="A.1_Notes_on_Building_ANGLE_on_Windows_8_Win32">A.1 Notes on Building ANGLE on Windows 8 Win32</span></h3>
<p>ANGLE builds "out of the box" on Windows 8 using Visual Express 2008 as documented in the build instructions on the <a rel="nofollow" class="external text" href="http://code.google.com/p/angleproject/wiki/DevSetup">ANGLE project Wiki</a> . It did not build using Visual Studio Express 2012 Release Candidate but it did build with Visual Studio Professional 20112 Release Candidate.
</p>
<h3><span class="mw-headline" id="A.2_Notes_on_Building_Qt_5_on_Windows_8_Win32">A.2 Notes on Building Qt 5 on Windows 8 Win32</span></h3>
<p>Building Qt 5 on Windows 8 Win32 works just fine using the instructions on the Building Qt 5 Wiki page [Reference 4]. Note that when building with ANGLE, you need to use the "opengl es2 -angle" options, as suggested on the site. 
</p><p>A few errors were encountered during the build. A compile error in $(QtDir)3d\src\threed\textures\qgltextureutils.cpp about coercing types was fixed by adding a dynamic_cast to the specified type. One of the OpenGL examples complained about missing identifiers (e.g. glVertex3f, glBegin, glEnd). These should not exist in an OpenGL ES 2.0 application as those identifiers were relics from fixed function OpenGL, which was removed in ES 2.0, so it is a problem with this particular example application. 
</p><p>I then tested various demos and examples, including qmlscene. But first, I wanted to verify that ANGLE was really being used. So I introduced a failure into the ANGLE GLES2 Context API (ASSERT (0==1)). The applications failed as expected. I also tested with both the Debug and Release builds of Angle. Both worked fine, although Debug builds were much slower than the Release builds using a basic example hellowindow. With the Debug build, approximately 40% CPU usage was seen. With Release, it was about 2%. I guess this is not unexpected. 
</p><p>After the hellowindow test, I stuck with the Release build of Angle for testing other examples. I ran through most of the OpenGL examples in qtbase. I saw no issues, rendering artifacts or any instability. 
</p><p>Using qmlscene, I ran several of the example qml's such as clocks, plasmapatrol, samegame, rssnews, minesweeper, rssnews and several others. There were a couple of QML apps that did have problems, such as snake. This app (and a couple of others) caused an EGL error 3003 (EGL_BAD_ALLOC) during surface creation. It is not clear why this error occurred- more investigation will be required. It may be that the graphics hardware I am using cannot support whatever surface attributes the application needed. It was an older card. 
</p><p>In testing Angle with Qt5, on Win32 I found it to be quite reliable and saw no rendering artifacts. Investigating the reason for the EGL_BAD_ALLOC failures with some apps might be worthwhile in the future. EGL_BAD_ALLOC is one of those 'generic' errors that can have many possible causes. 
</p>
<h3><span class="mw-headline" id="A.3_Notes_on_Building_ANGLE_on_Windows_8_WinRT">A.3 Notes on Building ANGLE on Windows 8 WinRT</span></h3>
<p>You must define WINAPI_FAMILY WINAPI_PARTITION_APP in order to allow a Win32 DLL to be used in a MetroUI application. This has some consequences: 
</p>
<ul>
<li> Metro-Style applications are sandboxed. There is a good chance networking and file system classes will not work without modification 
</li>
</ul>
<ul>
<li> WinRT uses a new ThreadPool class to handle threading. Need to figure out how this works and replace the old DLL_PROCESS_ATTACH etc. code in dllmain for both ANGLE dlls. There is a <a rel="nofollow" class="external text" href="http://blogs.msdn.com/b/shawnhar/archive/2012/03/12/createthread-for-windows-8-metro.aspx">small library</a> written by someone which emulates the old (Win32) way of doing threading using the new Windows::System::Threading namespace in WinRT.
</li>
</ul>
<ul>
<li> There are parts of DirectX 9 which are only available for use with Windows 8 desktop applications. Microsoft explicitly removed these capabilities, so it isn't a valid solution to link against the old versions of the libraries. The alternative is to rewrite ANGLE to use the interfaces exposed in MetroUI applications. 
</li>
</ul>
<p>The DirectX code will have to be completely re-written using MetroUI concepts of windows and events.
</p><p>To build ANGLE on WinRT (MetroUI on Windows 8):
</p>
<ol>
<li> Install Windows 8 Release Preview SDK. 
</li>
<li> Windows 8 SDK now contains DirectX SDK. 
</li>
<li> Install Visual Studio 2012 Release Candidate. 
</li>
<li> Error: Dependency on d3dx9. All D3DX has been removed from Win8/DirectX. Follow instructions <a rel="nofollow" class="external text" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ee663275.aspx">here</a> to compile/link for legacy apps using d3dx. 
</li>
</ol>
<h3><span class="mw-headline" id="A.4_Notes_on_Building_Qt_5_on_Windows_8_WinRT">A.4 Notes on Building Qt 5 on Windows 8 WinRT</span></h3>
<p>Qt was built on WinRT (MetroUI and no ANGLE). It should be noted this was done in part to confirm Qt 5.0 will not build without ANGLE / OpenGL libraries. It was built as follows:
</p>
<ol>
<li> Using <a rel="nofollow" class="external text" href="http://projects.developer.nokia.com/qt_metro/wiki">this</a> as a guide to get started building Qt. 
</li>
<li> Download Windows 7 SDK to include legacy Windows Libraries and Headers 
</li>
<li> Configure per instructions on the Qt 4.8 on Metro wiki (with below deviations): 
</li>
<li> included -nomake tests 
</li>
<li> some tests failed to compile 
</li>
<li> Used Visual Studio 2012 RC Professional
</li>
</ol>

<!-- 
NewPP limit report
CPU time usage: 0.022 seconds
Real time usage: 0.023 seconds
Preprocessor visited node count: 86/1000000
Preprocessor generated node count: 92/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key qtio_wiki:pcache:idhash:1581-0!*!*!!en!*!* and timestamp 20151105100654 and revision id 19281
 -->
</div>								<div class="printfooter">
				Retrieved from "<a href="index9b3d.html?title=Qt_5_on_Windows_8_and_Metro_UI&amp;oldid=19281">http://wiki.qt.io/index.php?title=Qt_5_on_Windows_8_and_Metro_UI&amp;oldid=19281</a>"				</div>
												<div id='catlinks' class='catlinks catlinks-allhidden'></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
				<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
	<h3 id="p-personal-label">Personal tools</h3>
	<ul>
<li id="pt-anonuserpage"><a href="User_10.0.113.html" class="new" title="The user page for the IP address you are editing as [.]" accesskey=".">10.0.113.70</a></li><li id="pt-anontalk"><a href="User_talk_10.0.113.html" class="new" title="Discussion about edits from this IP address [n]" accesskey="n">Talk for this IP address</a></li><li id="pt-login"><a href="https://login.qt.io/authorize?client_id=one-qt-server-003&amp;response_type=code&amp;state=242035dbf6a21065&amp;scope=authorizations&amp;redirect_uri=https%3A%2F%2Fwiki.qt.io%2FSpecial%3AQtLogin%2Fcallback" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Sign in</a></li>	</ul>
</div>
				<div id="left-navigation">
					<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
	<h3 id="p-namespaces-label">Namespaces</h3>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="Qt_5_on_Windows_8_and_Metro_UI.html"  title="View the content page [c]" accesskey="c">Page</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="Talk_Qt_5_on_Windows_8_and_Metro_UI.html?title=Talk:Qt_5_on_Windows_8_and_Metro_UI&amp;action=edit&amp;redlink=1"  title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
			</ul>
</div>
<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
	<h3 id="mw-vector-current-variant">
		</h3>
	<h3 id="p-variants-label"><span>Variants</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
				</div>
				<div id="right-navigation">
					<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
	<h3 id="p-views-label">Views</h3>
	<ul>
					<li id="ca-view" class="selected"><span><a href="Qt_5_on_Windows_8_and_Metro_UI.html" >Read</a></span></li>
					<li id="ca-viewsource"><span><a href="index7ca7.html?title=Qt_5_on_Windows_8_and_Metro_UI&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
					<li id="ca-history" class="collapsible"><span><a href="index04eb.html?title=Qt_5_on_Windows_8_and_Metro_UI&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
			</ul>
</div>
<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
	<h3 id="p-cactions-label"><span>Actions</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
<div id="p-search" role="search">
	<h3><label for="searchInput">Search</label></h3>
	<form action="http://wiki.qt.io/index.php" id="searchform">
					<div id="simpleSearch">
					<input type="search" name="search" placeholder="Search" title="Search Qt Wiki [f]" accesskey="f" id="searchInput" /><input type="hidden" value="Special:Search" name="title" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton" />		</div>
	</form>
</div>
				</div>
			</div>
			<div id="mw-panel">
					<div id="p-logo" role="banner"><a style="background-image: url(skins/common/images/wiki.png);" href="Main_Page.html"  title="Visit the main page"></a></div>
				<div class="portal" role="navigation" id='p-navigation' aria-labelledby='p-navigation-label'>
	<h3 id='p-navigation-label'>Navigation</h3>
	<div class="body">
		<ul>
			<li id="n-mainpage-description"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main page</a></li>
			<li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
			<li id="n-randompage"><a href="How_to_create_columns_in_a_QML_ListView.html" title="Load a random page [x]" accesskey="x">Random page</a></li>
			<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
	<h3 id='p-tb-label'>Tools</h3>
	<div class="body">
		<ul>
			<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/Qt_5_on_Windows_8_and_Metro_UI.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
			<li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/Qt_5_on_Windows_8_and_Metro_UI.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
			<li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
			<li id="t-permalink"><a href="index9b3d.html?title=Qt_5_on_Windows_8_and_Metro_UI&amp;oldid=19281" title="Permanent link to this revision of the page">Permanent link</a></li>
			<li id="t-info"><a href="indexa32d-2.html?title=Qt_5_on_Windows_8_and_Metro_UI&amp;action=info">Page information</a></li>
		</ul>
	</div>
</div>
			</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 23 August 2015, at 13:23.</li>
											<li id="footer-info-viewcount">This page has been accessed 5,158 times.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-terms"><a href='https://developer.qtcloudservices.com/legal/terms'>Käyttöehdot</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
					<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<script>/*<![CDATA[*/window.jQuery && jQuery.ready();/*]]>*/</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","skins.vector.collapsibleNav"],null,true);
}</script>
<script src="load2f85.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;printable=1&amp;skin=vector&amp;*"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54043535-2', 'auto');
  ga('send', 'pageview');

</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":194});
}</script>
	</body>

<!-- Mirrored from wiki.qt.io/index.php?title=Qt_5_on_Windows_8_and_Metro_UI&printable=yes by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 05 Nov 2015 14:28:30 GMT -->
</html>
