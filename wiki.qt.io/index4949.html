<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from wiki.qt.io/index.php?title=Qt_Style_Sheets_and_Custom_Painting_Example&action=edit by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 05 Nov 2015 12:10:20 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>View source for Qt Style Sheets and Custom Painting Example - Qt Wiki</title>
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />
<meta name="generator" content="MediaWiki 1.23.3" />
<meta name="robots" content="noindex,nofollow" />
<link rel="shortcut icon" href="http://wiki.qt.io/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="http://wiki.qt.io/opensearch_desc.php" title="Qt Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="http://wiki.qt.io/api.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Qt Wiki Atom feed" href="http://wiki.qt.io/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="http://wiki.qt.io/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.vector.styles&amp;only=styles&amp;skin=vector&amp;*" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="http://wiki.qt.io/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: qtio_wiki:resourceloader:filter:minify-css:7:e91d7bc946738c8892a88ad5616a59ba */</style>
<script src="http://wiki.qt.io/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Qt_Style_Sheets_and_Custom_Painting_Example","wgTitle":"Qt Style Sheets and Custom Painting Example","wgCurRevisionId":16445,"wgRevisionId":0,"wgArticleId":1562,"wgIsArticle":false,"wgIsRedirect":false,"wgAction":"edit","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":true,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Qt_Style_Sheets_and_Custom_Painting_Example","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"hidesig":true,"preview":true,"previewDialog":false,"publish":true}});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"editfont":"default","editondblclick":0,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":1,"extendwatchlist":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nickname":"","norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"rcdays":7,"rclimit":50,"rows":25,"showhiddencats":0,"shownumberswatching":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":1,"watchdefault":1,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,
"useeditwarning":1,"prefershttps":1,"usebetatoolbar":1,"usebetatoolbar-cgd":1,"wikieditor-preview":1,"wikieditor-publish":1,"language":"en","variant-gan":"gan","variant-iu":"iu","variant-kk":"kk","variant-ku":"ku","variant-shi":"shi","variant-sr":"sr","variant-tg":"tg","variant-uz":"uz","variant-zh":"zh","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"searchNs500":false,"searchNs501":false,"searchNs700":false,"searchNs701":false,"variant":"en"});},{},{});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});},{},{});
/* cache key: qtio_wiki:resourceloader:filter:minify-js:7:9743cb8b8019d46de5946bfe6dfa04d7 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Qt_Style_Sheets_and_Custom_Painting_Example skin-vector action-edit vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">View source for Qt Style Sheets and Custom Painting Example</span></h1>
						<div id="bodyContent">
								<div id="contentSub">← <a href="http://wiki.qt.io/Qt_Style_Sheets_and_Custom_Painting_Example" title="Qt Style Sheets and Custom Painting Example">Qt Style Sheets and Custom Painting Example</a></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-navigation">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text"><p>You do not have permission to edit this page, for the following reason:
</p>
<div class="permissions-errors">
<p>The action you have requested is limited to users in one of the groups: <a href="http://wiki.qt.io/index.php?title=Qt_Wiki:Users&amp;action=edit&amp;redlink=1" class="new" title="Qt Wiki:Users (page does not exist)">Users</a>, KnowledgeBase, QtWS.
</p>
</div>
<hr />
<p>You can view and copy the source of this page:
</p><textarea readonly="" accesskey="," id="wpTextbox1" cols="80" rows="25" style="" lang="en" dir="ltr" name="wpTextbox1">{{Cleanup | reason=Auto-imported from ExpressionEngine.}}

[[Category:snippets]]

= Qt Style Sheets and Custom Painting Example =

== Introduction ==

This example demonstrates:
# use of qt style sheets
# use of Q_PROPERTY
# how to combine 1 and 2 with custom painting

In this example we have some custom widget that has reimplemented paintEvent function and inside, some custom painting is performed. We'll see how to set custom colors for for shapes and lines via Qt Style Sheet mechanism. Thanks to it, we can easily change the colors inside the .qss file without recompiling the program.

== Example Source code ==

'''swidget.h'''
&lt;code>
#ifndef SWIDGET_H
#define SWIDGET_H

#include &lt;QWidget>

class SWidget : public QWidget
{
 Q_OBJECT
 Q_PROPERTY(QColor lineColor READ getLineColor WRITE setLineColor DESIGNABLE true)
 Q_PROPERTY(QColor rectColor READ getRectColor WRITE setRectColor DESIGNABLE true)

public:
 explicit SWidget(QWidget *parent = 0);
 ~SWidget();

QColor getLineColor() const;
 void setLineColor( QColor c );

QColor getRectColor() const;
 void setRectColor( QColor c );

protected:
 void paintEvent( QPaintEvent *e );

private:
 QColor lineColor;
 QColor rectColor;
};

#endif // SWIDGET_H
&lt;/code>
'''swidget.cpp'''
&lt;code>
#include "swidget.h"

#include &lt;QPainter>
#include &lt;QDebug>

SWidget::SWidget(QWidget *parent) :
 QWidget(parent)
{
}

SWidget::~SWidget()
{
}

void SWidget::paintEvent( QPaintEvent *e )
{
 QPainter p(this);
 p.setPen( getLineColor() );
 p.drawLine( 0,0, size().width(), size().height() );
 p.setPen( getRectColor() );
 p.drawRect( 5,5, size().width()–10, size().height()-10 );
}

QColor SWidget::getLineColor() const
{
 return lineColor;
}

void SWidget::setLineColor( QColor c )
{
 qDebug() &lt;&lt; ''FUNCTION'';
 lineColor = c;
}

QColor SWidget::getRectColor() const
{
 return rectColor;
}

void SWidget::setRectColor( QColor c )
{
 qDebug() &lt;&lt; ''FUNCTION'';
 rectColor = c;
}
&lt;/code>
'''main.cpp'''
&lt;code>
#include &lt;QApplication>
#include "mainwindow.h"
#include "swidget.h"

int main(int argc, char *argv[])
{
 QApplication a(argc, argv);

 //create widget
 SWidget *w = new SWidget();

 //open and set style sheet
 QFile f( "sheet.qss" );
 if( f.open( QFile::ReadOnly ) )
 {
 QString ssheet = QLatin1String( f.readAll() );
 a.setStyleSheet( ssheet );
 }

 w->show();

return a.exec();
}
&lt;/code>
'''sheet.qss'''
&lt;code>
SWidget
{
 qproperty-lineColor: yellow;
 qproperty-rectColor: red;
}
&lt;/code>

== Code Walkthrough ==

We need to define our custom widget and assign new properties for further. In this case we need two custom color properties. One for line color and one for rectangle color.
&lt;code>
class SWidget : public QWidget
{
 Q_OBJECT
 Q_PROPERTY(QColor lineColor READ getLineColor WRITE setLineColor DESIGNABLE true)
 Q_PROPERTY(QColor rectColor READ getRectColor WRITE setRectColor DESIGNABLE true)
&lt;/code>

Methods required by new properties:
&lt;code>
 QColor getLineColor() const;
 void setLineColor( QColor c );

QColor getRectColor() const;
 void setRectColor( QColor c );
&lt;/code>

We'll reimplement the paintEvent
&lt;code>
protected:
 void paintEvent( QPaintEvent *e );
&lt;/code>

Private members will hold our Q_PROPERTY values
&lt;code>
private:
 QColor lineColor;
 QColor rectColor;
&lt;/code>

swidget.cpp
Paint event reimplementation. Drawing of line that goes across the widget and rectangle is performed in paintEvent for simplicty.
&lt;code>
void SWidget::paintEvent( QPaintEvent *e )
{
 QPainter p(this);
 p.setPen( getLineColor() );
 p.drawLine( 0,0, size().width(), size().height() );
 p.setPen( getRectColor() );
 p.drawRect( 5,5, size().width()–10, size().height()-10 );
}
&lt;/code>

Define the setters and getters for lineColor and rectColor properties.
NOTE: we're using qDebug() to make sure that our setters are being called in further widget restyling.
&lt;code>
QColor SWidget::getLineColor() const
{
 return lineColor;
}

void SWidget::setLineColor( QColor c )
{
 qDebug() &lt;&lt; ''FUNCTION'';
 lineColor = c;
}

QColor SWidget::getRectColor() const
{
 return rectColor;
}

void SWidget::setRectColor( QColor c )
{
 qDebug() &lt;&lt; ''FUNCTION'';
 rectColor = c;
}
&lt;/code>

Let's go into main.cpp now.
We'll create very simple gui app that will show our custom widget:
&lt;code>
int main(int argc, char *argv[])
{
 QApplication a(argc, argv);

 //create widget
 SWidget *w = new SWidget();
&lt;/code>

Open the sheet.qss file that holds qproperties for this application. If open is succeedded get data in QString '''ssheet''' and apply stylle sheet to QApplication object.
&lt;code>
 QFile f( "sheet.qss" );
 if( f.open( QFile::ReadOnly ) )
 {
 QString ssheet = QLatin1String( f.readAll() );
 a.setStyleSheet( ssheet );
 }
&lt;/code>

Show widget and enter main event loop.
&lt;code>
 w->show();

return a.exec();
}
&lt;/code>

Inside sheet.qss we're defining line and rectangle color for SWidget
&lt;code>
SWidget
{
 qproperty-lineColor: yellow;
 qproperty-rectColor: red;
}
&lt;/code>

Please note that all SWidget widget we'll be styled in the same way.

In Case that we have:
&lt;code>
SWidget *w = new SWidget();
SWidget *w2 = new SWidget();
&lt;/code>
and want custom look of each of them, we need to add names for them:
&lt;code>
w->setObjectName("w1");
w2->setObjectName("w2);
&lt;/code>

Noe, sheet.qss may look like this:
&lt;code>
SWidget#w1
{
 qproperty-lineColor: yellow;
 qproperty-rectColor: red;
}
SWidget#w2
{
 qproperty-lineColor: blue;
 qproperty-rectColor: white;
}
&lt;/code>
</textarea><div class="templatesUsed"><div class="mw-templatesUsedExplanation"><p>Templates used on this page:
</p></div><ul>
<li><a href="http://wiki.qt.io/Template:Ambox" title="Template:Ambox">Template:Ambox</a> (<a href="http://wiki.qt.io/index.php?title=Template:Ambox&amp;action=edit" title="Template:Ambox">view source</a>) </li><li><a href="http://wiki.qt.io/Template:Cleanup" title="Template:Cleanup">Template:Cleanup</a> (<a href="http://wiki.qt.io/index.php?title=Template:Cleanup&amp;action=edit" title="Template:Cleanup">view source</a>) </li></ul></div><p id="mw-returnto">Return to <a href="http://wiki.qt.io/Qt_Style_Sheets_and_Custom_Painting_Example" title="Qt Style Sheets and Custom Painting Example">Qt Style Sheets and Custom Painting Example</a>.</p>
</div>								<div class="printfooter">
				Retrieved from "<a href="http://wiki.qt.io/Qt_Style_Sheets_and_Custom_Painting_Example">http://wiki.qt.io/Qt_Style_Sheets_and_Custom_Painting_Example</a>"				</div>
												<div id='catlinks' class='catlinks catlinks-allhidden'></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
				<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
	<h3 id="p-personal-label">Personal tools</h3>
	<ul>
<li id="pt-anonuserpage"><a href="http://wiki.qt.io/User:10.0.113.70" class="new" title="The user page for the IP address you are editing as [.]" accesskey=".">10.0.113.70</a></li><li id="pt-anontalk"><a href="http://wiki.qt.io/User_talk:10.0.113.70" class="new" title="Discussion about edits from this IP address [n]" accesskey="n">Talk for this IP address</a></li><li id="pt-login"><a href="http://wiki.qt.io/index.php?title=Special:QtLogin&amp;returnto=Qt+Style+Sheets+and+Custom+Painting+Example" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Sign in</a></li>	</ul>
</div>
				<div id="left-navigation">
					<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
	<h3 id="p-namespaces-label">Namespaces</h3>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="http://wiki.qt.io/Qt_Style_Sheets_and_Custom_Painting_Example"  title="View the content page [c]" accesskey="c">Page</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="http://wiki.qt.io/index.php?title=Talk:Qt_Style_Sheets_and_Custom_Painting_Example&amp;action=edit&amp;redlink=1"  title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
			</ul>
</div>
<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
	<h3 id="mw-vector-current-variant">
		</h3>
	<h3 id="p-variants-label"><span>Variants</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
				</div>
				<div id="right-navigation">
					<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
	<h3 id="p-views-label">Views</h3>
	<ul>
					<li id="ca-view"><span><a href="http://wiki.qt.io/Qt_Style_Sheets_and_Custom_Painting_Example" >Read</a></span></li>
					<li id="ca-viewsource" class="selected"><span><a href="http://wiki.qt.io/index.php?title=Qt_Style_Sheets_and_Custom_Painting_Example&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
					<li id="ca-history" class="collapsible"><span><a href="http://wiki.qt.io/index.php?title=Qt_Style_Sheets_and_Custom_Painting_Example&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
			</ul>
</div>
<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
	<h3 id="p-cactions-label"><span>Actions</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
<div id="p-search" role="search">
	<h3><label for="searchInput">Search</label></h3>
	<form action="http://wiki.qt.io/index.php" id="searchform">
					<div id="simpleSearch">
					<input type="search" name="search" placeholder="Search" title="Search Qt Wiki [f]" accesskey="f" id="searchInput" /><input type="hidden" value="Special:Search" name="title" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton" />		</div>
	</form>
</div>
				</div>
			</div>
			<div id="mw-panel">
					<div id="p-logo" role="banner"><a style="background-image: url(http://wiki.qt.io/skins/common/images/wiki.png);" href="http://wiki.qt.io/Main_Page"  title="Visit the main page"></a></div>
				<div class="portal" role="navigation" id='p-navigation' aria-labelledby='p-navigation-label'>
	<h3 id='p-navigation-label'>Navigation</h3>
	<div class="body">
		<ul>
			<li id="n-mainpage-description"><a href="http://wiki.qt.io/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
			<li id="n-recentchanges"><a href="http://wiki.qt.io/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
			<li id="n-randompage"><a href="http://wiki.qt.io/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
			<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
	<h3 id='p-tb-label'>Tools</h3>
	<div class="body">
		<ul>
			<li id="t-whatlinkshere"><a href="http://wiki.qt.io/Special:WhatLinksHere/Qt_Style_Sheets_and_Custom_Painting_Example" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
			<li id="t-recentchangeslinked"><a href="http://wiki.qt.io/Special:RecentChangesLinked/Qt_Style_Sheets_and_Custom_Painting_Example" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
			<li id="t-specialpages"><a href="http://wiki.qt.io/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
			<li id="t-info"><a href="http://wiki.qt.io/index.php?title=Qt_Style_Sheets_and_Custom_Painting_Example&amp;action=info">Page information</a></li>
		</ul>
	</div>
</div>
			</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-places">
											<li id="footer-places-terms"><a href='https://developer.qtcloudservices.com/legal/terms'>Käyttöehdot</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
					<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="http://wiki.qt.io/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<script>/*<![CDATA[*/window.jQuery && jQuery.ready();/*]]>*/</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.edit.collapsibleFooter","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","skins.vector.collapsibleNav"],null,true);
}</script>
<script src="http://wiki.qt.io/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54043535-2', 'auto');
  ga('send', 'pageview');

</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":593});
}</script>
	</body>

<!-- Mirrored from wiki.qt.io/index.php?title=Qt_Style_Sheets_and_Custom_Painting_Example&action=edit by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 05 Nov 2015 12:10:20 GMT -->
</html>
