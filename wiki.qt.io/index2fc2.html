<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from wiki.qt.io/index.php?title=How_to_create_a_multi_language_application&oldid=19747 by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 05 Nov 2015 11:15:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>How to create a multi language application - Qt Wiki</title>
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />
<meta name="generator" content="MediaWiki 1.23.3" />
<meta name="robots" content="noindex,nofollow" />
<link rel="shortcut icon" href="http://wiki.qt.io/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="http://wiki.qt.io/opensearch_desc.php" title="Qt Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="http://wiki.qt.io/api.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Qt Wiki Atom feed" href="http://wiki.qt.io/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="http://wiki.qt.io/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.vector.styles&amp;only=styles&amp;skin=vector&amp;*" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="http://wiki.qt.io/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: qtio_wiki:resourceloader:filter:minify-css:7:e91d7bc946738c8892a88ad5616a59ba */</style>
<script src="http://wiki.qt.io/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"How_to_create_a_multi_language_application","wgTitle":"How to create a multi language application","wgCurRevisionId":19747,"wgRevisionId":19747,"wgArticleId":934,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["HowTo"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"How_to_create_a_multi_language_application","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"hidesig":true,"preview":true,"previewDialog":false,"publish":true}});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"editfont":"default","editondblclick":0,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":1,"extendwatchlist":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nickname":"","norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"rcdays":7,"rclimit":50,"rows":25,"showhiddencats":0,"shownumberswatching":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":1,"watchdefault":1,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,
"useeditwarning":1,"prefershttps":1,"usebetatoolbar":1,"usebetatoolbar-cgd":1,"wikieditor-preview":1,"wikieditor-publish":1,"language":"en","variant-gan":"gan","variant-iu":"iu","variant-kk":"kk","variant-ku":"ku","variant-shi":"shi","variant-sr":"sr","variant-tg":"tg","variant-uz":"uz","variant-zh":"zh","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"searchNs500":false,"searchNs501":false,"searchNs700":false,"searchNs701":false,"variant":"en"});},{},{});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});},{},{});
/* cache key: qtio_wiki:resourceloader:filter:minify-js:7:9743cb8b8019d46de5946bfe6dfa04d7 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<style type="text/css">/*<![CDATA[*/
.source-cpp-qt {line-height: normal;}
.source-cpp-qt li, .source-cpp-qt pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for cpp-qt
 * CSS class: source-cpp-qt, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.cpp-qt.source-cpp-qt .de1, .cpp-qt.source-cpp-qt .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.cpp-qt.source-cpp-qt  {font-family:monospace;}
.cpp-qt.source-cpp-qt .imp {font-weight: bold; color: red;}
.cpp-qt.source-cpp-qt li, .cpp-qt.source-cpp-qt .li1 {font-weight: normal; vertical-align:top;}
.cpp-qt.source-cpp-qt .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.cpp-qt.source-cpp-qt .li2 {font-weight: bold; vertical-align:top;}
.cpp-qt.source-cpp-qt .kw1 {color: #000000; font-weight:bold;}
.cpp-qt.source-cpp-qt .kw2 {color: #0057AE;}
.cpp-qt.source-cpp-qt .kw3 {color: #2B74C7;}
.cpp-qt.source-cpp-qt .kw4 {color: #0057AE;}
.cpp-qt.source-cpp-qt .kw5 {color: #22aadd;}
.cpp-qt.source-cpp-qt .co1 {color: #888888;}
.cpp-qt.source-cpp-qt .co2 {color: #006E28;}
.cpp-qt.source-cpp-qt .coMULTI {color: #888888; font-style: italic;}
.cpp-qt.source-cpp-qt .es0 {color: #000099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es1 {color: #000099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es2 {color: #660099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es3 {color: #660099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es4 {color: #660099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es5 {color: #006699; font-weight: bold;}
.cpp-qt.source-cpp-qt .br0 {color: #006E28;}
.cpp-qt.source-cpp-qt .sy0 {color: #006E28;}
.cpp-qt.source-cpp-qt .st0 {color: #BF0303;}
.cpp-qt.source-cpp-qt .nu0 {color: #B08000;}
.cpp-qt.source-cpp-qt .nu6 {color: #208080;}
.cpp-qt.source-cpp-qt .nu8 {color: #208080;}
.cpp-qt.source-cpp-qt .nu12 {color: #208080;}
.cpp-qt.source-cpp-qt .nu16 {color:#800080;}
.cpp-qt.source-cpp-qt .nu17 {color:#800080;}
.cpp-qt.source-cpp-qt .nu18 {color:#800080;}
.cpp-qt.source-cpp-qt .nu19 {color:#800080;}
.cpp-qt.source-cpp-qt .me1 {color: #2B74C7;}
.cpp-qt.source-cpp-qt .me2 {color: #2B74C7;}
.cpp-qt.source-cpp-qt .me3 {color: #2B74C7;}
.cpp-qt.source-cpp-qt .ln-xtra, .cpp-qt.source-cpp-qt li.ln-xtra, .cpp-qt.source-cpp-qt div.ln-xtra {background-color: #ffc;}
.cpp-qt.source-cpp-qt span.xtra { display:block; }

/*]]>*/
</style><!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-How_to_create_a_multi_language_application skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">How to create a multi language application</span></h1>
						<div id="bodyContent">
								<div id="siteSub">From Qt Wiki</div>
								<div id="contentSub"><div id="mw-revision-info">Revision as of 09:34, 23 October 2015 by <a href="http://wiki.qt.io/User:Waldyrious" title="User:Waldyrious" class="mw-userlink">Waldyrious</a>  <span class="mw-usertoollinks">(<a href="http://wiki.qt.io/index.php?title=User_talk:Waldyrious&amp;action=edit&amp;redlink=1" class="new" title="User talk:Waldyrious (page does not exist)">Talk</a> | <a href="http://wiki.qt.io/Special:Contributions/Waldyrious" title="Special:Contributions/Waldyrious">contribs</a>)</span></div><br />
				<div id="mw-revision-nav">(<a href="http://wiki.qt.io/index.php?title=How_to_create_a_multi_language_application&amp;diff=prev&amp;oldid=19747" title="How to create a multi language application">diff</a>) <a href="http://wiki.qt.io/index.php?title=How_to_create_a_multi_language_application&amp;direction=prev&amp;oldid=19747" title="How to create a multi language application">← Older revision</a> | Latest revision (diff) | Newer revision → (diff)</div></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-navigation">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div style="background:#eeeeee;padding:2px;">
<p><strong class="selflink">En</strong>
<span style="color:#ccc;">Ar</span>
<span style="color:#ccc;">Bg</span>
<a href="http://wiki.qt.io/How_to_create_a_multi_language_application/de" title="How to create a multi language application/de">De</a>
<a href="http://wiki.qt.io/How_to_create_a_multi_language_application/el" title="How to create a multi language application/el">El</a>
<span style="color:#ccc;">Es</span>
<span style="color:#ccc;">Fa</span>
<span style="color:#ccc;">Fi</span>
<span style="color:#ccc;">Fr</span>
<span style="color:#ccc;">Hi</span>
<span style="color:#ccc;">Hu</span>
<span style="color:#ccc;">It</span>
<span style="color:#ccc;">Ja</span>
<span style="color:#ccc;">Kn</span>
<span style="color:#ccc;">Ko</span>
<span style="color:#ccc;">Ms</span>
<span style="color:#ccc;">Nl</span>
<span style="color:#ccc;">Pl</span>
<span style="color:#ccc;">Pt</span>
<span style="color:#ccc;">Ru</span>
<span style="color:#ccc;">Th</span>
<span style="color:#ccc;">Tr</span>
<span style="color:#ccc;">Uk</span>
<span style="color:#ccc;">Zh</span>
</p>
</div>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Create_a_standard_application.2C_e.g._with_a_main_window"><span class="tocnumber">1</span> <span class="toctext">Create a standard application, e.g. with a main window</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#File_system_structure_of_the_application:"><span class="tocnumber">2</span> <span class="toctext">File system structure of the application:</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Class_definition"><span class="tocnumber">3</span> <span class="toctext">Class definition</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Creation_of_the_language_menus"><span class="tocnumber">4</span> <span class="toctext">Creation of the language menus</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Switching_the_language"><span class="tocnumber">5</span> <span class="toctext">Switching the language</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Add_translations_to_the_project"><span class="tocnumber">6</span> <span class="toctext">Add translations to the project</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Create_a_standard_application.2C_e.g._with_a_main_window">Create a standard application, e.g. with a main window</span></h2>
<p><a href="http://wiki.qt.io/File:LanguageApp.png" class="image"><img alt="LanguageApp.png" src="http://wiki.qt.io/images/c/c7/LanguageApp.png" width="330" height="145" /></a>
</p><p>In this example, we create a main window with a menu Language and some widgets. If the user opened the language menu, there is a selection of languages, which is created on startup of the application, dependent on the existing language files.
</p><p><a href="http://wiki.qt.io/File:LanguageAppMenu.png" class="image"><img alt="LanguageAppMenu.png" src="http://wiki.qt.io/images/7/7b/LanguageAppMenu.png" width="330" height="146" /></a>
</p>
<h2><span class="mw-headline" id="File_system_structure_of_the_application:">File system structure of the application:</span></h2>
<ul>
<li> Application directory
<ul>
<li> binaries
</li>
</ul>
</li>
<li> Application directory/languages
<ul>
<li> For each installed language, there is an (optional) image of the size 16x16 pixel with a flag (e.g. de.png)
</li>
<li> The translated text files of the application (TranslationExample_*.qm, where * could be de, en, etc.)
</li>
<li> the translation files of Qt (qt_*.qm)
</li>
</ul>
</li>
</ul>
<h2><span class="mw-headline" id="Class_definition">Class definition</span></h2>
<p>In the class MainWindow, the virtual method <span class="plainlinks"><a rel="nofollow" class="external text" href="http://doc.qt.io/qt-5/qwidget.html#changeEvent">changeEvent(QEvent*)</a></span> is overwritten. For each translation file, that is needed, a <span class="plainlinks"><a rel="nofollow" class="external text" href="http://doc.qt.io/qt-5/qtranslator.html#">QTranslator</a></span> instance is created (in our example 2, on for the application texts, one for qt). The current language is stored to suppress events, if the user tries to load the same language twice.
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="kw2">class</span> MainWindow <span class="sy0">:</span> <span class="kw2">public</span> <span class="kw5">QMainWindow</span>
<span class="br0">&#123;</span>
 <span class="kw2">protected</span><span class="sy0">:</span>
  <span class="co1">// this event is called, when a new translator is loaded or the system language is changed</span>
  <span class="kw4">void</span> changeEvent<span class="br0">&#40;</span><span class="kw5">QEvent</span><span class="sy0">*</span><span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="kw2">protected</span> <span class="kw2">slots</span><span class="sy0">:</span>
  <span class="co1">// this slot is called by the language menu actions</span>
  <span class="kw4">void</span> slotLanguageChanged<span class="br0">&#40;</span><span class="kw5">QAction</span><span class="sy0">*</span> action<span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="kw2">private</span><span class="sy0">:</span>
  <span class="co1">// loads a language by the given language shortcur (e.g. de, en)</span>
  <span class="kw4">void</span> loadLanguage<span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> rLanguage<span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
  <span class="co1">// creates the language menu dynamically from the content of m_langPath</span>
  <span class="kw4">void</span> createLanguageMenu<span class="br0">&#40;</span><span class="kw4">void</span><span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
  Ui<span class="sy0">::</span><span class="me2">MainWindow</span> ui<span class="sy0">;</span> <span class="co1">// ui definition from designer</span>
  <span class="kw5">QTranslator</span> m_translator<span class="sy0">;</span> <span class="co1">// contains the translations for this application</span>
  <span class="kw5">QTranslator</span> m_translatorQt<span class="sy0">;</span> <span class="co1">// contains the translations for qt</span>
  <span class="kw5">QString</span> m_currLang<span class="sy0">;</span> <span class="co1">// contains the currently loaded language</span>
  <span class="kw5">QString</span> m_langPath<span class="sy0">;</span> <span class="co1">// Path of language files. This is always fixed to /languages.</span>
<span class="br0">&#125;</span><span class="sy0">;</span></pre></div></div>
<h2><span class="mw-headline" id="Creation_of_the_language_menus">Creation of the language menus</span></h2>
<p>The language menu is created dynamically during application start, depending on the existing translation files. The advantage of this solution is, you can deliver any translation later on, and it will just work after application restart. In this example, all text files are located in the sub folder "languages". It is possible to place some icons there (language.png) which is used as icon in the menu (e.g. a flag).
</p><p>Each language is represented by a <span class="plainlinks"><a rel="nofollow" class="external text" href="http://doc.qt.io/qt-5/qaction.html#">QAction</a></span> object which is added to a <span class="plainlinks"><a rel="nofollow" class="external text" href="http://doc.qt.io/qt-5/qactiongroup.html#">QActionGroup</a></span>. This is done to achieve, that only one slot is needed for all languages:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="kw2">connect</span><span class="br0">&#40;</span>langGroup<span class="sy0">,</span> SIGNAL <span class="br0">&#40;</span>triggered<span class="br0">&#40;</span><span class="kw5">QAction</span> <span class="sy0">*</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw1">this</span><span class="sy0">,</span> SLOT <span class="br0">&#40;</span>slotLanguageChanged<span class="br0">&#40;</span><span class="kw5">QAction</span> <span class="sy0">*</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre></div></div>
<p>The language menu is created as following:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="co1">// we create the menu entries dynamically, dependent on the existing translations.</span>
<span class="kw4">void</span> MainWindow<span class="sy0">::</span><span class="me2">createLanguageMenu</span><span class="br0">&#40;</span><span class="kw4">void</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
 <span class="kw5">QActionGroup</span><span class="sy0">*</span> langGroup <span class="sy0">=</span> <span class="kw1">new</span> <span class="kw5">QActionGroup</span><span class="br0">&#40;</span>ui.<span class="me1">menuLanguage</span><span class="br0">&#41;</span><span class="sy0">;</span>
 langGroup<span class="sy0">-&gt;</span><span class="me3">setExclusive</span><span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="kw2">connect</span><span class="br0">&#40;</span>langGroup<span class="sy0">,</span> SIGNAL <span class="br0">&#40;</span>triggered<span class="br0">&#40;</span><span class="kw5">QAction</span> <span class="sy0">*</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw1">this</span><span class="sy0">,</span> SLOT <span class="br0">&#40;</span>slotLanguageChanged<span class="br0">&#40;</span><span class="kw5">QAction</span> <span class="sy0">*</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="co1">// format systems language</span>
 <span class="kw5">QString</span> defaultLocale <span class="sy0">=</span> <span class="kw5">QLocale</span><span class="sy0">::</span><span class="kw3">system</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">name</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="co1">// e.g. &quot;de_DE&quot;</span>
 defaultLocale.<span class="me1">truncate</span><span class="br0">&#40;</span>defaultLocale.<span class="me1">lastIndexOf</span><span class="br0">&#40;</span><span class="st0">'_'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="co1">// e.g. &quot;de&quot;</span>
&#160;
 m_langPath <span class="sy0">=</span> <span class="kw5">QApplication</span><span class="sy0">::</span><span class="me2">applicationDirPath</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
 m_langPath.<span class="me1">append</span><span class="br0">&#40;</span><span class="st0">&quot;/languages&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
 <span class="kw5">QDir</span> dir<span class="br0">&#40;</span>m_langPath<span class="br0">&#41;</span><span class="sy0">;</span>
 <span class="kw5">QStringList</span> fileNames <span class="sy0">=</span> dir.<span class="me1">entryList</span><span class="br0">&#40;</span><span class="kw5">QStringList</span><span class="br0">&#40;</span><span class="st0">&quot;TranslationExample_*.qm&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int</span> i <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> fileNames.<span class="me1">size</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="sy0">++</span>i<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="co1">// get locale extracted by filename</span>
  <span class="kw5">QString</span> locale<span class="sy0">;</span>
  locale <span class="sy0">=</span> fileNames<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">;</span> <span class="co1">// &quot;TranslationExample_de.qm&quot;</span>
  locale.<span class="me1">truncate</span><span class="br0">&#40;</span>locale.<span class="me1">lastIndexOf</span><span class="br0">&#40;</span><span class="st0">'.'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="co1">// &quot;TranslationExample_de&quot;</span>
  locale.<span class="kw3">remove</span><span class="br0">&#40;</span><span class="nu0">0</span><span class="sy0">,</span> locale.<span class="me1">indexOf</span><span class="br0">&#40;</span><span class="st0">'_'</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="co1">// &quot;de&quot;</span>
&#160;
 <span class="kw5">QString</span> lang <span class="sy0">=</span> <span class="kw5">QLocale</span><span class="sy0">::</span><span class="me2">languageToString</span><span class="br0">&#40;</span><span class="kw5">QLocale</span><span class="br0">&#40;</span>locale<span class="br0">&#41;</span>.<span class="me1">language</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
 <span class="kw5">QIcon</span> ico<span class="br0">&#40;</span><span class="kw5">QString</span><span class="br0">&#40;</span><span class="st0">&quot;%1/%2.png&quot;</span><span class="br0">&#41;</span>.<span class="me1">arg</span><span class="br0">&#40;</span>m_langPath<span class="br0">&#41;</span>.<span class="me1">arg</span><span class="br0">&#40;</span>locale<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="kw5">QAction</span> <span class="sy0">*</span>action <span class="sy0">=</span> <span class="kw1">new</span> <span class="kw5">QAction</span><span class="br0">&#40;</span>ico<span class="sy0">,</span> lang<span class="sy0">,</span> <span class="kw1">this</span><span class="br0">&#41;</span><span class="sy0">;</span>
 action<span class="sy0">-&gt;</span><span class="me3">setCheckable</span><span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span><span class="sy0">;</span>
 action<span class="sy0">-&gt;</span><span class="me3">setData</span><span class="br0">&#40;</span>locale<span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 ui.<span class="me1">menuLanguage</span><span class="sy0">-&gt;</span><span class="me3">addAction</span><span class="br0">&#40;</span>action<span class="br0">&#41;</span><span class="sy0">;</span>
 langGroup<span class="sy0">-&gt;</span><span class="me3">addAction</span><span class="br0">&#40;</span>action<span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="co1">// set default translators and language checked</span>
 <span class="kw1">if</span> <span class="br0">&#40;</span>defaultLocale <span class="sy0">==</span> locale<span class="br0">&#41;</span>
 <span class="br0">&#123;</span>
 action<span class="sy0">-&gt;</span><span class="me3">setChecked</span><span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span><span class="sy0">;</span>
 <span class="br0">&#125;</span>
 <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></div></div>
<h2><span class="mw-headline" id="Switching_the_language">Switching the language</span></h2>
<p>If the language should be switched, the needed target language is extracted from the <span class="plainlinks"><a rel="nofollow" class="external text" href="http://doc.qt.io/qt-5/qaction.html#">QAction</a></span> object and the existing translators are removed <span class="plainlinks"><a rel="nofollow" class="external text" href="http://doc.qt.io/qt-5/qapplication.html#removeTranslator">QApplication::removeTranslator()</a></span>. After that, the new language files are loaded, and if successful, the translator is installed again <span class="plainlinks"><a rel="nofollow" class="external text" href="http://doc.qt.io/qt-5/qapplication.html#installTranslator">QApplication::installTranslator()</a></span>. This is done to ensure, a <span class="plainlinks"><a rel="nofollow" class="external text" href="http://doc.qt.io/qt-5/qevent.html#">QEvent</a></span>::LanguageChange is emitted by the application object. If the application only contains one top level window, that is completely created by designer, it is also possible to just read the new translation files and call <tt>ui.retranslateUi(this)</tt> directly.
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="co1">// Called every time, when a menu entry of the language menu is called</span>
<span class="kw4">void</span> MainWindow<span class="sy0">::</span><span class="me2">slotLanguageChanged</span><span class="br0">&#40;</span><span class="kw5">QAction</span><span class="sy0">*</span> action<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
 <span class="kw1">if</span><span class="br0">&#40;</span><span class="nu0">0</span> <span class="sy0">!=</span> action<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="co1">// load the language dependant on the action content</span>
  loadLanguage<span class="br0">&#40;</span>action<span class="sy0">-&gt;</span><span class="me3">data</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">toString</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  setWindowIcon<span class="br0">&#40;</span>action<span class="sy0">-&gt;</span><span class="me3">icon</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
 <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&#160;
<span class="kw4">void</span> switchTranslator<span class="br0">&#40;</span><span class="kw5">QTranslator</span><span class="sy0">&amp;</span> translator<span class="sy0">,</span> <span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> filename<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
 <span class="co1">// remove the old translator</span>
 qApp<span class="sy0">-&gt;</span><span class="me3">removeTranslator</span><span class="br0">&#40;</span><span class="sy0">&amp;</span>translator<span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="co1">// load the new translator</span>
 <span class="kw1">if</span><span class="br0">&#40;</span>translator.<span class="me1">load</span><span class="br0">&#40;</span>filename<span class="br0">&#41;</span><span class="br0">&#41;</span>
  qApp<span class="sy0">-&gt;</span><span class="me3">installTranslator</span><span class="br0">&#40;</span><span class="sy0">&amp;</span>translator<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
&#160;
<span class="kw4">void</span> MainWindow<span class="sy0">::</span><span class="me2">loadLanguage</span><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> rLanguage<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
 <span class="kw1">if</span><span class="br0">&#40;</span>m_currLang <span class="sy0">!=</span> rLanguage<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  m_currLang <span class="sy0">=</span> rLanguage<span class="sy0">;</span>
  <span class="kw5">QLocale</span> locale <span class="sy0">=</span> <span class="kw5">QLocale</span><span class="br0">&#40;</span>m_currLang<span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="kw5">QLocale</span><span class="sy0">::</span><span class="me2">setDefault</span><span class="br0">&#40;</span>locale<span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="kw5">QString</span> languageName <span class="sy0">=</span> <span class="kw5">QLocale</span><span class="sy0">::</span><span class="me2">languageToString</span><span class="br0">&#40;</span>locale.<span class="me1">language</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  switchTranslator<span class="br0">&#40;</span>m_translator<span class="sy0">,</span> <span class="kw5">QString</span><span class="br0">&#40;</span><span class="st0">&quot;TranslationExample_%1.qm&quot;</span><span class="br0">&#41;</span>.<span class="me1">arg</span><span class="br0">&#40;</span>rLanguage<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  switchTranslator<span class="br0">&#40;</span>m_translatorQt<span class="sy0">,</span> <span class="kw5">QString</span><span class="br0">&#40;</span><span class="st0">&quot;qt_%1.qm&quot;</span><span class="br0">&#41;</span>.<span class="me1">arg</span><span class="br0">&#40;</span>rLanguage<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  ui.<span class="me1">statusBar</span><span class="sy0">-&gt;</span><span class="me3">showMessage</span><span class="br0">&#40;</span>tr<span class="br0">&#40;</span><span class="st0">&quot;Current Language changed to&#160;%1&quot;</span><span class="br0">&#41;</span>.<span class="me1">arg</span><span class="br0">&#40;</span>languageName<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
 <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></div></div>
<ul>
<li> <tt>QEvent::LanguageChange</tt> will always be called, if a translator object is installed in the application object
</li>
<li> <tt>QEvent::LocaleChange</tt> is called, when the system language is switched
</li>
</ul>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="kw4">void</span> MainWindow<span class="sy0">::</span><span class="me2">changeEvent</span><span class="br0">&#40;</span><span class="kw5">QEvent</span><span class="sy0">*</span> event<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
 <span class="kw1">if</span><span class="br0">&#40;</span><span class="nu0">0</span> <span class="sy0">!=</span> event<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw1">switch</span><span class="br0">&#40;</span>event<span class="sy0">-&gt;</span><span class="me3">type</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
   <span class="co1">// this event is send if a translator is loaded</span>
   <span class="kw1">case</span> <span class="kw5">QEvent</span><span class="sy0">::</span><span class="me2">LanguageChange</span><span class="sy0">:</span>
    ui.<span class="me1">retranslateUi</span><span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span><span class="sy0">;</span>
    break<span class="sy0">;</span>
&#160;
   <span class="co1">// this event is send, if the system, language changes</span>
   <span class="kw1">case</span> <span class="kw5">QEvent</span><span class="sy0">::</span><span class="me2">LocaleChange</span><span class="sy0">:</span>
   <span class="br0">&#123;</span>
    <span class="kw5">QString</span> locale <span class="sy0">=</span> <span class="kw5">QLocale</span><span class="sy0">::</span><span class="kw3">system</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">name</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    locale.<span class="me1">truncate</span><span class="br0">&#40;</span>locale.<span class="me1">lastIndexOf</span><span class="br0">&#40;</span><span class="st0">'_'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span> 
    loadLanguage<span class="br0">&#40;</span>locale<span class="br0">&#41;</span><span class="sy0">;</span>
   <span class="br0">&#125;</span>
   break<span class="sy0">;</span>
  <span class="br0">&#125;</span>
 <span class="br0">&#125;</span>
 <span class="kw5">QMainWindow</span><span class="sy0">::</span><span class="me2">changeEvent</span><span class="br0">&#40;</span>event<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre></div></div>
<h2><span class="mw-headline" id="Add_translations_to_the_project">Add translations to the project</span></h2>
<p>In your qmake project file, the following variable <a rel="nofollow" class="external text" href="http://doc.qt.io/qt-5/qmake-variable-reference.html#translations">TRANSLATIONS</a> has to be added and must contain all language files you want to create initially.
</p>
<pre>TRANSLATIONS = languages/TranslationExample_en.ts  languages/TranslationExample_de.ts
</pre>
<p><br />
By calling <tt><a rel="nofollow" class="external text" href="http://doc.qt.io/qt-5/linguist-manager.html#using-lupdate">lupdate</a></tt>
</p>
<pre>lupdate -verbose TranslationExample.pro
</pre>
<p>You create the language files (.ts), which you translate by using the tool <i>Qt Linguist</i>.
</p>
<pre>linguist languages/TranslationExample_en.ts languages/TranslationExample_de.ts
</pre>
<p>After doing this, you call <tt><a rel="nofollow" class="external text" href="http://doc.qt.io/qt-5/linguist-manager.html#using-lrelease">lrelease</a></tt>
to create the binary language files (.qm):
</p>
<pre>lrelease TranslationExample.pro
</pre>
<!-- 
NewPP limit report
CPU time usage: 0.142 seconds
Real time usage: 0.738 seconds
Preprocessor visited node count: 261/1000000
Preprocessor generated node count: 982/1000000
Post‐expand include size: 3719/2097152 bytes
Template argument size: 246/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 23/100
-->

<!-- Saved in parser cache with key qtio_wiki:pcache:idhash:934-0!*!0!!en!2!* and timestamp 20151104113548 and revision id 19747
 -->
</div>								<div class="printfooter">
				Retrieved from "<a href="http://wiki.qt.io/index.php?title=How_to_create_a_multi_language_application&amp;oldid=19747">http://wiki.qt.io/index.php?title=How_to_create_a_multi_language_application&amp;oldid=19747</a>"				</div>
												<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="http://wiki.qt.io/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="http://wiki.qt.io/Category:HowTo" title="Category:HowTo">HowTo</a></li></ul></div></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
				<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
	<h3 id="p-personal-label">Personal tools</h3>
	<ul>
<li id="pt-anonuserpage"><a href="http://wiki.qt.io/User:10.0.113.70" class="new" title="The user page for the IP address you are editing as [.]" accesskey=".">10.0.113.70</a></li><li id="pt-anontalk"><a href="http://wiki.qt.io/User_talk:10.0.113.70" class="new" title="Discussion about edits from this IP address [n]" accesskey="n">Talk for this IP address</a></li><li id="pt-login"><a href="http://wiki.qt.io/index.php?title=Special:QtLogin&amp;returnto=How+to+create+a+multi+language+application" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Sign in</a></li>	</ul>
</div>
				<div id="left-navigation">
					<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
	<h3 id="p-namespaces-label">Namespaces</h3>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="http://wiki.qt.io/How_to_create_a_multi_language_application"  title="View the content page [c]" accesskey="c">Page</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="http://wiki.qt.io/index.php?title=Talk:How_to_create_a_multi_language_application&amp;action=edit&amp;redlink=1"  title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
			</ul>
</div>
<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
	<h3 id="mw-vector-current-variant">
		</h3>
	<h3 id="p-variants-label"><span>Variants</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
				</div>
				<div id="right-navigation">
					<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
	<h3 id="p-views-label">Views</h3>
	<ul>
					<li id="ca-view" class="selected"><span><a href="http://wiki.qt.io/How_to_create_a_multi_language_application" >Read</a></span></li>
					<li id="ca-viewsource"><span><a href="http://wiki.qt.io/index.php?title=How_to_create_a_multi_language_application&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
					<li id="ca-history" class="collapsible"><span><a href="http://wiki.qt.io/index.php?title=How_to_create_a_multi_language_application&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
			</ul>
</div>
<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
	<h3 id="p-cactions-label"><span>Actions</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
<div id="p-search" role="search">
	<h3><label for="searchInput">Search</label></h3>
	<form action="http://wiki.qt.io/index.php" id="searchform">
					<div id="simpleSearch">
					<input type="search" name="search" placeholder="Search" title="Search Qt Wiki [f]" accesskey="f" id="searchInput" /><input type="hidden" value="Special:Search" name="title" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton" />		</div>
	</form>
</div>
				</div>
			</div>
			<div id="mw-panel">
					<div id="p-logo" role="banner"><a style="background-image: url(http://wiki.qt.io/skins/common/images/wiki.png);" href="http://wiki.qt.io/Main_Page"  title="Visit the main page"></a></div>
				<div class="portal" role="navigation" id='p-navigation' aria-labelledby='p-navigation-label'>
	<h3 id='p-navigation-label'>Navigation</h3>
	<div class="body">
		<ul>
			<li id="n-mainpage-description"><a href="http://wiki.qt.io/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
			<li id="n-recentchanges"><a href="http://wiki.qt.io/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
			<li id="n-randompage"><a href="http://wiki.qt.io/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
			<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
	<h3 id='p-tb-label'>Tools</h3>
	<div class="body">
		<ul>
			<li id="t-whatlinkshere"><a href="http://wiki.qt.io/Special:WhatLinksHere/How_to_create_a_multi_language_application" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
			<li id="t-recentchangeslinked"><a href="http://wiki.qt.io/Special:RecentChangesLinked/How_to_create_a_multi_language_application" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
			<li id="t-specialpages"><a href="http://wiki.qt.io/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
			<li id="t-print"><a href="http://wiki.qt.io/index.php?title=How_to_create_a_multi_language_application&amp;oldid=19747&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
			<li id="t-permalink"><a href="http://wiki.qt.io/index.php?title=How_to_create_a_multi_language_application&amp;oldid=19747" title="Permanent link to this revision of the page">Permanent link</a></li>
			<li id="t-info"><a href="http://wiki.qt.io/index.php?title=How_to_create_a_multi_language_application&amp;action=info">Page information</a></li>
		</ul>
	</div>
</div>
			</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 23 October 2015, at 09:34.</li>
											<li id="footer-info-viewcount">This page has been accessed 6,925 times.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-terms"><a href='https://developer.qtcloudservices.com/legal/terms'>Käyttöehdot</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
					<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="http://wiki.qt.io/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<script>/*<![CDATA[*/window.jQuery && jQuery.ready();/*]]>*/</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","skins.vector.collapsibleNav"],null,true);
}</script>
<script src="http://wiki.qt.io/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54043535-2', 'auto');
  ga('send', 'pageview');

</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":230});
}</script>
	</body>

<!-- Mirrored from wiki.qt.io/index.php?title=How_to_create_a_multi_language_application&oldid=19747 by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 05 Nov 2015 11:15:57 GMT -->
</html>
