<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from wiki.qt.io/index.php?title=Olimex_Qt_Environnement/fr&oldid=18638 by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 05 Nov 2015 13:46:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>Olimex Qt Environnement/fr - Qt Wiki</title>
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />
<meta name="generator" content="MediaWiki 1.23.3" />
<meta name="robots" content="noindex,nofollow" />
<link rel="shortcut icon" href="http://wiki.qt.io/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="http://wiki.qt.io/opensearch_desc.php" title="Qt Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="http://wiki.qt.io/api.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Qt Wiki Atom feed" href="http://wiki.qt.io/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="http://wiki.qt.io/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.vector.styles&amp;only=styles&amp;skin=vector&amp;*" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="http://wiki.qt.io/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: qtio_wiki:resourceloader:filter:minify-css:7:e91d7bc946738c8892a88ad5616a59ba */</style>
<script src="http://wiki.qt.io/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Olimex_Qt_Environnement/fr","wgTitle":"Olimex Qt Environnement/fr","wgCurRevisionId":18638,"wgRevisionId":18638,"wgArticleId":2966,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Articles needing cleanup"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Olimex_Qt_Environnement/fr","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"hidesig":true,"preview":true,"previewDialog":false,"publish":true}});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"editfont":"default","editondblclick":0,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":1,"extendwatchlist":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nickname":"","norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"rcdays":7,"rclimit":50,"rows":25,"showhiddencats":0,"shownumberswatching":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":1,"watchdefault":1,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,
"useeditwarning":1,"prefershttps":1,"usebetatoolbar":1,"usebetatoolbar-cgd":1,"wikieditor-preview":1,"wikieditor-publish":1,"language":"en","variant-gan":"gan","variant-iu":"iu","variant-kk":"kk","variant-ku":"ku","variant-shi":"shi","variant-sr":"sr","variant-tg":"tg","variant-uz":"uz","variant-zh":"zh","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"searchNs500":false,"searchNs501":false,"searchNs700":false,"searchNs701":false,"variant":"en"});},{},{});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});},{},{});
/* cache key: qtio_wiki:resourceloader:filter:minify-js:7:9743cb8b8019d46de5946bfe6dfa04d7 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<style type="text/css">/*<![CDATA[*/
.source-cpp-qt {line-height: normal;}
.source-cpp-qt li, .source-cpp-qt pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for cpp-qt
 * CSS class: source-cpp-qt, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.cpp-qt.source-cpp-qt .de1, .cpp-qt.source-cpp-qt .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.cpp-qt.source-cpp-qt  {font-family:monospace;}
.cpp-qt.source-cpp-qt .imp {font-weight: bold; color: red;}
.cpp-qt.source-cpp-qt li, .cpp-qt.source-cpp-qt .li1 {font-weight: normal; vertical-align:top;}
.cpp-qt.source-cpp-qt .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.cpp-qt.source-cpp-qt .li2 {font-weight: bold; vertical-align:top;}
.cpp-qt.source-cpp-qt .kw1 {color: #000000; font-weight:bold;}
.cpp-qt.source-cpp-qt .kw2 {color: #0057AE;}
.cpp-qt.source-cpp-qt .kw3 {color: #2B74C7;}
.cpp-qt.source-cpp-qt .kw4 {color: #0057AE;}
.cpp-qt.source-cpp-qt .kw5 {color: #22aadd;}
.cpp-qt.source-cpp-qt .co1 {color: #888888;}
.cpp-qt.source-cpp-qt .co2 {color: #006E28;}
.cpp-qt.source-cpp-qt .coMULTI {color: #888888; font-style: italic;}
.cpp-qt.source-cpp-qt .es0 {color: #000099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es1 {color: #000099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es2 {color: #660099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es3 {color: #660099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es4 {color: #660099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es5 {color: #006699; font-weight: bold;}
.cpp-qt.source-cpp-qt .br0 {color: #006E28;}
.cpp-qt.source-cpp-qt .sy0 {color: #006E28;}
.cpp-qt.source-cpp-qt .st0 {color: #BF0303;}
.cpp-qt.source-cpp-qt .nu0 {color: #B08000;}
.cpp-qt.source-cpp-qt .nu6 {color: #208080;}
.cpp-qt.source-cpp-qt .nu8 {color: #208080;}
.cpp-qt.source-cpp-qt .nu12 {color: #208080;}
.cpp-qt.source-cpp-qt .nu16 {color:#800080;}
.cpp-qt.source-cpp-qt .nu17 {color:#800080;}
.cpp-qt.source-cpp-qt .nu18 {color:#800080;}
.cpp-qt.source-cpp-qt .nu19 {color:#800080;}
.cpp-qt.source-cpp-qt .me1 {color: #2B74C7;}
.cpp-qt.source-cpp-qt .me2 {color: #2B74C7;}
.cpp-qt.source-cpp-qt .me3 {color: #2B74C7;}
.cpp-qt.source-cpp-qt .ln-xtra, .cpp-qt.source-cpp-qt li.ln-xtra, .cpp-qt.source-cpp-qt div.ln-xtra {background-color: #ffc;}
.cpp-qt.source-cpp-qt span.xtra { display:block; }

/*]]>*/
</style><!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Olimex_Qt_Environnement_fr skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">Olimex Qt Environnement/fr</span></h1>
						<div id="bodyContent">
								<div id="siteSub">From Qt Wiki</div>
								<div id="contentSub"><div id="mw-revision-info">Revision as of 21:08, 28 June 2015 by <a href="http://wiki.qt.io/User:Wieland" title="User:Wieland" class="mw-userlink">Wieland</a>  <span class="mw-usertoollinks">(<a href="http://wiki.qt.io/User_talk:Wieland" title="User talk:Wieland">Talk</a> | <a href="http://wiki.qt.io/Special:Contributions/Wieland" title="Special:Contributions/Wieland">contribs</a>)</span></div><br />
				<div id="mw-revision-nav">(<a href="http://wiki.qt.io/index.php?title=Olimex_Qt_Environnement/fr&amp;diff=prev&amp;oldid=18638" title="Olimex Qt Environnement/fr">diff</a>) <a href="http://wiki.qt.io/index.php?title=Olimex_Qt_Environnement/fr&amp;direction=prev&amp;oldid=18638" title="Olimex Qt Environnement/fr">← Older revision</a> | Latest revision (diff) | Newer revision → (diff)</div></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-navigation">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><table style="center; margin: -1px auto 0px;border: 1px solid rgb(127, 194, 66); border-left: 10px solid rgb(127, 194, 66); background:rgb(250,250,250); width:600px">

<tr>
<td style="padding: 0.25em 0.5em;"> <b>This article may require cleanup to meet the Qt Wiki's quality standards.</b> Reason: Auto-imported from ExpressionEngine.<br /><small>Please <b><a rel="nofollow" class="external text" href="http://wiki.qt.io/index.php?title=Olimex_Qt_Environnement/fr&amp;action=edit">improve this article</a></b> if you can. Remove the {{cleanup}} tag and add this page to <b><a href="http://wiki.qt.io/Updated_pages" title="Updated pages">Updated pages</a></b> list after it's clean.</small>
</td></tr></table>
<p>Install VM Debian
Conf debian
création SD
conf SD
conf SD QT
conf debian QT
conf QT
autres
</p><p>Installation VM
</p><p>Télécharger
virtualbox
à l'adresse suivante
<a rel="nofollow" class="external free" href="http://download.virtualbox.org/virtualbox/4.3.20/VirtualBox-4.3.20-96997-Win.exe">http://download.virtualbox.org/virtualbox/4.3.20/VirtualBox-4.3.20-96997-Win.exe</a>
</p><p>et
debian (32bits) i382 (amd64) etant la version 64bits
<a rel="nofollow" class="external free" href="http://cdimage.debian.org/debian-cd/7.8.0/i386/iso-cd/debian-7.8.0-i386-netinst.iso">http://cdimage.debian.org/debian-cd/7.8.0/i386/iso-cd/debian-7.8.0-i386-netinst.iso</a>
</p><p>installer virtualbox et créer une Machine virtuelle (VM)
</p><p>nom&#160;: [votre choix]
type&#160;: Linux
Version&#160;: Debian (32 bit)
quantité mémoire 1024 minimum
créer un disque dur virtuel maintenant
format&#160;: VDI
Dynamiquement alloué
taille disque dur&#160;: 80 go minimum
</p><p>installation Debian&#160;:
suivre les indication lors de l'installation
Attention a bien faire attention lors de l'attribution du mdp administrateur pour ne pas l'oublier
et pour plus de confort bien choisir votre langue pour avoir un clavier correctement mappé .
</p><p>configuration Debian :
Pour résoudre le problème de résolution il faut installer les additions invitées
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1">virtualbox <span class="sy0">:</span> Périphériques <span class="sy0">-&gt;</span> <span class="me3">Ins</span>érer l<span class="st0">'image CD des additions invité
&#160;
démarrer un terminal en administrateur Application-&gt; accessoire → terminal administrateur
ou sur un console normal tapez : su – et le mot de passe administrateur
&#160;
Nous installons maintenant les paquet utils
#apt-get install linux-headers-`uname -r` build-essential
Se placer dans /media
#cd /media/
Monter le CD des additions invitées
#mount cdrom0
Se placer dans le répertoire du CD
#cd cdrom
Lancer le script
#sh VboxLinuxAddition-XXXX.run
&#160;
il faut maintenant mettre a jour notre environnement avec les commandes suivante 
&#160;
#apt-get update
#apt-get upgrade
&#160;
Dans certain cas il y a des problème de clef il faut faire la manipulation suivante
# apt-get install emdebian-archive-keyring
&#160;
configuration clavier
il faut utiliser l'</span>outil console<span class="sy0">-</span>data
<span class="co2">#apt-get install console-data</span>
pour modifier plus tard le mappage il faut utiliser
<span class="co2">#dpkg console-data</span>
&#160;
Pour les opération de compilation il peut être <span class="kw4">int</span>éressant de supprimer le mode veille de la VM pour plus de confort
Utilisez les commandes
<span class="co2">#xset s 0 0</span>
<span class="co2">#xset dpms 0 0 0</span>
<span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span>—<span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span><span class="st0">''</span><span class="sy0">-</span>
&#160;
&#160;
Création SD
&#160;
Processus complet pour créer une carte SD pour carte OLIMEX avec kernel 3.4.90 et Linux Debian
&#160;
toutes les étapes seront réalisé en console et en mode administrateur
&#160;
<span class="nu0">1</span>. <span class="me1">Installation</span> de la toolchain
&#160;
Avant d<span class="st0">'installer la ToolChain il faut ajouter un dépôt a ceux existant pour notre VM:
#nano /etc/apt/sources.list
et ajouter à la fin
deb http://www.emdebian.org/debian squeeze main
deb http://www.emdebian.org/debian sid main (Pour la version wheezy de Debian)
&#160;
puis ctrl-x
et o ou y selon la langue pour enregistrer
&#160;
Installer la ToolChain avec les commande suivante
&#160;
# apt-get install gcc-4.7-arm-linux-gnueabihf ncurses-dev uboot-mkimage build-essential git
&#160;
cela va installer les outils pour : configurer le kernel, compiler le kernel, le uboot et finalement créer une image de ces éléments .
Git permet de télécharger des paquets sur Github
&#160;
Vous avez maintenant les outils essentiel a la réalisation d'</span>un noyau pour A20
&#160;
<span class="nu0">2</span>. <span class="me1">construction</span> du UBOOT
&#160;
Nous allons créer un dossier pour ne pas mélanger les éléments.
<span class="co2"># cd /home</span>
<span class="co2"># mkdir a20-olimex</span>
<span class="co2"># cd a20-olimex</span>
&#160;
Télécharger les source de uboot sur github
<span class="co2"># git clone -b sunxi https://github.com/linux-sunxi/u-boot-sunxi.git</span>
&#160;
après le téléchargement vous avez un nouveaux répertoire
<span class="co2"># cd u-boot-sunxi/</span>
&#160;
choisir dans les différente commande suivante celle correspondant a la carte A20 visé pour configurer le uboot
Les noms des différent fichier de configuration peuvent être trouvé dans le fichier boards.<span class="me1">cfg</span>
&#160;
<span class="nu16">2.1</span> A20<span class="sy0">-</span>OLinuXino_Lime2 board
&#160;
<span class="co2"># make A20-OLinuXino_Lime2_config ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf-</span>
&#160;
<span class="nu16">2.2</span> A20<span class="sy0">-</span>SOM board
&#160;
Il existe deux type de A20<span class="sy0">-</span>SOM avec comme principale différence la vitesse du bus pour la mémoire DDR3 
&#160;
A20<span class="sy0">-</span>SOM rev.<span class="me1">B</span> <span class="sy0">-</span> DDR3 vitesse du bus 384MHz<span class="br0">&#40;</span><span class="nu0">6</span> layer PCB<span class="br0">&#41;</span>
&#160;
A20<span class="sy0">-</span>SOM après rev.<span class="me1">D</span> <span class="sy0">-</span> DDR3 vitesse du bus 480MHz<span class="br0">&#40;</span><span class="nu0">8</span> layer PCB<span class="br0">&#41;</span>
&#160;
A20<span class="sy0">-</span>SOM up to rev.<span class="me1">B</span> type
&#160;
<span class="co2"># make Olimex_A20-SOM_config ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf-</span>
&#160;
A20<span class="sy0">-</span>SOM after rev.<span class="me1">D</span> il est posible d<span class="st0">'utiliser le configuration du Lime2
&#160;
# make A20-OLinuXino_Lime2_config ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf-
&#160;
2.3 A20-OLinuXino-MICRO board
&#160;
# make A20-OLinuXino_MICRO_config ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf-
&#160;
2.4 A20-OLinuXino-LIME board
&#160;
# make A20-OLinuXino_Lime_config ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf-
&#160;
Pour construire le uboot utiliser les commandes suivante
se placer dans /usr/bin
# cd /usr/bin
Modifier le lien vers le compilateur avec la commande suivante
# ln -sf arm-linux-gnueabihf-gcc-4.7 arm-linux-gnueabihf-gcc
ensuite retourner dans le dossier uboot
# cd /home/a20-olimex/u-boot-sunxi/
# make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf-
&#160;
A la fin du processus, vous pouvez vérifier si tout s'</span>est bien passé
&#160;
<span class="co2"># ls u-boot.bin u-boot-sunxi-with-spl.bin spl/sunxi-spl.bin</span>
&#160;
Si le retour correspond a ça <span class="sy0">:</span>
→ spl<span class="sy0">/</span>sunxi<span class="sy0">-</span>spl.<span class="me1">bin</span> u<span class="sy0">-</span>boot.<span class="me1">bin</span> u<span class="sy0">-</span>boot<span class="sy0">-</span>sunxi<span class="sy0">-</span>with<span class="sy0">-</span>spl.<span class="me1">bin</span>
tout est OK <span class="sy0">!</span>
<span class="co2"># cd ..</span>
&#160;
Vous devez vous trouver dans le dossier suivant
<span class="sy0">/</span>home<span class="sy0">/</span>a20<span class="sy0">-</span>olimex<span class="co2">#</span>
&#160;
<span class="nu0">3</span>. <span class="me1">Construction</span> du kernel
&#160;
Les source du kernel sont disponible sur github
télécharger les avec <span class="sy0">:</span>
<span class="co2"># git clone https://github.com/linux-sunxi/linux-sunxi (étape longue ~ 30 min a 1M/sec)</span>
&#160;
après le téléchargement allez dans le dossier
<span class="co2"># cd linux-sunxi/</span>
&#160;
Pour ajouter le support SPI il faut
télécharger le fichier spi<span class="sy0">-</span>sun7i.<span class="me1">c</span> 
&#160;
<span class="co2"># wget https://raw.githubusercontent.com/OLIMEX/OLINUXINO/master/SOFTWARE/A20/A20-build/spi-sun7i.c</span>
&#160;
et le copier dans drivers<span class="sy0">/</span>spi directory
<span class="co2"># cp spi-sun7i.c drivers/spi </span>
&#160;
Télécharger les patch SPI.<span class="me1">patch</span>
<span class="co2"># wget https://raw.githubusercontent.com/OLIMEX/OLINUXINO/master/SOFTWARE/A20/A20-build/SPI.patch</span>
&#160;
et appliquer le patch<span class="sy0">:</span>
<span class="co2"># patch -p0 &lt; SPI.patch</span>
&#160;
Ils faut maintenant récupéré le fichier de configuration pour le kernel a20_olimex_defconfig
<span class="co2"># wget https://raw.githubusercontent.com/OLIMEX/OLINUXINO/master/SOFTWARE/A20/A20-build/a20_olimex_defconfig</span>
&#160;
copier le fichier a20_olimex_defconfig dans le répertoire de configuration<span class="sy0">:</span>
<span class="co2"># cp a20_olimex_defconfig arch/arm/configs/</span>
&#160;
et make<span class="sy0">:</span>
<span class="co2"># make ARCH=arm a20_olimex_defconfig </span>
&#160;
le résultat devrait être<span class="sy0">:</span>
&#160;
→ configuration written to .<span class="me1">config</span>
&#160;
si vous voulez changer la configuration du kernel <span class="sy0">:</span>
<span class="br0">&#40;</span>Attention a avoir une console en pleine écran pour permettre l<span class="st0">'ouverture de l'</span>utilitaire<span class="br0">&#41;</span>
<span class="co2"># make ARCH=arm menuconfig</span>
&#160;
Maintenant vous pouvez continuer avec la compilation du kernel
&#160;
<span class="co2"># make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- -j4 uImage</span>
&#160;
lorsque c<span class="st0">'est fini vous avez un uImage et le message suivant qui confirme le bon déroulement:
&#160;
Kernel: arch/arm/boot/zImage is ready
UIMAGE arch/arm/boot/uImage
Image Name: Linux-3.4.90+
Created: Tue Aug 19 16:23:22 2014
Image Type: ARM Linux Kernel Image (uncompressed)
Data Size: 4596072 Bytes = 4488.35 kB = 4.38 MB
Load Address: 40008000
Entry Point: 40008000
Image arch/arm/boot/uImage is ready
&#160;
la prochaine étape et la construction des module du kernel:
&#160;
# make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- -j4 INSTALL_MOD_PATH=out modules
# make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- -j4 INSTALL_MOD_PATH=out modules_install
&#160;
A ce point vous disposé de l'</span>uboot et des modules kernel compilé pour votre cible.
<span class="me1">Le</span> fichier uImage est dans linux<span class="sy0">-</span>sunxi<span class="sy0">/</span>arch<span class="sy0">/</span>arm<span class="sy0">/</span>boot<span class="sy0">/</span>
&#160;
Les modules kernel sont dans
linux<span class="sy0">-</span>sunxi<span class="sy0">/</span>out<span class="sy0">/</span>lib<span class="sy0">/</span>modules<span class="sy0">/</span><span class="nu0">3</span>.<span class="me1">x</span>.<span class="me1">xx</span>
&#160;
Ou <span class="nu0">3</span>.<span class="me1">x</span>.<span class="me1">xx</span> est la version du kernel. <span class="me1">Dans</span> notre cas
linux<span class="sy0">-</span>sunxi<span class="sy0">/</span>out<span class="sy0">/</span>lib<span class="sy0">/</span>modules<span class="sy0">/</span>3.4.90<span class="sy0">+</span>
&#160;
<span class="nu0">4</span>. <span class="me1">formatage</span> et préparation de la carte SD
&#160;
il est recommandé d<span class="st0">'utiliser une carte SD entre 2 et 16 Go en classe 10 .
Premièrement il faut créer une table de partitions adapter a notre SD avec l'</span>outil fdisk
brancher SD dans un lecteur de carte SD sur la machine hôte .
<span class="me1">Il</span> faut activer le périphériques pour la VM dans le option virtualbox</pre></div></div>virtualbox → périphériques → périphériques USB
<p>Pour connaître le périphérique reconnus par notre VM il faut tester en branchant et débranchant la carte sd et en regarde le retour de
</p>
<ol>
<li> ls /dev/sd avec un &lt;TAB&gt; &lt;TAB&gt; pour voir la différence en général le périphérique est le sdb
</li>
</ol>
<p>Lorsque vous connaissez le périphérique vous pouvez commencer les étapes pour le formater
</p>
<ol>
<li> fdisk /dev/sdX
</li>
</ol>
<p>ensuite
</p>
<pre># p
</pre>
<p>s'il existent des partitions, il faut les supprimer avec la commande suivante.
Répété l'opération jusqu'à ce qu'il n'y est plus de partitions
d enter 
</p><p>création de la première partition
</p>
<ol>
<li> n enter p enter 1 enter enter <i>16M</i>
</li>
</ol>
<p>Création de la seconde partition
</p>
<ol>
<li> n enter p enter 2 enter enter enter
</li>
</ol>
<p>lister les partition créé
</p>
<ol>
<li> p enter
</li>
</ol>
<p>Si vous avez correctement réaliser les étapes, vous devriez avoir pour une carte 4Go le message suivant
</p><p>Disk /dev/sdg: 3980 MB, 3980394496 bytes
123 heads, 62 sectors/track, 1019 cylinders, total 7774208 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0x00000000
</p>
<pre>Device Boot Start End Blocks Id System
</pre>
<p>/dev/sdg1 2048 34815 16384 83 Linux
/dev/sdg2 34816 7774207 3869696 83 Linux
</p><p>Écrivais les partitions
press w
</p><p>Si cette étape rate il faut démonter la carte SD
</p>
<ol>
<li>umount /media/[indicatif de la carte]
</li>
</ol>
<p>Refaite un fdisk puis w.
</p><p>Maintenant nous allons formater le système de fichier de la carte
partition 1 → vfat
partition 2 → ext3
X etant la lettre correspondant a notre carte.
</p>
<ol>
<li> mkfs.vfat /dev/sdX1
</li>
<li> mkfs.ext3 /dev/sdX2
</li>
</ol>
<p><br />
5. Écrire le Uboot et u-boot-sunxi-with-spl.bin
</p><p><br />
Vous devez êtres dans /home/a20-olimex#
Attention il faut écrire ces blocs dans /dev/sdX et pas sdb1 ou sdb2
</p>
<ol>
<li> dd if=u-boot-sunxi/u-boot-sunxi-with-spl.bin of=/dev/sdX bs=1024 seek=8
</li>
</ol>
<p>6. Écrire kernel uImage sur la carte SD
se placer dans le dossier a20-olimex
cd /home/a20-olimex#
</p><p>créer un fichier pour monter les partitions de la carte SD
</p>
<ol>
<li> mkdir /mnt/sd
</li>
</ol>
<p>monter la première partition de la carte SD
</p>
<ol>
<li> mount /dev/sdX1 /mnt/sd
</li>
</ol>
<p>copier le Kernel uImage dans la première partition
</p>
<ol>
<li> cp linux-sunxi/arch/arm/boot/uImage /mnt/sd
</li>
</ol>
<p>7. Écrire le fichier script.bin
</p><p>Le script.bin contient la configuration des paramètres concernant les GPIO assignement, mémoire DRR , écran utilisé … .
</p><p>7.1 Pour A20-OLinuXino_Lime2 board, télécharger le script.bin suivant
</p>
<ol>
<li> wget <a rel="nofollow" class="external free" href="https://github.com/OLIMEX/OLINUXINO/raw/master/SOFTWARE/A20/A20-build/scripts_a20_Lime2_34_90_camera_rel_2/script.bin">https://github.com/OLIMEX/OLINUXINO/raw/master/SOFTWARE/A20/A20-build/scripts_a20_Lime2_34_90_camera_rel_2/script.bin</a>
</li>
</ol>
<p>7.2 Pour A20-SOM board télécharger le script.bin suivant
</p>
<ol>
<li> wget <a rel="nofollow" class="external free" href="https://github.com/OLIMEX/OLINUXINO/raw/master/SOFTWARE/A20/A20-build/A20-SOM-3.4.90_camera_scripts_rel_3/script_a20_SOM_HDMI_720p50/script.bin">https://github.com/OLIMEX/OLINUXINO/raw/master/SOFTWARE/A20/A20-build/A20-SOM-3.4.90_camera_scripts_rel_3/script_a20_SOM_HDMI_720p50/script.bin</a>
</li>
</ol>
<p>7.3 Pour A20-OLinuXino-MICRO board télécharger le script.bin suivant
</p>
<ol>
<li> wget <a rel="nofollow" class="external free" href="https://github.com/OLIMEX/OLINUXINO/raw/master/SOFTWARE/A20/A20-build/script_a20_OLinuXino-micro_3.4.90_camera_rel_10/script.bin">https://github.com/OLIMEX/OLINUXINO/raw/master/SOFTWARE/A20/A20-build/script_a20_OLinuXino-micro_3.4.90_camera_rel_10/script.bin</a>
</li>
</ol>
<p>7.4 Pour A20-OLinuXino-LIME board télécharger le script.bin suivant
</p>
<ol>
<li> wget <a rel="nofollow" class="external free" href="https://github.com/OLIMEX/OLINUXINO/raw/master/SOFTWARE/A20/A20-build/script_a20_lime_3.4.90_camera_rel_3/script.bin">https://github.com/OLIMEX/OLINUXINO/raw/master/SOFTWARE/A20/A20-build/script_a20_lime_3.4.90_camera_rel_3/script.bin</a>
</li>
</ol>
<p>Enfin, copier le script.bin dans la partition monter de la carte
</p>
<ol>
<li> cp script.bin /mnt/sd
</li>
<li> sync
</li>
<li> umount /dev/sdX1
</li>
</ol>
<p>8. Debian rootfs
</p><p>Le noyaux Linux et Uboot sont prêt, maintenant nous allons installer sur la deuxième partition le rootfs.
Il serais possible de le construire mais cela serais trop long (voir multistrap). Nous préférons en prendre un déjà réalisé
nous quittons le repertoire kernel
</p>
<ol>
<li> cd ..
</li>
</ol>
<p>Vous devriez être dans le dossier a20-olimex
</p>
<ol>
<li> /home/user/a20-olimex
</li>
</ol>
<p>télécharger le Debian rootfs avec le nom "debian_FS_34_90_camera_A20-olimex.tgz" ,il vous faudra un client torrent (Azureus, uTorrent, qBittorrent,Rtorrent etc).
Apt-get install rtorrent
Le liens du torrent:
<a rel="nofollow" class="external free" href="https://www.olimex.com/wiki/images/2/29/Debian_FS_34_90_camera_A20-olimex.torrent">https://www.olimex.com/wiki/images/2/29/Debian_FS_34_90_camera_A20-olimex.torrent</a>
</p><p>monter maintenant la deuxième partition:
</p>
<ol>
<li> mount /dev/sdX2 /mnt/sd
</li>
</ol>
<p>et décompresser l'archive dans la SD
</p>
<ol>
<li> tar zxvf debian_FS_34_90_camera_A20-olimex.tgz -C /mnt/sd
</li>
<li> ls /mnt/sd
</li>
</ol>
<p>le résultat devrais ressembler a ceci
bin dev home lost+found mnt proc run selinux sys usr
boot etc lib media opt root sbin srv tmp var
</p><p>Il faut maintenant remplacer les module kernel par ceux compilé
</p>
<ol>
<li> rm -rf /mnt/sd/lib/modules/*
</li>
<li> cp -rfv linux-sunxi/out/lib/modules/3.x.xx+/ /mnt/sd/lib/modules/
</li>
</ol>
<p>dans notre cas:
</p>
<ol>
<li> cp -rfv linux-sunxi/out/lib/modules/3.4.90+/ /mnt/sd/lib/modules/
</li>
</ol>
<p>remplacer /lib/firmware folder with the generated /linux-sunxi/out/firmware
</p>
<ol>
<li>cp -rfv linux-sunxi/out/lib/firmware/ /mnt/sd/lib/
</li>
<li> sync
</li>
<li> umount /mnt/sdX2
</li>
</ol>
<p>A ce point vous avez une carte prête a être utilisé .
Login et mot de passe par défaut → root / olimex
</p><p>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>
</p><p><br />
Configuration SD
démarrage
Pour le premier démarrage il est intéressant d'utiliser la sortie debug sur UART pour vérifier que le démarrage se passe bien et récupérer quelque informations
branche la carte sur uart pour accéder lors du premier démarrage a la console et activer le mode DHCP pour pouvoir accéder a la carte par ssh (plus simple pour contrôler la carte)
</p><p>réseaux
Avant d'établir une IP fixe il est utile d'utiliser le DHCP pour intégrer la route vers la Boxe internet
ou attribuer directement la route :
</p>
<ol>
<li>route add -net 192.168.55.0 netmask 255.255.255.0 gw 192.168.1.254 dev eth0 (exemple a adapter a votre reseaux)
</li>
</ol>
<p>pour afficher l'IP attribuer dans la console
</p>
<ol>
<li> ifconfig eth0
</li>
</ol>
<p>et pour modifier les paramètres de l'interface réseaux il faut éditer le fichier interfaces
nano /etc/network/interfaces
ensuite pour redémarrer une interfaces on effectue
ifdown eth0
ifup eth0
ou
/etc/init.d/networking restart (celle-ci redémarre toute les interfaces)
</p><p>FEX
(A venir)
<a rel="nofollow" class="external free" href="http://linux-sunxi.org/Fex_Guide">http://linux-sunxi.org/Fex_Guide</a>
</p><p>choix écran
Olimex fourni un script qui permet de choisir quelle écran utiliser (HDMI, LCD 4,5,11 pouces) dans /root
</p>
<ol>
<li> cd /root
</li>
<li> ./change_display_olimex_a20.sh
</li>
</ol>
<p>calibration tactile
une fonction est directement intégrer au noyaux et il est possible de l'appeler avec l'instruction suivante
</p>
<ol>
<li>ts_calibrate
</li>
</ol>
<p>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>
</p><p><br />
Configuration SD pour QT5
</p><p>Pour exécuter les application QT5 il faut installer les bon outils ainsi que les librairie qui seront utile a Qt tel que les driver graphique les lib multimédia et les pilotes openGL pour le module Mali (processeur graphique de nos carte)
</p><p>Installation mali 
</p><p>La configuration par défaut impose que le module mali soit désactiver. Pour le réactiver il faut soit l'appeler :
</p>
<ol>
<li>modprobe mali
</li>
</ol>
<p>ou pour l'activer au boot éditer le fichier /etc/modules
</p>
<ol>
<li>nano /etc/modules
</li>
</ol>
<p>et dé-commenter le module en supprimant le « # » devant
</p><p>Pour qu'un user normal puisse utiliser ce module il faut lui donner la permission avec :
</p><p>KERNEL"mali", MODE="0660", GROUP="video"
KERNEL"ump", MODE="0660", GROUP="video"
</p><p>il faut maintenant installer lib-UMP
prérequis
</p>
<ol>
<li> apt-get install git build-essential autoconf libtool 
</li>
</ol>
<p>récupérer le dépôt libUMP
</p>
<ol>
<li>git clone <a rel="nofollow" class="external free" href="https://github.com/linux-sunxi/libump.git">https://github.com/linux-sunxi/libump.git</a>
</li>
<li>cd libump
</li>
</ol>
<p>build de libump
</p>
<ol>
<li>apt-get install debhelper dh-autoreconf pkg-config
</li>
<li>dpkg-buildpackage -b
</li>
<li>dpkg -i ../libump_*.deb 
</li>
</ol>
<p><br />
</p>
<ol>
<li>autoreconf -i
</li>
<li>./configure
</li>
<li>make
</li>
<li>make install
</li>
</ol>
<p><br />
Installation Mali
</p>
<ol>
<li>apt-get install git build-essential autoconf automake
</li>
</ol>
<p>pour installer la version x11, ajouter
</p>
<ol>
<li>apt-get install xutils-dev 
</li>
</ol>
<p>récupéré le dépôt
</p>
<ol>
<li>git clone —recursive <a rel="nofollow" class="external free" href="https://github.com/linux-sunxi/sunxi-mali.git">https://github.com/linux-sunxi/sunxi-mali.git</a>
</li>
<li>cd sunxi-mali
</li>
</ol>
<p>Il reste a compiler avec la configuration voulu
</p>
<ol>
<li> make config (avec auto détection de la configuration)
</li>
</ol>
<p>Pour choisir l'environnement (exemple framebuffer)
</p>
<ol>
<li>make config VERSION=r3p0 ABI=armhf EGL_TYPE=framebuffer
</li>
</ol>
<p>pour X11 seulement
</p>
<ol>
<li> apt-get install libx11-dev libxext-dev libdrm-dev
</li>
<li> git clone <a rel="nofollow" class="external free" href="https://github.com/robclark/libdri2">https://github.com/robclark/libdri2</a>
</li>
<li> cd libdri2
</li>
<li> ./autogen.sh
</li>
<li> ./configure
</li>
<li> make
</li>
<li> make install
</li>
<li> ldconfig
</li>
</ol>
<p>Enfin pour terminer l'installation des composant il faut se placer dans le dossier sunxi-mali puis
</p>
<ol>
<li>make install
</li>
</ol>
<p>pour tester il faut aller dans le dossier sunxi-mali et compiler le test
</p>
<ol>
<li>make test
</li>
<li> cd test
</li>
<li>./test
</li>
</ol>
<p>Doit afficher un triangle dans une fenêtre sur x11 ou en console .
</p><p>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>
</p><p>Configuration Debian 02 (compilation LibQT):
</p><p>installer sshfs
</p>
<ol>
<li>apt-get install ssh
</li>
<li>apt-get install sshfs
</li>
</ol>
<p>créer un dossier dans /mnt
</p>
<ol>
<li>mkdir /mnt/a20
</li>
</ol>
<p>se connecter a la carte cible
</p>
<ol>
<li>sshfs -o allow_other root@193.253.231.61:/ /mnt/a20
</li>
</ol>
<p>il vous sera normalement demandé le mot de passe administrateur de la carte cible
vérifier que le lien est bien réaliser en regardant dans /mnt/a20
</p><p>Ensuite, il faut téléchargé la chaîne de cross compilation
<a rel="nofollow" class="external free" href="https://releases.linaro.org/13.09/components/toolchain/binaries">https://releases.linaro.org/13.09/components/toolchain/binaries</a>
et chercher gcc-linaro-arm-linux-gnueabihf-4.8-2013.09_linux.tar.xz
</p>
<ol>
<li>wget <a rel="nofollow" class="external free" href="https://releases.linaro.org/13.09/components/toolchain/binaries/gcc-linaro-arm-linux-gnueabihf-4.8-2013.09_linux.tar.xz">https://releases.linaro.org/13.09/components/toolchain/binaries/gcc-linaro-arm-linux-gnueabihf-4.8-2013.09_linux.tar.xz</a>
</li>
</ol>
<p>et décompresser le&#160;:
</p>
<ol>
<li>tar xvfJ gcc-linaro-arm-linux-gnueabihf-4.8-2013.09_win32.tar.xz
</li>
</ol>
<p>ensuite il faut récupérer les patch pour le compilateur&#160;:
</p>
<ol>
<li>apt-get install git
</li>
<li>git clone <a rel="nofollow" class="external free" href="git://gitorious.org/cross-compile-tools/cross-compile-tools.git">git://gitorious.org/cross-compile-tools/cross-compile-tools.git</a>
</li>
<li>cd cross-compile-tools
</li>
</ol>
<p>—remplacer [chemin compilateur linaro] par le chemin du compilateur Linaro—
</p>
<ol>
<li>./fixQualifiedLibraryPaths /mnt/a20/ /[chemin du compilateur linaro]/gcc-linaro-arm-linux-gnueabihf-4.8-2013.09_linux/bin/arm-linux-gnueabihf-g<i>+</i>
</li>
</ol>
<p><br />
il faut maintenant télécharger QT_everywhere
<a rel="nofollow" class="external free" href="http://download.qt.io/archive/qt/5.3/5.3.2/single/">http://download.qt.io/archive/qt/5.3/5.3.2/single/</a>
</p>
<ol>
<li>wget <a rel="nofollow" class="external free" href="http://download.qt.io/archive/qt/5.3/5.3.2/single/qt-everywhere-opensource-src-5.3.2.tar.gz">http://download.qt.io/archive/qt/5.3/5.3.2/single/qt-everywhere-opensource-src-5.3.2.tar.gz</a>
</li>
</ol>
<p>décompresser l'archive&#160;:
</p>
<ol>
<li>tar -zxvf qt-everywhere-opensource-src-5.3.2.tar.gz
</li>
</ol>
<p>entrer dans le dossier qt-everywhere
</p>
<ol>
<li>cd qt-everywhere-opensource-src-5.3.2 
</li>
</ol>
<p>et effectuer les instruction suivante
</p>
<ol>
<li>mkdir qtbase/mkspecs/devices/linux-a20olimex-g+<i>/</i>
</li>
<li>cp qtbase/mkspecs/devices/linux-beagleboard-g/qplatformdefs.h qtbase/mkspecs/devices/linux-a20olimex-g/
</li>
</ol>
<p>il va falloir éditer le fichier qmake.conf avec&#160;:
</p>
<ol>
<li>nano qtbase/mkspecs/devices/linux-a20olimex-g/qmake.conf
</li>
</ol>
<p>copier coller la configuration suivante:
</p><p>///////////////////////////////////////////////////////////////////
</p>
<ol>
<li>
</li>
<li> qmake configuration for the A20_OlinuxinO boards
</li>
<li> <a rel="nofollow" class="external free" href="http://www.olimex.com/">http://www.olimex.com/</a>
</li>
</ol>
<p>MAKEFILE_GENERATOR = UNIX
CONFIG<i>= incremental gdb_dwarf_index</i>
QMAKE_INCREMENTAL_STYLE = sublib
</p><p>include(../../common/linux.conf)
include(../../common/gcc-base-unix.conf)
include(../../common/g+<i>-unix.conf)</i>
</p><p>load(device_config)
</p><p>QT_QPA_DEFAULT_PLATFORM = eglfs
</p>
<ol>
<li>EGLFS_PLATFORM_HOOKS_SOURCES = $$PWD/qeglfshooks_a20.cpp
</li>
<li> modifications to g.conf
</li>
</ol>
<p>QMAKE_CC = $${CROSS_COMPILE}gcc
QMAKE_CXX = $${CROSS_COMPILE}g<i>+</i>
QMAKE_LINK = $${QMAKE_CXX}
QMAKE_LINK_SHLIB = $${QMAKE_CXX}
</p>
<ol>
<li> modifications to linux.conf
</li>
</ol>
<p>QMAKE_AR = $${CROSS_COMPILE}ar cqs
QMAKE_OBJCOPY = $${CROSS_COMPILE}objcopy
QMAKE_NM = $${CROSS_COMPILE}nm -P
QMAKE_STRIP = $${CROSS_COMPILE}strip
</p><p>COMPILER_FLAGS = -march=armv7-a -mtune=cortex-a7 -mfpu=neon -DLINUX=1 -DEGL_API_FB=1 -mfloat-abi=hard
</p>
<ol>
<li>modifications to gcc-base.conf
</li>
</ol>
<p>QMAKE_CFLAGS <i>= $${COMPILER_FLAGS}</i>
QMAKE_CXXFLAGS<i>= $${COMPILER_FLAGS}</i>
QMAKE_CXXFLAGS_RELEASE <i>= -O3</i>
</p><p>QMAKE_LIBS<i>= -lrt -lpthread -ldl</i>
</p>
<ol>
<li> Extra stuff (OpenGL, DirectFB, …)
</li>
</ol>
<p>QMAKE_INCDIR_EGL = /mnt/a20/usr/include/EGL
QMAKE_LIBDIR_EGL = /mnt/a20/usr/lib
QMAKE_INCDIR_OPENGL_ES2 = /mnt/a20/usr/include/GLES2
QMAKE_LIBDIR_OPENGL_ES2 = /mnt/a20/usr/lib
</p>
<ol>
<li>QMAKE_INCDIR_OPENVG = $${QMAKE_INCDIR_EGL}
</li>
<li>QMAKE_LIBDIR_OPENVG = $${QMAKE_LIBDIR_EGL}
</li>
</ol>
<p>QMAKE_LIBS_EGL = -lEGL
QMAKE_LIBS_OPENGL_ES2 = -lGLESv2 $${QMAKE_LIBS_EGL}
</p>
<ol>
<li>QMAKE_LIBS_OPENVG = -lOpenVG $${QMAKE_LIBS_EGL}
</li>
</ol>
<ol>
<li> Sanity check
</li>
</ol>
<p>deviceSanityCheckCompiler()
</p><p>load(qt_config)
</p><p><br />
////////////////////////////////////////////////////////////////////////////
</p><p><br />
il faut aussi éditer le fichier qeglfshooks_stub.cpp
nano qtbase/src/plugins/platforms/eglfs/qeglfshooks_stub.cpp
</p><p>chercher createNativeWindow avec
ctrl-w
et modifier la fonction comme suis&#160;:
</p><p>////////////////////////////////////////////////////////////////////////////
</p><p>EGLNativeWindowType QEglFSHooks::createNativeWindow(QPlatformWindow *platformWindow,
</p>
<pre>const QSize &amp;size,
const QSurfaceFormat &amp;format)
</pre>
<p>{
</p>
<pre>Q_UNUSED(platformWindow);
Q_UNUSED(size);
Q_UNUSED(format);
</pre>
<p>—————————Partie a modifier————————————
</p>
<pre>//return 0;
static struct mali_native_window native_window = {
.width = (short unsigned int)size.width(),
.height = (short unsigned int)size.height(),
};
return &amp;native_window;
</pre>
<p>———————————————————————————-
}
</p><p>////////////////////////////////////////////////////////////////////////////
</p><p>Nous allons maintenant pouvoir compiler les source QT
</p><p>il faut en premier configurer avec&#160;:
remarque :remplacer [chemin compilateur linaro] par le chemin du compilateur Linaro—
</p>
<ol>
<li>./configure -opengl es2 -device linux-a20olimex-g++ -device-option CROSS_COMPILE=/[chemin compilateur linaro]/gcc-linaro-arm-linux-gnueabihf-4.8-2013.09_linux/bin/arm-linux-gnueabihf- -sysroot /mnt/a20/ -opensource -confirm-license -optimized-qmake -release make libs prefix /opt/qt5olim2 -no-pch -nomake examples -nomake tests no-xcb -eglfs -v
</li>
</ol>
<p>attention a bien vérifier le chemin du cross-compilateur et aussi vérifier que la carte cible est toujours monter dans /mnt/a20 avec la commande
</p>
<ol>
<li>ls /mnt/a20 
</li>
</ol>
<p>vous devriez avoir un config.summary de ce type là a la fin&#160;:
</p><p><br />
////////////////////////////////////////////////////////////////////////////
</p><p>Build options:
</p>
<pre>Configuration ………. accessibility alsa audio-backend c+<i>11 clock-gettime clock-monotonic compile_examples concurrent cross_compile dbus egl eglfs evdev eventfd fontconfig full-config getaddrinfo getifaddrs glib iconv icu inotify ipv6ifname large-config largefile libudev linuxfb medium-config minimal-config mremap nis no-harfbuzz opengl opengles2 openssl pcre png posix_fallocate qpa qpa reduce_exports reduce_relocations release rpath shared small-config system-freetype system-png system-zlib xinput2 xlib xrender</i>
Build parts ………… libs
Mode ………………. release
Using C<i>+11 ………… yes</i>
Using PCH ………….. no
Target compiler supports:
iWMMXt/Neon ………. no/auto
</pre>
<p>Qt modules and options:
</p>
<pre>Qt D-Bus …………… yes (loading dbus-1 at runtime)
Qt Concurrent ………. yes
Qt GUI …………….. yes
Qt Widgets …………. yes
Large File …………. yes
JavaScriptCore JIT ….. yes (To be decided by JavaScriptCore)
QML debugging ………. yes
Use system proxies ….. no
</pre>
<p>Support enabled for:
</p>
<pre>Accessibility ………. yes
ALSA ………………. yes
CUPS ………………. no
FontConfig …………. yes
FreeType …………… yes (system library)
Glib ………………. yes
GTK theme ………….. no
HarfBuzz …………… no
Iconv ……………… yes
ICU ……………….. yes
Image formats:
GIF ……………… yes (plugin, using bundled copy)
JPEG …………….. yes (plugin, using bundled copy)
PNG ……………… yes (in QtGui, using system library)
journald …………… no
mtdev ……………… no
Networking:
getaddrinfo ………. yes
getifaddrs ……….. yes
IPv6 ifname ………. yes
OpenSSL ………….. yes (loading libraries at run-time)
NIS ……………….. yes
OpenGL / OpenVG:
EGL ……………… yes
OpenGL …………… yes (OpenGL ES 2.x)
OpenVG …………… no
PCRE ………………. yes (bundled copy)
pkg-config …………. yes
PulseAudio …………. no
QPA backends:
DirectFB …………. no
EGLFS ……………. yes
KMS ……………… no
LinuxFB ………….. yes
XCB ……………… no
Session management ….. yes
SQL drivers:
DB2 ……………… no
InterBase ………… no
MySQL ……………. no
OCI ……………… no
ODBC …………….. no
PostgreSQL ……….. no
SQLite 2 …………. no
SQLite …………… yes (plugin, using bundled copy)
TDS ……………… no
udev ………………. yes
xkbcommon ………….. no
zlib ………………. yes (system library)
</pre>
<p>NOTE: Qt is using double for qreal on this system. This is binary incompatible against Qt 5.1.
Configure with '-qreal float' to create a build that is binary compatible with 5.1.
</p><p>////////////////////////////////////////////////////////////////////////////
</p><p>ensuite il faut compiler les lib et les installer avec les commande suivante (étape très longue 2-5 heure)
</p>
<ol>
<li>make -j 5 (~3H)
</li>
<li>make install (~20Min)
</li>
</ol>
<p>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-</i>-<i>-_</i>
</p><p>configuration de QT
Installer QT
Il est possible d'installer plusieurs version de QT.
la première méthode installe seulement QT-creator, la seconde installe l'environnement QT avec tout les outils ( documentation, exemple …)
Méthode 1 :
Télécharger et exécuter le lien suivant sur votre environnement de développement
<a rel="nofollow" class="external free" href="http://download.qt.io/official_releases/qtcreator/3.3/3.3.0/qt-creator-opensource-linux-x86-3.3.0.run">http://download.qt.io/official_releases/qtcreator/3.3/3.3.0/qt-creator-opensource-linux-x86-3.3.0.run</a>
</p>
<ol>
<li> wget <a rel="nofollow" class="external free" href="http://download.qt.io/official_releases/qtcreator/3.3/3.3.0/qt-creator-opensource-linux-x86-3.3.0.run">http://download.qt.io/official_releases/qtcreator/3.3/3.3.0/qt-creator-opensource-linux-x86-3.3.0.run</a>
</li>
<li> chmod +x qt-creator-opensource-linux-x86-3.3.0.run
</li>
<li>./qt-creator-opensource-linux-x86-3.3.0.run
</li>
</ol>
<p>Méthode 2 :
Télécharger et exécuter le lien suivant sur votre environnement de développement
<a rel="nofollow" class="external free" href="http://download.qt.io/official_releases/online_installers/qt-opensource-linux-x86-online.run">http://download.qt.io/official_releases/online_installers/qt-opensource-linux-x86-online.run</a>
</p>
<ol>
<li> wget <a rel="nofollow" class="external free" href="http://download.qt.io/official_releases/qtcreator/3.3/3.3.0/qt-opensource-linux-x86-online.run">http://download.qt.io/official_releases/qtcreator/3.3/3.3.0/qt-opensource-linux-x86-online.run</a>
</li>
<li> chmod <i>x qt-opensource-linux-x86-online.run</i>
</li>
<li>./qt-opensource-linux-x86-online.run
</li>
</ol>
<p>Une fois l'IDE installé , il faut configurer le compilateur
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1">Qtcreator
outils → options
appareil mobile → ajouter → périphérique Linux générique
nom <span class="sy0">:</span> olimex
IP <span class="sy0">:</span> <span class="nu16">192.168</span>.<span class="me1">xxx</span>.<span class="me1">xxx</span>
authentification
Login de la carte
mdp de la carte
&#160;
Compiler <span class="sy0">&amp;</span> Exécuter 
&#160;
Débogueur → ajouter
Nom <span class="sy0">:</span>gdb<span class="sy0">-</span>olimex
Chemin<span class="sy0">:</span><span class="br0">&#91;</span>chemin linaro<span class="br0">&#93;</span><span class="sy0">/</span>gcc<span class="sy0">-</span>linaro<span class="sy0">-</span>arm<span class="sy0">-</span>linux<span class="sy0">-</span>gnueabihf<span class="sy0">-</span><span class="nu16">4.8</span><span class="sy0">-</span><span class="nu16">2013.09</span>_linux<span class="sy0">/</span>bin<span class="sy0">/</span>arm<span class="sy0">-</span>linux<span class="sy0">-</span>gnueabihf<span class="sy0">-</span>gdb
&#160;
Compilateur → ajouter → GCC
Nom <span class="sy0">:</span> gcc<span class="sy0">-</span>olimex
chemin du compilateur <span class="sy0">:</span> <span class="br0">&#91;</span>chemin linaro<span class="br0">&#93;</span><span class="sy0">/</span>gcc<span class="sy0">-</span>linaro<span class="sy0">-</span>arm<span class="sy0">-</span>linux<span class="sy0">-</span>gnueabihf<span class="sy0">-</span><span class="nu16">4.8</span><span class="sy0">-</span><span class="nu16">2013.09</span>_linux<span class="sy0">/</span>bin<span class="sy0">/</span>arm<span class="sy0">-</span>linux<span class="sy0">-</span>gnueabihf<span class="sy0">-</span>g<span class="st0">''</span><span class="sy0">+</span>
&#160;
Version de QT → ajouter → <span class="sy0">/</span>opt<span class="sy0">/</span>qt5olim2<span class="sy0">/</span>bin<span class="sy0">/</span>qmake <span class="br0">&#40;</span>chemin définis dans .<span class="me1">config</span> lors de la compilation des source QT<span class="br0">&#41;</span>
Nom de la version <span class="sy0">:</span> Qt<span class="sy0">-</span>olimex
&#160;
Kits → ajouter
Nom <span class="sy0">:</span> Olimexkit
Type de périphérique <span class="sy0">:</span> périphérique Linux générique
Appareil mobile <span class="sy0">:</span> olimex
Racine du système <span class="sy0">:</span> <span class="sy0">/</span>mnt<span class="sy0">/</span>a20
compilateur <span class="sy0">:</span> gcc<span class="sy0">-</span>olimex
Version de QT <span class="sy0">:</span> Qt<span class="sy0">-</span>olimex
&#160;
a partir de là vous devriez avoir vos projet qui s’exécute automatiquement sur la carte distante si celle<span class="sy0">-</span>ci a bien était monter dans <span class="sy0">/</span>mnt<span class="sy0">/</span>a20
&#160;
Sources
&#160;
https<span class="sy0">:</span><span class="co1">//github.com/OLIMEX/OLINUXINO/tree/master/SOFTWARE/A20/A20-build</span>
http<span class="sy0">:</span><span class="co1">//linux-sunxi.org/</span>
http<span class="sy0">:</span><span class="co1">//linux-sunxi.org/Fex_Guide</span>
http<span class="sy0">:</span><span class="co1">//linux-sunxi.org/Mali_binary_driver</span>
https<span class="sy0">:</span><span class="co1">//www.olimex.com/forum/index.php?topic=3825.0</span>
https<span class="sy0">:</span><span class="co1">//www.olimex.com/forum/index.php?topic=3826.0</span>
http<span class="sy0">:</span><span class="co1">//wiki.qt.io/Building_Qt_5_from_Git</span>
https<span class="sy0">:</span><span class="co1">//www.olimex.com/forum/index.php?topic=2666.0</span>
http<span class="sy0">:</span><span class="co1">//wickwire2099.blogspot.pt/</span></pre></div></div>

<!-- 
NewPP limit report
CPU time usage: 0.078 seconds
Real time usage: 0.079 seconds
Preprocessor visited node count: 24/1000000
Preprocessor generated node count: 112/1000000
Post‐expand include size: 1312/2097152 bytes
Template argument size: 423/2097152 bytes
Highest expansion depth: 5/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key qtio_wiki:pcache:idhash:2966-0!*!0!*!*!*!* and timestamp 20151105104725 and revision id 18638
 -->
</div>								<div class="printfooter">
				Retrieved from "<a href="http://wiki.qt.io/index.php?title=Olimex_Qt_Environnement/fr&amp;oldid=18638">http://wiki.qt.io/index.php?title=Olimex_Qt_Environnement/fr&amp;oldid=18638</a>"				</div>
												<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="http://wiki.qt.io/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="http://wiki.qt.io/Category:Articles_needing_cleanup" title="Category:Articles needing cleanup">Articles needing cleanup</a></li></ul></div></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
				<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
	<h3 id="p-personal-label">Personal tools</h3>
	<ul>
<li id="pt-anonuserpage"><a href="http://wiki.qt.io/User:10.0.113.70" class="new" title="The user page for the IP address you are editing as [.]" accesskey=".">10.0.113.70</a></li><li id="pt-anontalk"><a href="http://wiki.qt.io/User_talk:10.0.113.70" class="new" title="Discussion about edits from this IP address [n]" accesskey="n">Talk for this IP address</a></li><li id="pt-login"><a href="http://wiki.qt.io/index.php?title=Special:QtLogin&amp;returnto=Olimex+Qt+Environnement%2Ffr" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Sign in</a></li>	</ul>
</div>
				<div id="left-navigation">
					<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
	<h3 id="p-namespaces-label">Namespaces</h3>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="http://wiki.qt.io/Olimex_Qt_Environnement/fr"  title="View the content page [c]" accesskey="c">Page</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="http://wiki.qt.io/index.php?title=Talk:Olimex_Qt_Environnement/fr&amp;action=edit&amp;redlink=1"  title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
			</ul>
</div>
<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
	<h3 id="mw-vector-current-variant">
		</h3>
	<h3 id="p-variants-label"><span>Variants</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
				</div>
				<div id="right-navigation">
					<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
	<h3 id="p-views-label">Views</h3>
	<ul>
					<li id="ca-view" class="selected"><span><a href="http://wiki.qt.io/Olimex_Qt_Environnement/fr" >Read</a></span></li>
					<li id="ca-viewsource"><span><a href="http://wiki.qt.io/index.php?title=Olimex_Qt_Environnement/fr&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
					<li id="ca-history" class="collapsible"><span><a href="http://wiki.qt.io/index.php?title=Olimex_Qt_Environnement/fr&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
			</ul>
</div>
<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
	<h3 id="p-cactions-label"><span>Actions</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
<div id="p-search" role="search">
	<h3><label for="searchInput">Search</label></h3>
	<form action="http://wiki.qt.io/index.php" id="searchform">
					<div id="simpleSearch">
					<input type="search" name="search" placeholder="Search" title="Search Qt Wiki [f]" accesskey="f" id="searchInput" /><input type="hidden" value="Special:Search" name="title" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton" />		</div>
	</form>
</div>
				</div>
			</div>
			<div id="mw-panel">
					<div id="p-logo" role="banner"><a style="background-image: url(http://wiki.qt.io/skins/common/images/wiki.png);" href="http://wiki.qt.io/Main_Page"  title="Visit the main page"></a></div>
				<div class="portal" role="navigation" id='p-navigation' aria-labelledby='p-navigation-label'>
	<h3 id='p-navigation-label'>Navigation</h3>
	<div class="body">
		<ul>
			<li id="n-mainpage-description"><a href="http://wiki.qt.io/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
			<li id="n-recentchanges"><a href="http://wiki.qt.io/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
			<li id="n-randompage"><a href="http://wiki.qt.io/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
			<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
	<h3 id='p-tb-label'>Tools</h3>
	<div class="body">
		<ul>
			<li id="t-whatlinkshere"><a href="http://wiki.qt.io/Special:WhatLinksHere/Olimex_Qt_Environnement/fr" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
			<li id="t-recentchangeslinked"><a href="http://wiki.qt.io/Special:RecentChangesLinked/Olimex_Qt_Environnement/fr" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
			<li id="t-specialpages"><a href="http://wiki.qt.io/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
			<li id="t-print"><a href="http://wiki.qt.io/index.php?title=Olimex_Qt_Environnement/fr&amp;oldid=18638&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
			<li id="t-permalink"><a href="http://wiki.qt.io/index.php?title=Olimex_Qt_Environnement/fr&amp;oldid=18638" title="Permanent link to this revision of the page">Permanent link</a></li>
			<li id="t-info"><a href="http://wiki.qt.io/index.php?title=Olimex_Qt_Environnement/fr&amp;action=info">Page information</a></li>
		</ul>
	</div>
</div>
			</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 28 June 2015, at 21:08.</li>
											<li id="footer-info-viewcount">This page has been accessed 1,374 times.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-terms"><a href='https://developer.qtcloudservices.com/legal/terms'>Käyttöehdot</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
					<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="http://wiki.qt.io/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<script>/*<![CDATA[*/window.jQuery && jQuery.ready();/*]]>*/</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","skins.vector.collapsibleNav"],null,true);
}</script>
<script src="http://wiki.qt.io/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54043535-2', 'auto');
  ga('send', 'pageview');

</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":194});
}</script>
	</body>

<!-- Mirrored from wiki.qt.io/index.php?title=Olimex_Qt_Environnement/fr&oldid=18638 by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 05 Nov 2015 13:46:00 GMT -->
</html>
