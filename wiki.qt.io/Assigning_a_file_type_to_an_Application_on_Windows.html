<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from wiki.qt.io/Assigning_a_file_type_to_an_Application_on_Windows by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 05 Nov 2015 07:31:50 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>Assigning a file type to an Application on Windows - Qt Wiki</title>
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />
<meta name="generator" content="MediaWiki 1.23.3" />
<link rel="shortcut icon" href="favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Qt Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="api251f.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Qt Wiki Atom feed" href="apidf90.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="load771b.css?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.vector.styles&amp;only=styles&amp;skin=vector&amp;*" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="loadc6d2.css?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: qtio_wiki:resourceloader:filter:minify-css:7:e91d7bc946738c8892a88ad5616a59ba */</style>
<script src="load8478.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Assigning_a_file_type_to_an_Application_on_Windows","wgTitle":"Assigning a file type to an Application on Windows","wgCurRevisionId":16397,"wgRevisionId":16397,"wgArticleId":48,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Articles needing cleanup","Snippets"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Assigning_a_file_type_to_an_Application_on_Windows","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"hidesig":true,"preview":true,"previewDialog":false,"publish":true}});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"editfont":"default","editondblclick":0,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":1,"extendwatchlist":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nickname":"","norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"rcdays":7,"rclimit":50,"rows":25,"showhiddencats":0,"shownumberswatching":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":1,"watchdefault":1,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,
"useeditwarning":1,"prefershttps":1,"usebetatoolbar":1,"usebetatoolbar-cgd":1,"wikieditor-preview":1,"wikieditor-publish":1,"language":"en","variant-gan":"gan","variant-iu":"iu","variant-kk":"kk","variant-ku":"ku","variant-shi":"shi","variant-sr":"sr","variant-tg":"tg","variant-uz":"uz","variant-zh":"zh","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"searchNs500":false,"searchNs501":false,"searchNs700":false,"searchNs701":false,"variant":"en"});},{},{});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});},{},{});
/* cache key: qtio_wiki:resourceloader:filter:minify-js:7:9743cb8b8019d46de5946bfe6dfa04d7 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<style type="text/css">/*<![CDATA[*/
.source-cpp-qt {line-height: normal;}
.source-cpp-qt li, .source-cpp-qt pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for cpp-qt
 * CSS class: source-cpp-qt, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.cpp-qt.source-cpp-qt .de1, .cpp-qt.source-cpp-qt .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.cpp-qt.source-cpp-qt  {font-family:monospace;}
.cpp-qt.source-cpp-qt .imp {font-weight: bold; color: red;}
.cpp-qt.source-cpp-qt li, .cpp-qt.source-cpp-qt .li1 {font-weight: normal; vertical-align:top;}
.cpp-qt.source-cpp-qt .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.cpp-qt.source-cpp-qt .li2 {font-weight: bold; vertical-align:top;}
.cpp-qt.source-cpp-qt .kw1 {color: #000000; font-weight:bold;}
.cpp-qt.source-cpp-qt .kw2 {color: #0057AE;}
.cpp-qt.source-cpp-qt .kw3 {color: #2B74C7;}
.cpp-qt.source-cpp-qt .kw4 {color: #0057AE;}
.cpp-qt.source-cpp-qt .kw5 {color: #22aadd;}
.cpp-qt.source-cpp-qt .co1 {color: #888888;}
.cpp-qt.source-cpp-qt .co2 {color: #006E28;}
.cpp-qt.source-cpp-qt .coMULTI {color: #888888; font-style: italic;}
.cpp-qt.source-cpp-qt .es0 {color: #000099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es1 {color: #000099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es2 {color: #660099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es3 {color: #660099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es4 {color: #660099; font-weight: bold;}
.cpp-qt.source-cpp-qt .es5 {color: #006699; font-weight: bold;}
.cpp-qt.source-cpp-qt .br0 {color: #006E28;}
.cpp-qt.source-cpp-qt .sy0 {color: #006E28;}
.cpp-qt.source-cpp-qt .st0 {color: #BF0303;}
.cpp-qt.source-cpp-qt .nu0 {color: #B08000;}
.cpp-qt.source-cpp-qt .nu6 {color: #208080;}
.cpp-qt.source-cpp-qt .nu8 {color: #208080;}
.cpp-qt.source-cpp-qt .nu12 {color: #208080;}
.cpp-qt.source-cpp-qt .nu16 {color:#800080;}
.cpp-qt.source-cpp-qt .nu17 {color:#800080;}
.cpp-qt.source-cpp-qt .nu18 {color:#800080;}
.cpp-qt.source-cpp-qt .nu19 {color:#800080;}
.cpp-qt.source-cpp-qt .me1 {color: #2B74C7;}
.cpp-qt.source-cpp-qt .me2 {color: #2B74C7;}
.cpp-qt.source-cpp-qt .me3 {color: #2B74C7;}
.cpp-qt.source-cpp-qt .ln-xtra, .cpp-qt.source-cpp-qt li.ln-xtra, .cpp-qt.source-cpp-qt div.ln-xtra {background-color: #ffc;}
.cpp-qt.source-cpp-qt span.xtra { display:block; }

/*]]>*/
</style><!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Assigning_a_file_type_to_an_Application_on_Windows skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">Assigning a file type to an Application on Windows</span></h1>
						<div id="bodyContent">
								<div id="siteSub">From Qt Wiki</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-navigation">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><table style="center; margin: -1px auto 0px;border: 1px solid rgb(127, 194, 66); border-left: 10px solid rgb(127, 194, 66); background:rgb(250,250,250); width:600px">

<tr>
<td style="padding: 0.25em 0.5em;"> <b>This article may require cleanup to meet the Qt Wiki's quality standards.</b> Reason: Auto-imported from ExpressionEngine.<br /><small>Please <b><a rel="nofollow" class="external text" href="indexbba0.html?title=Assigning_a_file_type_to_an_Application_on_Windows&amp;action=edit">improve this article</a></b> if you can. Remove the {{cleanup}} tag and add this page to <b><a href="Updated_pages.html" title="Updated pages">Updated pages</a></b> list after it's clean.</small>
</td></tr></table>
<p><b>English</b> | <a href="Assigning_a_file_type_to_an_Application_on_Windows_German.html" title="Assigning a file type to an Application on Windows German" class="mw-redirect">Deutsch</a>
</p><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Assigning_a_file_type_to_an_Application_on_Windows"><span class="tocnumber">1</span> <span class="toctext">Assigning a file type to an Application on Windows</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Background_.2F_technical_stuff"><span class="tocnumber">1.1</span> <span class="toctext">Background / technical stuff</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#How_to_do_it"><span class="tocnumber">1.2</span> <span class="toctext">How to do it</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Use_the_DocumentWindow_class"><span class="tocnumber">1.3</span> <span class="toctext">Use the DocumentWindow class</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Use_the_DocumentWindow_sources"><span class="tocnumber">1.4</span> <span class="toctext">Use the DocumentWindow sources</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Future_extensions"><span class="tocnumber">1.5</span> <span class="toctext">Future extensions</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Versions"><span class="tocnumber">1.6</span> <span class="toctext">Versions</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Feedback"><span class="tocnumber">1.7</span> <span class="toctext">Feedback</span></a></li>
</ul>
</li>
</ul>
</div>

<h1><span class="mw-headline" id="Assigning_a_file_type_to_an_Application_on_Windows">Assigning a file type to an Application on Windows</span></h1>
<h2><span class="mw-headline" id="Background_.2F_technical_stuff">Background / technical stuff</span></h2>
<p>File types in windows are defined in the Windows registry. First there is the entry of "&lt;extension&gt;" in HKCR which contains the file type name. In HKCRamp;lt;file type name&gt; the different actions are defined.
</p><p>This means, there is a file extension <b>gidoc</b>, whose files are called "MDI Text Editor Document". These documents should be opened in an application, which is located here: E:.exe. The file itself should be a parameter.
</p><p>Using this pattern, each double click on a file opens a new Process which gets the file as parameter. This is fine for SDI (Single Document Interface) applications.
</p><p>Example below:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1">HKEY_CLASSES_ROOT
 idoc
 <span class="st0">&quot;Default&quot;</span><span class="sy0">=</span><span class="st0">&quot;GiMdi.Document&quot;</span>
 <span class="st0">&quot;NullFile&quot;</span><span class="sy0">=</span><span class="st0">&quot;&quot;</span>
&#160;
.<span class="me1">Document</span>
 <span class="st0">&quot;Default&quot;</span><span class="sy0">=</span><span class="st0">&quot;MDI Text Editor Document&quot;</span>
 <span class="br0">&#93;</span>
 <span class="st0">&quot;Default&quot;</span><span class="sy0">=</span><span class="st0">&quot;E:.exe,0&quot;</span>
 <span class="st0">&quot;Default&quot;</span><span class="sy0">=</span><span class="st0">&quot;E:.exe&#160;%1&quot;</span></pre></div></div>
<p>For MDI (Multi Document Interfaces), it should be opened in the existing Process. To achieve this, windows uses the old DDE mechanism. There must be some additional entries to achieve this:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1">HKEY_CLASSES_ROOT
 .<span class="me1">Document</span>
 <span class="st0">&quot;Default&quot;</span><span class="sy0">=</span><span class="st0">&quot;[open(quot;%1quot;)]&quot;</span>
 <span class="br0">&#93;</span>
 <span class="st0">&quot;Default&quot;</span><span class="sy0">=</span><span class="st0">&quot;SimpleCryptIoDevided&quot;</span>
 <span class="st0">&quot;Default&quot;</span><span class="sy0">=</span><span class="st0">&quot;system&quot;</span></pre></div></div>
<p>If this is also added, Windows starts the process, which is given in command and then sends a WM_DDE_INITIATE broadcast message to windows. The application must react on this, then handle WM_DDE_EXECUTE messages and, if requested, WM_DDE_TERMINATE message. If the reaction on the DDE messages is not correc, Windows displays some error messages.
</p>
<h2><span class="mw-headline" id="How_to_do_it">How to do it</span></h2>
<p>Normally, your application registers the file types (changes the registry) during startup. If the DDE Mdi stuff should be used, it then has to create some ATOMS (::GlobalAddAtom). Then it starts up the rest and waits fo user input.
</p><p>If the file type is registered, and no dde is set, the application is started with the file path as parameter.
</p><p>If ddeexec keys are set in the registry, the application is started and the the DDE messages are send. While handling these messages, WM_DDE_ACK messages are send back to the caller and the messages must be handled.
</p><p>This behaviour and the code would always look the same, only the registration keys and the handling of the DDE commands differ from application to application. There fore I created a class, that does all this and can be used as base class instead of QMainWindow: <b>DocumentWindow</b>.
</p>
<h2><span class="mw-headline" id="Use_the_DocumentWindow_class">Use the DocumentWindow class</span></h2>
If you want to create an (MDI) editor application, you can derive your main window class from DocumentWindow instead of QMainWindow. If you implement an MDI application, you should also reimplement the virtual method <div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1">ddeOpenFile</pre></div></div>.
<p>The example code is based on the <a rel="nofollow" class="external text" href="http://doc.qt.nokia.com/4.7/mainwindows-mdi.html">Qt MDI Example</a>
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="kw2">class</span> MainWindow <span class="sy0">:</span> <span class="kw2">public</span> DocumentWindow
<span class="br0">&#123;</span>
…
<span class="kw2">protected</span><span class="sy0">:</span>
 <span class="kw2">virtual</span> <span class="kw4">void</span> ddeOpenFile<span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> filePath<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre></div></div>
<p>all other things that need to be done is extending your constructor
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1">MainWindow<span class="sy0">::</span><span class="me2">MainWindow</span><span class="br0">&#40;</span><span class="kw5">QWidget</span><span class="sy0">*</span> parent<span class="sy0">,</span> <span class="kw5">Qt</span><span class="sy0">::</span><span class="me2">WindowFlags</span> flags<span class="br0">&#41;</span> <span class="sy0">:</span>
 DocumentWindow<span class="br0">&#40;</span>parent<span class="sy0">,</span> flags<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
 …
 registerFileType<span class="br0">&#40;</span><span class="st0">&quot;GiMdi.Document&quot;</span><span class="sy0">,</span> <span class="co1">// Document type name</span>
 <span class="st0">&quot;MDI Text Editor Document&quot;</span><span class="sy0">,</span><span class="co1">// User readable file type name</span>
 <span class="st0">&quot;.gidoc&quot;</span><span class="sy0">,</span> <span class="co1">// file extension</span>
 <span class="nu0">0</span><span class="sy0">,</span> <span class="co1">// index of the icon to use for the files.</span>
 <span class="kw2">true</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="co1">// register for DDE events</span>
 enableShellOpen<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
 …
<span class="br0">&#125;</span></pre></div></div>
<p>and reimplement ddeFileOpen
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="kw4">void</span> MainWindow<span class="sy0">::</span><span class="me2">ddeOpenFile</span><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> filePath<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
 MdiChild <span class="st0">''</span><span class="st0">'child = createMdiChild();
 if (child-&gt;loadFile(filePath))
 {
 statusBar()-&gt;showMessage(tr(&quot;File loaded&quot;), 2000);
 child-&gt;show();
 }
 else
 {
 child-&gt;close();
 }
}</span></pre></div></div>
<p>That's it. Now it should work to just start the application, and the file type ".gidoc" is registered with your application. If you double click on it in the Windows explorer, it should be opened in the currently running Process or, if no instance of your application is running, start a new one. If your application has a windows icon in the resource (not in the qrc file! a windows resource file &lt;file&gt;.rc), this icon should be used for the files.
</p>
<h2><span class="mw-headline" id="Use_the_DocumentWindow_sources">Use the DocumentWindow sources</span></h2>
<h3><span class="mw-headline" id="DocumentWindow.h">DocumentWindow.h</span></h3>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="co1">// ————————————————————————————————-</span>
<span class="coMULTI">/**
 * @file
 * @brief
 * @author Gerolf Reinwardt
 * @date 30. march 2011
 *
 * Copyright © 2011, Gerolf Reinwardt. All rights reserved.
 *
 * Simplified BSD License
 *
 * Redistribution and use in source and binary forms, with or without modification, are
 * permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this list of
 * conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice, this list
 * of conditions and the following disclaimer in the documentation and/or other materials
 * provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY &lt;COPYRIGHT HOLDER&gt; ``AS IS'' AND ANY EXPRESS OR IMPLIED
 * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
 * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL &lt;COPYRIGHT HOLDER&gt; OR
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
 * ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * The views and conclusions contained in the software and documentation are those of the
 * authors and should not be interpreted as representing official policies, either expressed
 * or implied, of Gerolf Reinwardt.
 */</span>
<span class="co1">// ————————————————————————————————-</span>
&#160;
<span class="co2">#ifndef WIDGET_H</span>
<span class="co2">#define WIDGET_H</span>
&#160;
<span class="co1">// —— general includes —————————————————————————</span>
<span class="co2">#include &lt;windows.h&gt;</span>
<span class="co2">#include &lt;QMainWindow&gt;</span>
&#160;
<span class="co1">// —— local includes —————————————————————————-</span>
<span class="co1">// —— pre defines ——————————————————————————-</span>
&#160;
<span class="co1">// —— class definition —————————————————————————</span>
<span class="coMULTI">/**
 * @short This class implements a main window with the ability to register file types on MS Windows and
 * react on the corresponding DDE events to open / print the files in an Windows MDI typical manner.
 *
 * The usage is fairly easy. Derive your own MainWindow class from DocumentWindow instead of QMainWindow.
 * Inside your constructor, call registerFileType and enableShellOpen. The axample is build on top of the
 * Qt MDI Example (http://doc.qt.nokia.com/4.7/mainwindows-mdi.html)
 *
 * @code
 MainWindow::MainWindow(QWidget* parent, Qt::WindowFlags flags)&#160;:
 DocumentWindow(parent, flags)
 {
 …
&#160;
registerFileType(&quot;GiMdi.Document&quot;, &quot;MDI Text Editor Document&quot;, &quot;.gidoc&quot;, 0, true);
 enableShellOpen();
&#160;
setWindowTitle(tr(&quot;MDI&quot;));
 setUnifiedTitleAndToolBarOnMac(true);
 }
&#160;
 *
 * Aditionally, the actions must be performed by overwriting one or more of:
 * @li ddeOpenFile
 * @li ddeNewFile
 * @li ddePrintFile
 * @li executeUnknownDdeCommand
 *
 * 
&#160;
 void MainWindow::ddeOpenFile(const QString&amp; filePath)
 {
 MdiChild *child = createMdiChild();
 if (child-&gt;loadFile(filePath))
 {
 statusBar()-&gt;showMessage(tr(&quot;File loaded&quot;), 2000);
 child-&gt;show();
 }
 else
 {
 child-&gt;close();
 }
 }
&#160;
*
 */</span>
<span class="kw2">class</span> DocumentWindow <span class="sy0">:</span> <span class="kw2">public</span> <span class="kw5">QMainWindow</span>
<span class="br0">&#123;</span>
 <span class="kw2">Q_OBJECT</span>
<span class="kw2">public</span><span class="sy0">:</span>
 <span class="co1">// —— enums ———————————————————————————</span>
 <span class="coMULTI">/**
 * Known DDE command. These commands are typically used
 */</span>
 <span class="kw2">enum</span> DdeCommand <span class="br0">&#123;</span>
 DDEOpen <span class="sy0">=</span> <span class="nu12">0x0001</span><span class="sy0">,</span> <span class="sy0">/&lt;</span> open a file via explorer<span class="sy0">*/</span>
 DDENew <span class="sy0">=</span> <span class="nu12">0x0002</span><span class="sy0">,</span> <span class="coMULTI">/**&lt; create a new file via explorer*/</span>
 DDEPrint <span class="sy0">=</span> <span class="nu12">0x0004</span><span class="sy0">,</span> <span class="coMULTI">/**&lt; print a file via explorer*/</span>
 <span class="br0">&#125;</span><span class="sy0">;</span>
 Q_DECLARE_FLAGS<span class="br0">&#40;</span>DdeCommands<span class="sy0">,</span> DdeCommand<span class="br0">&#41;</span>
&#160;
<span class="co1">// —— construction —————————————————————————</span>
 <span class="coMULTI">/**
 * Constructor.
 *
 * Creates a DocumentWindow with a given @arg parent and @arg flags.
 */</span>
 <span class="kw2">explicit</span> DocumentWindow<span class="br0">&#40;</span><span class="kw5">QWidget</span><span class="sy0">*</span> parent <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">,</span> <span class="kw5">Qt</span><span class="sy0">::</span><span class="me2">WindowFlags</span> flags <span class="sy0">=</span> <span class="nu0">0</span><span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
<span class="coMULTI">/**
 * Destructor
 */</span>
 ~DocumentWindow<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="co1">// —— operators ——————————————————————————</span>
 <span class="co1">// —— methods ——————————————————————————-</span>
 <span class="co1">// —— accessors ——————————————————————————</span>
 <span class="co1">// —— members ——————————————————————————-</span>
&#160;
<span class="kw2">protected</span><span class="sy0">:</span>
 <span class="co1">// —— events ———————————————————————————</span>
 <span class="coMULTI">/**
 * reimpl as DDE events come as windows events and are not translated by Qt.
 */</span>
 <span class="kw2">virtual</span> <span class="kw4">bool</span> winEvent<span class="br0">&#40;</span>MSG <span class="sy0">*</span>message<span class="sy0">,</span> <span class="kw4">long</span> <span class="sy0">*</span>result<span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="co1">// —— helpers for the file registration ——————————————————</span>
 <span class="coMULTI">/**
 * virtual function that must be implemented by the derived class to react to the open command
 * from Windows.
 *
 * @param filePath file that was selected in the explorer
 */</span>
 <span class="kw2">virtual</span> <span class="kw4">void</span> ddeOpenFile<span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> filePath<span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="coMULTI">/**
 * virtual function that must be implemented by the derived class to react to the new command
 * from Windows.
 *
 * @param filePath file that was selected in the explorer
 */</span>
 <span class="kw2">virtual</span> <span class="kw4">void</span> ddeNewFile<span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> filePath<span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="coMULTI">/**
 * virtual function that must be implemented by the derived class to react to the print command
 * from Windows.
 *
 * @param filePath file that was selected in the explorer
 */</span>
 <span class="kw2">virtual</span> <span class="kw4">void</span> ddePrintFile<span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> filePath<span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="coMULTI">/**
 * virtual function that must be implemented by get custom dde commands from the explorer. If, e.g.
 * a printo or copy command should be available in explorer and they are registered via registerCommand,
 * this function is called.
 *
 * @param command name of the command
 * @param params parameter string, containing the hole stuff, also &quot; and commas.
 *
 * @note a command like this [compare(&quot;%1&quot;)] will result in the parameters:
 command = &quot;compare&quot;;
 params = &quot;quot;&lt;filepath&gt;quot;&quot;;
 */</span>
 <span class="kw2">virtual</span> <span class="kw4">void</span> executeUnknownDdeCommand<span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> command<span class="sy0">,</span> <span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> params<span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="coMULTI">/**
 * Call this method to register the file type in Windows. It creates the default command
 * which means the app is started with the file to open as parameter. If @arg registerForDDE
 * is true, the dde events are also created so the opening of a file is done in typical MDI
 * behavior (all files open in the same app).
 *
 * @param documentId id of the document, typically &lt;Application&gt;.Document —&gt; see in registry, e.g. &quot;GiMdi.Document&quot;
 * @param fileTypeName free name of the file type, e.g. &quot;MDI Text Editor Document&quot;
 * @param fileExtension File extension, including the dot (e.g. &quot;.gidoc&quot;)
 * @param appIconIndex index of the app icon to use for the file in the windows explorer, typically the application icon
 * @param registerForDDE true if DDE should be used (typical for MDI apps), typically false for SDI apps.
 * @param commands a combination of the commands to install.
 *
 * @note If more then the default commands are needed, then subsequent calls of registerCommand are needed.
 *
 * @note DDEOpen leads to the DDE command: [open(&quot;%1)]
 DDENew leads to the DDE command: [new(&quot;%1)]
 DDEPrint leads to the DDE command: [print(&quot;%1)]
 */</span>
 <span class="kw4">void</span> registerFileType<span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> documentId<span class="sy0">,</span>
 <span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> fileTypeName<span class="sy0">,</span>
 <span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> fileExtension<span class="sy0">,</span>
 qint32 appIconIndex <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">,</span>
 <span class="kw4">bool</span> registerForDDE <span class="sy0">=</span> <span class="kw2">false</span><span class="sy0">,</span>
 DdeCommands commands <span class="sy0">=</span> DDEOpen<span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="coMULTI">/**
 * registeres one command for a given file type. It is called for the pre defined DDE command
 * types from registerFileType. if more then the normal commands are needed, it can be called
 * in addition to registerFileType.
 *
 * @code
 MainWindow::MainWindow(QWidget* parent, Qt::WindowFlags flags)&#160;:
 DocumentWindow(parent, flags)
 {
 …
&#160;
registerFileType(&quot;GiMdi.Document&quot;, &quot;MDI Text Editor Document&quot;, &quot;.gidoc&quot;, 0, true);
 registerCommand(&quot;fancyCommand&quot;, &quot;GiMdi.Document&quot;, &quot;-fancy&#160;%1&quot;, &quot;[fancy(quot;%1quot;)]&quot;);
 enableShellOpen();
&#160;
 …
 }
 @endcode
 */</span>
 <span class="kw4">void</span> registerCommand<span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> command<span class="sy0">,</span>
 <span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> documentId<span class="sy0">,</span>
 <span class="kw4">const</span> <span class="kw5">QString</span> cmdLineArg <span class="sy0">=</span> <span class="kw5">QString</span><span class="sy0">::</span><span class="me2">null</span><span class="sy0">,</span>
 <span class="kw4">const</span> <span class="kw5">QString</span> ddeCommand <span class="sy0">=</span> <span class="kw5">QString</span><span class="sy0">::</span><span class="me2">null</span><span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="coMULTI">/**
 * Call this method to enable the user to open data files associated with your application
 * by double-clicking the files in the windows file manager.
 *
 * Use it together with registerFileType to register the fspezified file types or provida a
 * registry file (*.reg) which does this.
*/</span>
 <span class="kw4">void</span> enableShellOpen<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
&#160;
<span class="kw2">private</span><span class="sy0">:</span>
 <span class="co1">// —— privat helpers ————————————————————————</span>
 <span class="coMULTI">/**
 * implementation of the WM_DDE_INITIATE windows message
 */</span>
 <span class="kw4">bool</span> ddeInitiate<span class="br0">&#40;</span>MSG<span class="sy0">*</span> message<span class="sy0">,</span> <span class="kw4">long</span><span class="sy0">*</span> result<span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="coMULTI">/**
 * implementation of the WM_DDE_EXECUTE windows message
 */</span>
 <span class="kw4">bool</span> ddeExecute<span class="br0">&#40;</span>MSG<span class="sy0">*</span> message<span class="sy0">,</span> <span class="kw4">long</span><span class="sy0">*</span> result<span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="coMULTI">/**
 * implementation of the WM_DDE_TERMINATE windows message
 */</span>
 <span class="kw4">bool</span> ddeTerminate<span class="br0">&#40;</span>MSG<span class="sy0">*</span> message<span class="sy0">,</span> <span class="kw4">long</span><span class="sy0">*</span> result<span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="coMULTI">/**
 * Sets specified value in the registry under HKCU\Software\Classes, which is mapped to HKCR then.
 */</span>
 <span class="kw4">bool</span> SetHkcrUserRegKey<span class="br0">&#40;</span><span class="kw5">QString</span> key<span class="sy0">,</span> <span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> value<span class="sy0">,</span> <span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> valueName <span class="sy0">=</span> <span class="kw5">QString</span><span class="sy0">::</span><span class="me2">null</span><span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="coMULTI">/**
 * this method is called to do the DDE command handling. It does argument splitting and then calls
 * ddeOpenFile, ddeNewFile, ddePrintFile or executeUnknownDdeCommand.
 */</span>
 <span class="kw4">void</span> executeDdeCommand<span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> command<span class="sy0">,</span> <span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> params<span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="co1">// —— members ——————————————————————————-</span>
 <span class="kw4">bool</span> m_registerForDDE<span class="sy0">;</span> <span class="sy0">/&lt;</span> used to identfy<span class="sy0">,</span> <span class="kw1">if</span> the dde commands should be written to the registry<span class="sy0">*/</span>
 <span class="kw5">QString</span> m_appAtomName<span class="sy0">;</span> <span class="coMULTI">/**&lt; the name of the application, without file extension*/</span>
 <span class="kw5">QString</span> m_systemTopicAtomName<span class="sy0">;</span> <span class="coMULTI">/**&lt; the name of the system topic atom, typically &quot;System&quot;*/</span>
 ATOM m_appAtom<span class="sy0">;</span> <span class="coMULTI">/**&lt; The windows atom needed for DDE communication*/</span>
 ATOM m_systemTopicAtom<span class="sy0">;</span> <span class="coMULTI">/**&lt; The windows system topic atom needed for DDE communication*/</span>
 <span class="co1">// —— not allowed members ——————————————————————-</span>
<span class="br0">&#125;</span><span class="sy0">;</span>
&#160;
Q_DECLARE_OPERATORS_FOR_FLAGS<span class="br0">&#40;</span>DocumentWindow<span class="sy0">::</span><span class="me2">DdeCommands</span><span class="br0">&#41;</span>
&#160;
<span class="co2">#endif // WIDGET_H</span></pre></div></div>
<h3><span class="mw-headline" id="DocumentWindow.cpp">DocumentWindow.cpp</span></h3>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp-qt source-cpp-qt"><pre class="de1"><span class="co1">// ————————————————————————————————-</span>
<span class="coMULTI">/**
 * @file
 * @brief
 * @author Gerolf Reinwardt
 * @date 30.01.2011
 *
 * Copyright © 2011, Gerolf Reinwardt. All rights reserved.
 *
 * Simplified BSD License
 *
 * Redistribution and use in source and binary forms, with or without modification, are
 * permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this list of
 * conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice, this list
 * of conditions and the following disclaimer in the documentation and/or other materials
 * provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY &lt;COPYRIGHT HOLDER&gt; ``AS IS'' AND ANY EXPRESS OR IMPLIED
 * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
 * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL &lt;COPYRIGHT HOLDER&gt; OR
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
 * ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * The views and conclusions contained in the software and documentation are those of the
 * authors and should not be interpreted as representing official policies, either expressed
 * or implied, of Gerolf Reinwardt.
 */</span>
<span class="co1">// ————————————————————————————————-</span>
&#160;
<span class="co1">// —— general includes —————————————————————————</span>
<span class="co2">#include &lt;windows.h&gt;</span>
<span class="co2">#include &lt;QMessageBox&gt;</span>
<span class="co2">#include &lt;QApplication&gt;</span>
<span class="co2">#include &lt;QDir&gt;</span>
<span class="co2">#include &lt;QFileInfo&gt;</span>
<span class="co2">#include &lt;QRegExp&gt;</span>
&#160;
<span class="co1">// —— local includes —————————————————————————-</span>
<span class="co2">#include &quot;documentwindow.h&quot;</span>
&#160;
&#160;
<span class="co1">// —— construction ——————————————————————————</span>
DocumentWindow<span class="sy0">::</span><span class="me2">DocumentWindow</span><span class="br0">&#40;</span><span class="kw5">QWidget</span><span class="st0">''</span><span class="st0">' parent, Qt::WindowFlags flags)&#160;:
 QMainWindow(parent, flags),
 m_registerForDDE(false),
 m_appAtomName(),
 m_systemTopicAtomName(&quot;system&quot;),
 m_appAtom(0),
 m_systemTopicAtom(0)
{
 QFileInfo fi(qApp-&gt;applicationFilePath());
 m_appAtomName = fi.baseName();
}
&#160;
DocumentWindow::~DocumentWindow()
{
 if(0&#160;!= m_appAtom)
 {
 ::GlobalDeleteAtom(m_appAtom);
 m_appAtom = 0;
 }
 if(0&#160;!= m_systemTopicAtom)
 {
 ::GlobalDeleteAtom(m_systemTopicAtom);
 m_systemTopicAtom = 0;
 }
}
&#160;
// —— operators ———————————————————————————
// —— methods ————————————————————————————
// —— accessors ———————————————————————————
// —— public slots ——————————————————————————
// —— protected slots —————————————————————————
// —— events ————————————————————————————
bool DocumentWindow::winEvent(MSG *message, long '</span><span class="st0">''</span>result<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
 <span class="kw1">switch</span><span class="br0">&#40;</span>message<span class="sy0">-&gt;</span><span class="me3">message</span><span class="br0">&#41;</span>
 <span class="br0">&#123;</span>
 <span class="kw1">case</span> WM_DDE_INITIATE<span class="sy0">:</span>
 <span class="kw1">return</span> ddeInitiate<span class="br0">&#40;</span>message<span class="sy0">,</span> result<span class="br0">&#41;</span><span class="sy0">;</span>
 break<span class="sy0">;</span>
 <span class="kw1">case</span> WM_DDE_EXECUTE<span class="sy0">:</span>
 <span class="kw1">return</span> ddeExecute<span class="br0">&#40;</span>message<span class="sy0">,</span> result<span class="br0">&#41;</span><span class="sy0">;</span>
 break<span class="sy0">;</span>
 <span class="kw1">case</span> WM_DDE_TERMINATE<span class="sy0">:</span>
 <span class="kw1">return</span> ddeTerminate<span class="br0">&#40;</span>message<span class="sy0">,</span> result<span class="br0">&#41;</span><span class="sy0">;</span>
 break<span class="sy0">;</span>
 <span class="br0">&#125;</span>
&#160;
 <span class="kw1">return</span> <span class="kw5">QMainWindow</span><span class="sy0">::</span><span class="me2">winEvent</span><span class="br0">&#40;</span>message<span class="sy0">,</span> result<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
&#160;
<span class="kw4">void</span> DocumentWindow<span class="sy0">::</span><span class="me2">ddeOpenFile</span><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
 <span class="co1">// this method will be overwritten, if the application uses the dde open command</span>
<span class="br0">&#125;</span>
&#160;
<span class="kw4">void</span> DocumentWindow<span class="sy0">::</span><span class="me2">ddeNewFile</span><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
 <span class="co1">// this method will be overwritten, if the application uses the dde new command</span>
<span class="br0">&#125;</span>
&#160;
<span class="kw4">void</span> DocumentWindow<span class="sy0">::</span><span class="me2">ddePrintFile</span><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
 <span class="co1">// this method will be overwritten, if the application uses the dde print command</span>
<span class="br0">&#125;</span>
&#160;
<span class="kw4">void</span> DocumentWindow<span class="sy0">::</span><span class="me2">executeUnknownDdeCommand</span><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;,</span> <span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
 <span class="co1">// this method will be overwritten, if the application uses other commands,</span>
 <span class="co1">// then open, new and print via DDE and Explorer</span>
<span class="br0">&#125;</span>
&#160;
<span class="kw4">void</span> DocumentWindow<span class="sy0">::</span><span class="me2">registerFileType</span><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> documentId<span class="sy0">,</span>
 <span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> fileTypeName<span class="sy0">,</span>
 <span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> fileExtension<span class="sy0">,</span>
 qint32 appIconIndex<span class="sy0">,</span>
 <span class="kw4">bool</span> registerForDDE<span class="sy0">,</span>
 DdeCommands commands<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
 <span class="co1">// first register the type ID of our server</span>
 <span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>SetHkcrUserRegKey<span class="br0">&#40;</span>documentId<span class="sy0">,</span> fileTypeName<span class="br0">&#41;</span><span class="br0">&#41;</span>
 return<span class="sy0">;</span>
&#160;
 <span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>SetHkcrUserRegKey<span class="br0">&#40;</span><span class="kw5">QString</span><span class="br0">&#40;</span><span class="st0">&quot;%1DefaultIcon&quot;</span><span class="br0">&#41;</span>.<span class="me1">arg</span><span class="br0">&#40;</span>documentId<span class="br0">&#41;</span><span class="sy0">,</span>
 <span class="kw5">QString</span><span class="br0">&#40;</span><span class="st0">&quot;quot;%1quot;,%2&quot;</span><span class="br0">&#41;</span>.<span class="me1">arg</span><span class="br0">&#40;</span><span class="kw5">QDir</span><span class="sy0">::</span><span class="me2">toNativeSeparators</span><span class="br0">&#40;</span>qApp<span class="sy0">-&gt;</span><span class="me3">applicationFilePath</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>.<span class="me1">arg</span><span class="br0">&#40;</span>appIconIndex<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
 return<span class="sy0">;</span>
&#160;
 m_registerForDDE <span class="sy0">=</span> registerForDDE<span class="sy0">;</span>
&#160;
 <span class="kw1">if</span><span class="br0">&#40;</span>commands <span class="sy0">&amp;</span> DDEOpen<span class="br0">&#41;</span>
 registerCommand<span class="br0">&#40;</span><span class="st0">&quot;Open&quot;</span><span class="sy0">,</span> documentId<span class="sy0">,</span> <span class="st0">&quot;quot;%1quot;&quot;</span><span class="sy0">,</span> <span class="st0">&quot;[open(quot;%1quot;)]&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
 <span class="kw1">if</span><span class="br0">&#40;</span>commands <span class="sy0">&amp;</span> DDENew<span class="br0">&#41;</span>
 registerCommand<span class="br0">&#40;</span><span class="st0">&quot;New&quot;</span><span class="sy0">,</span> documentId<span class="sy0">,</span> <span class="st0">&quot;-new quot;%1quot;&quot;</span><span class="sy0">,</span> <span class="st0">&quot;[new(quot;%1quot;)]&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
 <span class="kw1">if</span><span class="br0">&#40;</span>commands <span class="sy0">&amp;</span> DDEPrint<span class="br0">&#41;</span>
 registerCommand<span class="br0">&#40;</span><span class="st0">&quot;Print&quot;</span><span class="sy0">,</span> documentId<span class="sy0">,</span> <span class="st0">&quot;-print quot;%1quot;&quot;</span><span class="sy0">,</span> <span class="st0">&quot;[print(quot;%1quot;)]&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 LONG lSize <span class="sy0">=</span> _MAX_PATH <span class="sy0">*</span> <span class="nu0">2</span><span class="sy0">;</span>
 <span class="kw4">wchar_t</span> szTempBuffer<span class="br0">&#91;</span>_MAX_PATH <span class="sy0">*</span> <span class="nu0">2</span><span class="br0">&#93;</span><span class="sy0">;</span>
 LONG lResult <span class="sy0">=</span> <span class="sy0">::</span><span class="me2">RegQueryValue</span><span class="br0">&#40;</span>HKEY_CLASSES_ROOT<span class="sy0">,</span>
 <span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw4">wchar_t</span><span class="sy0">*</span><span class="br0">&#41;</span>fileExtension.<span class="me1">utf16</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">,</span>
 szTempBuffer<span class="sy0">,</span>
 <span class="sy0">&amp;</span>lSize<span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="kw5">QString</span> temp <span class="sy0">=</span> <span class="kw5">QString</span><span class="sy0">::</span><span class="me2">fromUtf16</span><span class="br0">&#40;</span><span class="br0">&#40;</span><span class="kw4">unsigned</span> <span class="kw4">short</span><span class="sy0">*</span><span class="br0">&#41;</span>szTempBuffer<span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="kw1">if</span> <span class="br0">&#40;</span>lResult <span class="sy0">!=</span> ERROR_SUCCESS <span class="sy0">||</span> temp.<span class="me1">isEmpty</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">||</span> temp <span class="sy0">==</span> documentId<span class="br0">&#41;</span>
 <span class="br0">&#123;</span>
 <span class="co1">// no association for that suffix</span>
 <span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>SetHkcrUserRegKey<span class="br0">&#40;</span>fileExtension<span class="sy0">,</span> documentId<span class="br0">&#41;</span><span class="br0">&#41;</span>
 return<span class="sy0">;</span>
&#160;
 SetHkcrUserRegKey<span class="br0">&#40;</span><span class="kw5">QString</span><span class="br0">&#40;</span><span class="st0">&quot;%1ShellNew&quot;</span><span class="br0">&#41;</span>.<span class="me1">arg</span><span class="br0">&#40;</span>fileExtension<span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw5">QLatin1String</span><span class="br0">&#40;</span><span class="st0">&quot;&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw5">QLatin1String</span><span class="br0">&#40;</span><span class="st0">&quot;NullFile&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
 <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&#160;
<span class="kw4">void</span> DocumentWindow<span class="sy0">::</span><span class="me2">registerCommand</span><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> command<span class="sy0">,</span>
 <span class="kw4">const</span> <span class="kw5">QString</span><span class="sy0">&amp;</span> documentId<span class="sy0">,</span>
 <span class="kw4">const</span> <span class="kw5">QString</span> cmdLineArg<span class="sy0">,</span>
 <span class="kw4">const</span> <span class="kw5">QString</span> ddeCommand<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
 <span class="kw5">QString</span> commandLine <span class="sy0">=</span> <span class="kw5">QDir</span><span class="sy0">::</span><span class="me2">toNativeSeparators</span><span class="br0">&#40;</span>qApp<span class="sy0">-&gt;</span><span class="me3">applicationFilePath</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
 commandLine.<span class="me1">prepend</span><span class="br0">&#40;</span><span class="kw5">QLatin1String</span><span class="br0">&#40;</span><span class="st0">&quot;quot;&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
 commandLine.<span class="me1">append</span><span class="br0">&#40;</span><span class="kw5">QLatin1String</span><span class="br0">&#40;</span><span class="st0">&quot;quot;&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
 <span class="kw1">if</span><span class="br0">&#40;</span><span class="sy0">!</span>cmdLineArg.<span class="me1">isEmpty</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
 <span class="br0">&#123;</span>
 commandLine.<span class="me1">append</span><span class="br0">&#40;</span><span class="kw5">QChar</span><span class="br0">&#40;</span><span class="st0">' '</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
 commandLine.<span class="me1">append</span><span class="br0">&#40;</span>cmdLineArg<span class="br0">&#41;</span><span class="sy0">;</span>
 <span class="br0">&#125;</span>
&#160;
 <span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>SetHkcrUserRegKey<span class="br0">&#40;</span><span class="kw5">QString</span><span class="br0">&#40;</span><span class="st0">&quot;%1shell%2command&quot;</span><span class="br0">&#41;</span>.<span class="me1">arg</span><span class="br0">&#40;</span>documentId<span class="br0">&#41;</span>.<span class="me1">arg</span><span class="br0">&#40;</span>command<span class="br0">&#41;</span><span class="sy0">,</span> commandLine<span class="br0">&#41;</span><span class="br0">&#41;</span>
 return<span class="sy0">;</span> <span class="co1">// just skip it</span>
&#160;
 <span class="kw1">if</span><span class="br0">&#40;</span>m_registerForDDE<span class="br0">&#41;</span>
 <span class="br0">&#123;</span>
 <span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>SetHkcrUserRegKey<span class="br0">&#40;</span><span class="kw5">QString</span><span class="br0">&#40;</span><span class="st0">&quot;%1shell%2ddeexec&quot;</span><span class="br0">&#41;</span>.<span class="me1">arg</span><span class="br0">&#40;</span>documentId<span class="br0">&#41;</span>.<span class="me1">arg</span><span class="br0">&#40;</span>command<span class="br0">&#41;</span><span class="sy0">,</span> ddeCommand<span class="br0">&#41;</span><span class="br0">&#41;</span>
 return<span class="sy0">;</span>
&#160;
 <span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>SetHkcrUserRegKey<span class="br0">&#40;</span><span class="kw5">QString</span><span class="br0">&#40;</span><span class="st0">&quot;%1shell%2ddeexecapplication&quot;</span><span class="br0">&#41;</span>.<span class="me1">arg</span><span class="br0">&#40;</span>documentId<span class="br0">&#41;</span>.<span class="me1">arg</span><span class="br0">&#40;</span>command<span class="br0">&#41;</span><span class="sy0">,</span> m_appAtomName<span class="br0">&#41;</span><span class="br0">&#41;</span>
 return<span class="sy0">;</span>
&#160;
 <span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>SetHkcrUserRegKey<span class="br0">&#40;</span><span class="kw5">QString</span><span class="br0">&#40;</span><span class="st0">&quot;%1shell%2ddeexectopic&quot;</span><span class="br0">&#41;</span>.<span class="me1">arg</span><span class="br0">&#40;</span>documentId<span class="br0">&#41;</span>.<span class="me1">arg</span><span class="br0">&#40;</span>command<span class="br0">&#41;</span><span class="sy0">,</span> m_systemTopicAtomName<span class="br0">&#41;</span><span class="br0">&#41;</span>
 return<span class="sy0">;</span>
 <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&#160;
<span class="kw4">void</span> DocumentWindow<span class="sy0">::</span><span class="me2">enableShellOpen</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
 <span class="kw1">if</span><span class="br0">&#40;</span><span class="br0">&#40;</span><span class="nu0">0</span> <span class="sy0">!=</span> m_appAtom<span class="br0">&#41;</span> <span class="sy0">||</span> <span class="br0">&#40;</span><span class="nu0">0</span> <span class="sy0">!=</span> m_systemTopicAtom<span class="br0">&#41;</span><span class="br0">&#41;</span>
 return<span class="sy0">;</span>
&#160;
 m_appAtom <span class="sy0">=</span> <span class="sy0">::</span><span class="me2">GlobalAddAtomW</span><span class="br0">&#40;</span><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw4">wchar_t</span><span class="st0">''</span><span class="st0">')m_appAtomName.utf16());
 m_systemTopicAtom =&#160;::GlobalAddAtomW((const wchar_t*)m_systemTopicAtomName.utf16());
}
&#160;
// —— private slots ——————————————————————————
// —— private helpers —————————————————————————
bool DocumentWindow::ddeInitiate(MSG* message, long* result)
{
 if( (0&#160;!= LOWORD (message-&gt;lParam)) &amp;&amp;
 (0&#160;!= HIWORD (message-&gt;lParam)) &amp;&amp;
 (LOWORD (message-&gt;lParam)  m_appAtom) &amp;&amp;
        (HIWORD(message-&gt;lParam)  m_systemTopicAtom))
 {
 // make duplicates of the incoming atoms (really adding a reference)
 wchar_t atomName[_MAX_PATH];
 Q_ASSERT(::GlobalGetAtomNameW(m_appAtom, atomName, _MAX_PATH - 1)&#160;!= 0);
 Q_ASSERT(::GlobalAddAtomW(atomName)  m_appAtom);
        Q_ASSERT(::GlobalGetAtomNameW(m_systemTopicAtom, atomName, _MAX_PATH - 1)&#160;!= 0);
        Q_ASSERT(::GlobalAddAtomW(atomName)  m_systemTopicAtom);
&#160;
// send the WM_DDE_ACK (caller will delete duplicate atoms)
 ::SendMessage((HWND)message-&gt;wParam, WM_DDE_ACK, (WPARAM)winId(), MAKELPARAM (m_appAtom, m_systemTopicAtom));
 }
 '</span><span class="st0">''</span>result <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
 <span class="kw1">return</span> true<span class="sy0">;</span>
<span class="br0">&#125;</span>
&#160;
<span class="kw4">bool</span> DocumentWindow<span class="sy0">::</span><span class="me2">ddeExecute</span><span class="br0">&#40;</span>MSG<span class="st0">''</span><span class="st0">' message, long* result)
{
 // unpack the DDE message
 UINT_PTR unused;
 HGLOBAL hData;
 //IA64: Assume DDE LPARAMs are still 32-bit
 Q_ASSERT(::UnpackDDElParam(WM_DDE_EXECUTE, message-&gt;lParam, &amp;unused, (UINT_PTR*)&amp;hData));
&#160;
QString command = QString::fromWCharArray((LPCWSTR)::GlobalLock(hData));
 ::GlobalUnlock(hData);
&#160;
// acknowledge now - before attempting to execute
 ::PostMessage((HWND)message-&gt;wParam, WM_DDE_ACK, (WPARAM)winId(),
 //IA64: Assume DDE LPARAMs are still 32-bit
 ReuseDDElParam(message-&gt;lParam, WM_DDE_EXECUTE, WM_DDE_ACK, (UINT)0x8000, (UINT_PTR)hData));
&#160;
// don'</span>t execute the command when the window is disabled
 <span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>isEnabled<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
 <span class="br0">&#123;</span>
 <span class="st0">''</span><span class="st0">'result = 0;
 return true;
 }
&#160;
 QRegExp regCommand(&quot;&lt;sup&gt;$&quot;);
 if(regCommand.exactMatch(command))
 {
 executeDdeCommand(regCommand.cap(1), regCommand.cap(2));
 }
&#160;
 '</span><span class="st0">''</span>result <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
 <span class="kw1">return</span> true<span class="sy0">;</span>
<span class="br0">&#125;</span>
&#160;
<span class="kw4">bool</span> DocumentWindow<span class="sy0">::</span><span class="me2">ddeTerminate</span><span class="br0">&#40;</span>MSG<span class="st0">''</span><span class="st0">' message, long* result)
{
 // The client or server application should respond by posting a WM_DDE_TERMINATE message.
 ::PostMessageW((HWND)message-&gt;wParam, WM_DDE_TERMINATE, (WPARAM)winId(), message-&gt;lParam);
 return true;
}
&#160;
bool DocumentWindow::SetHkcrUserRegKey(QString key, const QString&amp; value, const QString&amp; valueName)
{
 HKEY hKey;
&#160;
 key.prepend(&quot;SoftwareClasses&quot;);
&#160;
 LONG lRetVal = RegCreateKey(HKEY_CURRENT_USER,
 (const wchar_t*)key.utf16(),
 &amp;hKey);
&#160;
 if(ERROR_SUCCESS == lRetVal)
 {
 LONG lResult =&#160;::RegSetValueExW(hKey,
 valueName.isEmpty()&#160;? 0&#160;: (const wchar_t*)valueName.utf16(),
 0,
 REG_SZ,
 (CONST BYTE*)value.utf16(),
 (value.length() + 1) * sizeof(wchar_t));
&#160;
 if(::RegCloseKey(hKey)  ERROR_SUCCESS &amp;&amp; lResult  ERROR_SUCCESS)
 return true;
&#160;
 QMessageBox::warning(0, QString(&quot;Error in setting Registry values&quot;),
 QString(&quot;registration database update failed for key '</span><span class="sy0">%</span>s<span class="st0">'.&quot;).arg(key));
 }
 else
 {
 wchar_t buffer[4096];
 ::FormatMessageW(FORMAT_MESSAGE_FROM_SYSTEM, 0, lRetVal, 0, buffer, 4096, 0);
 QString szText = QString::fromUtf16((const ushort*)buffer);
 QMessageBox::warning(this, QString(&quot;Error in setting Registry values&quot;), szText);
 }
 return false;
}
&#160;
void DocumentWindow::executeDdeCommand(const QString&amp; command, const QString&amp; params)
{
 QRegExp regCommand(&quot;&lt;/sup&gt;quot;(.'</span><span class="st0">''</span><span class="br0">&#41;</span>quot<span class="sy0">;</span>$<span class="st0">&quot;);
 bool singleCommand = regCommand.exactMatch(params);
 if((0  command.compare(&quot;</span>open<span class="st0">&quot;, Qt::CaseInsensitive)) &amp;&amp; singleCommand)
    {
        ddeOpenFile(regCommand.cap(1));
    }
    else if((0  command.compare(&quot;</span><span class="kw1">new</span><span class="st0">&quot;, Qt::CaseInsensitive)) &amp;&amp; singleCommand)
 {
 ddeNewFile(regCommand.cap(1));
 }
 else if((0 == command.compare(&quot;</span>print<span class="st0">&quot;, Qt::CaseInsensitive)) &amp;&amp; singleCommand)
 {
 ddePrintFile(regCommand.cap(1));
 }
 else
 {
 executeUnknownDdeCommand(command, params);
 }
}</span></pre></div></div>
<p>You may use this code without any warranty.
</p>
<h2><span class="mw-headline" id="Future_extensions">Future extensions</span></h2>
<p>The class might be extended so it also works on Linux or Mac. The code of the class and a demo project are located on gitorious in the following repository: <a rel="nofollow" class="external text" href="https://www.gitorious.org/qtdevnet-wiki-mvc/qtdevnet-registereditorfiletype">qtdevnet-registereditorfiletype</a>
</p>
<h2><span class="mw-headline" id="Versions">Versions</span></h2>
<p>The current code is version 1 of the code.
</p>
<h4><span class="mw-headline" id="Version_1">Version 1</span></h4>
<p>This marks the first public release.
</p>
<h2><span class="mw-headline" id="Feedback">Feedback</span></h2>

<!-- 
NewPP limit report
CPU time usage: 0.243 seconds
Real time usage: 0.251 seconds
Preprocessor visited node count: 133/1000000
Preprocessor generated node count: 280/1000000
Post‐expand include size: 1408/2097152 bytes
Template argument size: 447/2097152 bytes
Highest expansion depth: 5/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key qtio_wiki:pcache:idhash:48-0!*!0!!en!*!* and timestamp 20151105063338 and revision id 16397
 -->
</div>								<div class="printfooter">
				Retrieved from "<a href="index2a25.html?title=Assigning_a_file_type_to_an_Application_on_Windows&amp;oldid=16397">http://wiki.qt.io/index.php?title=Assigning_a_file_type_to_an_Application_on_Windows&amp;oldid=16397</a>"				</div>
												<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Categories</a>: <ul><li><a href="Category_Articles_needing_cleanup.html" title="Category:Articles needing cleanup">Articles needing cleanup</a></li><li><a href="Category_Snippets.html" title="Category:Snippets">Snippets</a></li></ul></div></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
				<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
	<h3 id="p-personal-label">Personal tools</h3>
	<ul>
<li id="pt-anonuserpage"><a href="User_10.0.113.html" class="new" title="The user page for the IP address you are editing as [.]" accesskey=".">10.0.113.70</a></li><li id="pt-anontalk"><a href="User_talk_10.0.113.html" class="new" title="Discussion about edits from this IP address [n]" accesskey="n">Talk for this IP address</a></li><li id="pt-login"><a href="https://login.qt.io/authorize?client_id=one-qt-server-003&amp;response_type=code&amp;state=1003558e917aeaca&amp;scope=authorizations&amp;redirect_uri=https%3A%2F%2Fwiki.qt.io%2FSpecial%3AQtLogin%2Fcallback" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Sign in</a></li>	</ul>
</div>
				<div id="left-navigation">
					<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
	<h3 id="p-namespaces-label">Namespaces</h3>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="Assigning_a_file_type_to_an_Application_on_Windows.html"  title="View the content page [c]" accesskey="c">Page</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="Talk_Assigning_a_file_type_to_an_Application_on_Windows.html?title=Talk:Assigning_a_file_type_to_an_Application_on_Windows&amp;action=edit&amp;redlink=1"  title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
			</ul>
</div>
<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
	<h3 id="mw-vector-current-variant">
		</h3>
	<h3 id="p-variants-label"><span>Variants</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
				</div>
				<div id="right-navigation">
					<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
	<h3 id="p-views-label">Views</h3>
	<ul>
					<li id="ca-view" class="selected"><span><a href="Assigning_a_file_type_to_an_Application_on_Windows.html" >Read</a></span></li>
					<li id="ca-viewsource"><span><a href="indexbba0.html?title=Assigning_a_file_type_to_an_Application_on_Windows&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
					<li id="ca-history" class="collapsible"><span><a href="indexa928.html?title=Assigning_a_file_type_to_an_Application_on_Windows&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
			</ul>
</div>
<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
	<h3 id="p-cactions-label"><span>Actions</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
<div id="p-search" role="search">
	<h3><label for="searchInput">Search</label></h3>
	<form action="http://wiki.qt.io/index.php" id="searchform">
					<div id="simpleSearch">
					<input type="search" name="search" placeholder="Search" title="Search Qt Wiki [f]" accesskey="f" id="searchInput" /><input type="hidden" value="Special:Search" name="title" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton" />		</div>
	</form>
</div>
				</div>
			</div>
			<div id="mw-panel">
					<div id="p-logo" role="banner"><a style="background-image: url(skins/common/images/wiki.png);" href="Main_Page.html"  title="Visit the main page"></a></div>
				<div class="portal" role="navigation" id='p-navigation' aria-labelledby='p-navigation-label'>
	<h3 id='p-navigation-label'>Navigation</h3>
	<div class="body">
		<ul>
			<li id="n-mainpage-description"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main page</a></li>
			<li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
			<li id="n-randompage"><a href="How_to_create_columns_in_a_QML_ListView.html" title="Load a random page [x]" accesskey="x">Random page</a></li>
			<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
	<h3 id='p-tb-label'>Tools</h3>
	<div class="body">
		<ul>
			<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/Assigning_a_file_type_to_an_Application_on_Windows.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
			<li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/Assigning_a_file_type_to_an_Application_on_Windows.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
			<li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
			<li id="t-print"><a href="index3494.html?title=Assigning_a_file_type_to_an_Application_on_Windows&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
			<li id="t-permalink"><a href="index2a25.html?title=Assigning_a_file_type_to_an_Application_on_Windows&amp;oldid=16397" title="Permanent link to this revision of the page">Permanent link</a></li>
			<li id="t-info"><a href="index0697.html?title=Assigning_a_file_type_to_an_Application_on_Windows&amp;action=info">Page information</a></li>
		</ul>
	</div>
</div>
			</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 27 April 2015, at 13:21.</li>
											<li id="footer-info-viewcount">This page has been accessed 2,054 times.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-terms"><a href='https://developer.qtcloudservices.com/legal/terms'>Käyttöehdot</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
					<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<script>/*<![CDATA[*/window.jQuery && jQuery.ready();/*]]>*/</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","skins.vector.collapsibleNav"],null,true);
}</script>
<script src="load55ad.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54043535-2', 'auto');
  ga('send', 'pageview');

</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":519});
}</script>
	</body>

<!-- Mirrored from wiki.qt.io/Assigning_a_file_type_to_an_Application_on_Windows by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 05 Nov 2015 07:31:58 GMT -->
</html>
